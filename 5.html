<!DOCTYPE html>
<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->
<!--[if lt IE 7]><html class="ie ie6 ie-lte9 ie-lte8 ie-lte7 no-js" lang="en-us"> <![endif]-->
<!--[if IE 7]><html class="ie ie7 ie-lte9 ie-lte8 ie-lte7 no-js" lang="en-us"> <![endif]-->
<!--[if IE 8]><html class="ie ie8 ie-lte9 ie-lte8 no-js" lang="en-us"> <![endif]-->
<!--[if IE 9]><html class="ie9 ie-lte9 no-js" lang="en-us"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html class="no-js" lang="en-us"> <!--<![endif]-->
<head>
  <meta charset="utf-8" />
  <!-- www.phpied.com/conditional-comments-block-downloads/ -->
  <!-- Always force latest IE rendering engine
       (even in intranet) & Chrome Frame
       Remove this if you use the .htaccess -->
  <!--[if IE]>
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <![endif]-->

  <title>Diffbook</title>

  <!-- http://dev.w3.org/html5/markup/meta.name.html -->
  <meta name="application-name" content="diffbook" />

  <!-- Speaking of Google, don't forget to set your site up:
       http://google.com/webmasters -->
  <meta name="google-site-verification" content="" />

  <!--  Mobile Viewport Fix
        j.mp/mobileviewport & davidbcalhoun.com/2010/viewport-metatag
        device-width: Occupy full width of the screen in its current orientation
        initial-scale = 1.0 retains dimensions instead of zooming out if page height > device height
        user-scalable = yes allows the user to zoom in -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link rel="shortcut icon" href="static/images/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" href="static/images/favicon.png">

  <!-- All JavaScript at the bottom, except for Modernizr which enables
       HTML5 elements & feature detects -->
  <script src="static/js/modernizr.custom.js"></script>

  <!-- include stylesheets -->
  

  <script type="text/javascript"><!--
    // These variables are used by the web2py_ajax_init function in web2py_ajax.js (which is loaded below).
    var w2p_ajax_confirm_message = "Are you sure you want to delete this object?";
    var w2p_ajax_date_format = "%Y-%m-%d";
    var w2p_ajax_datetime_format = "%Y-%m-%d %H:%M:%S";
    //--></script>
<meta name="keywords" content="web2py, python, framework" />

<meta name="description" content="a cool new app" />

<meta name="generator" content="Web2py Web Framework" />

<meta name="author" content="Your Name &lt;you@example.com&gt;" />
<script src="static/js/jquery.js" type="text/javascript"></script><link href="static/css/calendar.css" rel="stylesheet" type="text/css" /><script src="static/js/calendar.js" type="text/javascript"></script><script src="static/js/web2py.js" type="text/javascript"></script><link href="static/css/web2py.css" rel="stylesheet" type="text/css" /><link href="static/css/bootstrap.min.css" rel="stylesheet" type="text/css" /><link href="static/css/bootstrap-responsive.min.css" rel="stylesheet" type="text/css" /><link href="static/css/web2py_bootstrap.css" rel="stylesheet" type="text/css" />


  

  <!-- uncomment here to load jquery-ui
       <link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/themes/base/jquery-ui.css" type="text/css" media="all" />
       <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.min.js" type="text/javascript"></script>
       uncomment to load jquery-ui //-->
  <noscript><link href="static/css/web2py_bootstrap_nojs.css" rel="stylesheet" type="text/css" /></noscript>
  
  <style type="text/css">

      /* Sticky footer styles
      -------------------------------------------------- */

      html,
      body {
        height: 100%;
        /* The html and body elements cannot have any padding or margin. */
      }

      /* Wrapper for page content to push down footer */
      #wrap {
        min-height: 100%;
        height: auto !important;
        height: 100%;
        /* Negative indent footer by it's height */
        margin: 0 auto -60px;
      }

      /* Set the fixed height of the footer here */
      #push,
      #footer {
        height: 60px;
      }
      #footer {
        background-color: #f5f5f5;
      }

      /* Lastly, apply responsive CSS fixes as necessary */
      @media (max-width: 767px) {
        #footer {
          margin-left: -20px;
          margin-right: -20px;
          padding-left: 20px;
          padding-right: 20px;
        }
      }



      /* Custom page CSS
      -------------------------------------------------- */
      /* Not required for template or sticky footer method. */

      .container {
        width: auto;
        max-width: 680px;
      }
      .container .credit {
        margin: 20px 0;
      }

    </style>
</head>

<body>
  
  <body>


    <!-- Part 1: Wrap all page content here -->
    <div id="wrap">

      <!-- Begin page content -->
      <div class="container-fluid">
        <div class="page-header">
          	<h1>
              Diffbook
              <small>easy? diffbook</small>
            </h1>
        </div>
        
        

<div class="pagination">
  <ul>    

      <li><a href="/diffbook/0.html">Chapter 0</a></li>

      <li><a href="/diffbook/1.html">Chapter 1</a></li>

      <li><a href="/diffbook/2.html">Chapter 2</a></li>

      <li><a href="/diffbook/3.html">Chapter 3</a></li>

      <li><a href="/diffbook/4.html">Chapter 4</a></li>

      <li><a href="/diffbook/5.html">Chapter 5</a></li>

      <li><a href="/diffbook/6.html">Chapter 6</a></li>

      <li><a href="/diffbook/7.html">Chapter 7</a></li>

      <li><a href="/diffbook/8.html">Chapter 8</a></li>

      <li><a href="/diffbook/9.html">Chapter 9</a></li>

      <li><a href="/diffbook/10.html">Chapter 10</a></li>

      <li><a href="/diffbook/11.html">Chapter 11</a></li>

      <li><a href="/diffbook/12.html">Chapter 12</a></li>

  </ul>
</div>

<div class="pagination">
  <ul>    

      <li><a href="#com_49f38ab7ef56de1eb4ef48f68427ebf8a46b505d">49f38ab</a></li>

      <li><a href="#com_f2fd41dd2a0d4bf68f5cd4f0989fb32bdc35eac5">f2fd41d</a></li>

      <li><a href="#com_7a03a4c6ff63bf3919d846d23d0335091b23def6">7a03a4c</a></li>

      <li><a href="#com_82dc64e7baa231edd3896ca7a0d41393e426f123">82dc64e</a></li>

      <li><a href="#com_e234f6edf67361b3ba718ea10184ba8e7c2f773d">e234f6e</a></li>

      <li><a href="#com_097d699dc16179206ccb7e4aee863d6523cd471c">097d699</a></li>

      <li><a href="#com_d70086e374f3d93371823e3a509dd0167961b34c">d70086e</a></li>

      <li><a href="#com_76c0363755694c36971ffc9db176312fe5c14276">76c0363</a></li>

      <li><a href="#com_e9cfe4c59d781f0c6856c48992ec384892311fde">e9cfe4c</a></li>

      <li><a href="#com_28816a98948c4a6577f73bdeb2b7424dc55d2582">28816a9</a></li>

      <li><a href="#com_ac4003f4349f9ee22c67309ceeb48de5539b0308">ac4003f</a></li>

      <li><a href="#com_9f8f7358720ecddc06a79b90a68cc94ae5b28603">9f8f735</a></li>

      <li><a href="#com_31b67861f63a89ddbca5db525b9ea745b956670e">31b6786</a></li>

  </ul>
</div>



<ul><li><a href="https://github.com/mdipierro/web2py-book/commit/49f38ab7ef56de1eb4ef48f68427ebf8a46b505d">49f38ab</a><ul><li>Date : 2012-12-26</li><li>more small edits</li></ul></li></ul>
<div class="row-fluid" id="com_49f38ab7ef56de1eb4ef48f68427ebf8a46b505d">
    <div class="span6"><pre style="background-color: #DFF0D8;">##### ``CAT``
``CAT``:inxx

This helper concatenates other helpers, same as TAG[&#x27;&#x27;].
``
&gt;&gt;&gt; print CAT(&#x27;Here is a &#x27;, A(&#x27;link&#x27;,_href=URL()), &#x27;, and here is some &#x27;, B(&#x27;bold text&#x27;), &#x27;.&#x27;)
Here is a &lt;a href=&quot;/app/default/index&quot;&gt;link&lt;/a&gt;, and here is some &lt;b&gt;bold text&lt;/b&gt;.
``:code

##### ``CENTER``
``CENTER``:inxx

This helper centers its content.
``
&gt;&gt;&gt; print CENTER(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;),
&gt;&gt;&gt;              _class=&#x27;test&#x27;, _id=0)
&lt;center id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/center&gt;
``:code

##### ``CODE``
``CODE``:inxx

This helper performs syntax highlighting for Python, C, C++, HTML and web2py code, and is preferable to ``PRE`` for code listings. ``CODE`` also has the ability to create links to the web2py API documentation.

Here is an example of highlighting sections of Python code.
``
&gt;&gt;&gt; print CODE(&#x27;print &quot;hello&quot;&#x27;, language=&#x27;python&#x27;).xml()
&lt;table&gt;&lt;tr valign=&quot;top&quot;&gt;&lt;td style=&quot;width:40px; text-align: right;&quot;&gt;&lt;pre style=&quot;
        font-size: 11px;
        font-family: Bitstream Vera Sans Mono,monospace;
        background-color: transparent;
It makes a list item and should be contained in a ``UL`` or ``OL`` tag.
&gt;&gt;&gt; print LI(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;), _class=&#x27;test&#x27;, _id=0)
&lt;li id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/li&gt;
``:code

##### ``META``

To be used for building ``META`` tags in the ``HTML`` head. For example:

``META``:inxx
``
&gt;&gt;&gt; print META(_name=&#x27;security&#x27;, _content=&#x27;high&#x27;)
&lt;meta name=&quot;security&quot; content=&quot;high&quot; /&gt;
``:code

##### ``MARKMIN``

Implements the markmin wiki syntax. It converts the input text into output html according to the markmin rules described in the example below:

``MARKMIN``:inxx
``
&gt;&gt;&gt; print MARKMIN(&quot;this is **bold** or &#x27;&#x27;italic&#x27;&#x27; and this [[a link http://web2py.com]]&quot;)
&lt;p&gt;this is &lt;b&gt;bold&lt;/b&gt; or &lt;i&gt;italic&lt;/i&gt; and
this &lt;a href=&quot;http://web2py.com&quot;&gt;a link&lt;/a&gt;&lt;/p&gt;
``:code

The markmin syntax is described in this file that ships with web2py:
``
http://127.0.0.1:8000/examples/static/markmin.html
``:code

You can use markmin to generate HTML, LaTeX and PDF documents:
</pre></div>
    <div class="span6"><pre style="background-color: #F2DEDE;">##### ``CAT`` (1.98.1 and up)
``CAT``:inxx

This helper concatenates other helpers, same as TAG[&#x27;&#x27;].
``
&gt;&gt;&gt; print CAT(&#x27;Here is a &#x27;, A(&#x27;link&#x27;,_href=URL()), &#x27;, and here is some &#x27;, B(&#x27;bold text&#x27;), &#x27;.&#x27;)
Here is a &lt;a href=&quot;/app/default/index&quot;&gt;link&lt;/a&gt;, and here is some &lt;b&gt;bold text&lt;/b&gt;.
``:code

##### ``CENTER``
``CENTER``:inxx

This helper centers its content.
``
&gt;&gt;&gt; print CENTER(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;),
&gt;&gt;&gt;              _class=&#x27;test&#x27;, _id=0)
&lt;center id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/center&gt;
``:code

##### ``CODE``
``CODE``:inxx

This helper performs syntax highlighting for Python, C, C++, HTML and web2py code, and is preferable to ``PRE`` for code listings. ``CODE`` also has the ability to create links to the web2py API documentation.

Here is an example of highlighting sections of Python code.
``
&gt;&gt;&gt; print CODE(&#x27;print &quot;hello&quot;&#x27;, language=&#x27;python&#x27;).xml()
&lt;table&gt;&lt;tr valign=&quot;top&quot;&gt;&lt;td style=&quot;width:40px; text-align: right;&quot;&gt;&lt;pre style=&quot;
        font-size: 11px;
        font-family: Bitstream Vera Sans Mono,monospace;
        background-color: transparent;
It makes a list item and should be contained in a ``UL`` or ``OL`` tag.
&gt;&gt;&gt; print LI(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;), _class=&#x27;test&#x27;, _id=0)
&lt;li id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/li&gt;
``:code

##### ``META``

To be used for building ``META`` tags in the ``HTML`` head. For example:

``META``:inxx
``
&gt;&gt;&gt; print META(_name=&#x27;security&#x27;, _content=&#x27;high&#x27;)
&lt;meta name=&quot;security&quot; content=&quot;high&quot; /&gt;
``:code

##### ``MARKMIN``

Implements the markmin wiki syntax. It converts the input text into output html according to the markmin rules described in the example below:

``MARKMIN``:inxx
``
&gt;&gt;&gt; print MARKMIN(&quot;this is **bold** or &#x27;&#x27;italic&#x27;&#x27; and this [[a link http://web2py.com]]&quot;)
&lt;p&gt;this is &lt;b&gt;bold&lt;/b&gt; or &lt;i&gt;italic&lt;/i&gt; and
this &lt;a href=&quot;http://web2py.com&quot;&gt;a link&lt;/a&gt;&lt;/p&gt;
``:code

The markmin syntax is described in this file that ships with web2py:
``
http://127.0.0.1:8000/examples/static/markmin.html
``:code

and some examples are shown in chapter 12 in the context of plugin_wiki, which uses MARKMIN extensively.

You can use markmin to generate HTML, LaTeX and PDF documents:
</pre></div>
</div>
<hr />

<ul><li><a href="https://github.com/mdipierro/web2py-book/commit/f2fd41dd2a0d4bf68f5cd4f0989fb32bdc35eac5">f2fd41d</a><ul><li>Date : 2012-12-31</li><li>spell check of diffs, thanks Joanthan</li></ul></li></ul>
<div class="row-fluid" id="com_f2fd41dd2a0d4bf68f5cd4f0989fb32bdc35eac5">
    <div class="span6"><pre style="background-color: #DFF0D8;">Notice that helpers can be repeated using the multiplication operator:

``
&gt;&gt;&gt; print BR()*5
&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;
``:code

##### ``CAT``
``CAT``:inxx

This helper concatenates other helpers, same as TAG[&#x27;&#x27;].
``
&gt;&gt;&gt; print CAT(&#x27;Here is a &#x27;, A(&#x27;link&#x27;,_href=URL()), &#x27;, and here is some &#x27;, B(&#x27;bold text&#x27;), &#x27;.&#x27;)
Here is a &lt;a href=&quot;/app/default/index&quot;&gt;link&lt;/a&gt;, and here is some &lt;b&gt;bold text&lt;/b&gt;.
``:code

##### ``CENTER``
``CENTER``:inxx

This helper centers its content.
``
&gt;&gt;&gt; print CENTER(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;),
&gt;&gt;&gt;              _class=&#x27;test&#x27;, _id=0)
&lt;center id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/center&gt;
``:code

##### ``CODE``
``CODE``:inxx

This helper performs syntax highlighting for Python, C, C++, HTML and web2py code, and is preferable to ``PRE`` for code listings. ``CODE`` also has the ability to create links to the web2py API documentation.

The &quot;views/layout.html&quot; that ships with the web2py scaffolding application **wel
            &lt;div class=&quot;footer-content&quot;&gt;
                {{block footer}} &lt;!-- this is default footer --&gt;
                ...
                {{end}}
            &lt;/div&gt;
        &lt;/footer&gt;
    &lt;/div&gt;

  &lt;/div&gt; &lt;!-- /container --&gt;

  &lt;!-- The javascript =============================================
       (Placed at the end of the document so the pages load faster) --&gt;
  &lt;script src=&quot;{{=URL(&#x27;static&#x27;,&#x27;js/bootstrap.min.js&#x27;)}}&quot;&gt;&lt;/script&gt;
  &lt;script src=&quot;{{=URL(&#x27;static&#x27;,&#x27;js/web2py_bootstrap.js&#x27;)}}&quot;&gt;&lt;/script&gt;
  {{if response.google_analytics_id:}}
    &lt;script src=&quot;{{=URL(&#x27;static&#x27;,&#x27;js/analytics.js&#x27;)}}&quot;&gt;&lt;/script&gt;
    &lt;script type=&quot;text/javascript&quot;&gt;
    analytics.initialize({
      &#x27;Google Analytics&#x27;:{trackingId:&#x27;{{=response.google_analytics_id}}&#x27;}
    });&lt;/script&gt;
  {{pass}}
&lt;/body&gt;
&lt;/html&gt;
``:code

There are a few features of this default layout that make it very easy to use and customize:

- It is written in HTML5 and uses the &quot;modernizr&quot; ``modernizr``:cite library for backward compatibility. The actual layout include some extra conditional statements required by IE and they are omitted for brevity.
- It displays both ``response.title`` and ``response.subtitle`` which can be set in a model. If they are not set, it adopts the application name as title
- It includes the ``web2py_ajax.html`` file in the header which generated all the link and script import statements.
- It uses a modified version of Twitter Bootstrap for flexible layouts which works on mobile devices and re-arranges columns to fit small screens.
- It uses &quot;analytics.js&quot; to connect to Google Analytics.
- The ``{{=auth.navbar(...)}}`` displays a welcome to the current user and links to auth functions like login, logout, register, change password, etc. depending on context. It is a helper factory and its output can be manipulated as any other helper. It is placed in a ``{{try:}}...{{except:pass}}`` in case auth is undefined.
- The ``{{=MENU(response.menu)`` displays the menu structure as ``&lt;ul&gt;...&lt;/ul&gt;``.
- ``{{include}}`` is replaced by the content of the extending view when the page is rendered.
- By default it uses a conditional three column (the left and right sidebars can be turned off by the extending views)
- It uses the following classes: header, main, footer
- It contains the following blocks: statusbar, left_sidebar, center, right_sidebar, footer.

In views can turn on and fill sidebars as follows:

``
{{left_sidebar_enable=True}}
{{extend &#x27;layout.html&#x27;}}

This text goes in center

{{block left_sidebar}}
This text goes in sidebar
{{end}}
``:code

#### Customizing the default layout

``CSS``:inxx

Customizing the default layout without editing is easy because the welcome application is based on Twitter Bootstrap which is well documented and supports themes. In web2py four static files which are relevant to style:

- &quot;css/web2py.css&quot; contains web2py specific styles
- &quot;css/bootstrap.min.css&quot; contains the Twitter Bootstrap CSS style ``bootstrap``:cite ``Bootstrap``:inxx
- &quot;css/web2py_bootstrap.css&quot; contains with overrides some Bootstrap styles to conform to web2py needs.
- &quot;js/bootstrap.min.js&quot; which includes the libraries for menu effects, modals, panels.
</pre></div>
    <div class="span6"><pre style="background-color: #F2DEDE;">Notice that halpers can be repeated using the multiplication operator:

``
&gt;&gt;&gt; print BR()*5
&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;
``:code

##### ``CAT``
``CAT``:inxx

This helper concatenates other helpers, same as TAG[&#x27;&#x27;].
``
&gt;&gt;&gt; print CAT(&#x27;Here is a &#x27;, A(&#x27;link&#x27;,_href=URL()), &#x27;, and here is some &#x27;, B(&#x27;bold text&#x27;), &#x27;.&#x27;)
Here is a &lt;a href=&quot;/app/default/index&quot;&gt;link&lt;/a&gt;, and here is some &lt;b&gt;bold text&lt;/b&gt;.
``:code

##### ``CENTER``
``CENTER``:inxx

This helper centers its content.
``
&gt;&gt;&gt; print CENTER(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;),
&gt;&gt;&gt;              _class=&#x27;test&#x27;, _id=0)
&lt;center id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/center&gt;
``:code

##### ``CODE``
``CODE``:inxx

This helper performs syntax highlighting for Python, C, C++, HTML and web2py code, and is preferable to ``PRE`` for code listings. ``CODE`` also has the ability to create links to the web2py API documentation.

The &quot;views/layout.html&quot; that ships with the web2py scaffolding application **wel
            &lt;div class=&quot;footer-content&quot;&gt;
                {{block footer}} &lt;!-- this is default footer --&gt;
                ...
                {{end}}
            &lt;/div&gt;
        &lt;/footer&gt;
    &lt;/div&gt;

  &lt;/div&gt; &lt;!-- /container --&gt;

  &lt;!-- The javascript =============================================
       (Placed at the end of the document so the pages load faster) --&gt;
  &lt;script src=&quot;{{=URL(&#x27;static&#x27;,&#x27;js/bootstrap.min.js&#x27;)}}&quot;&gt;&lt;/script&gt;
  &lt;script src=&quot;{{=URL(&#x27;static&#x27;,&#x27;js/web2py_bootstrap.js&#x27;)}}&quot;&gt;&lt;/script&gt;
  {{if response.google_analytics_id:}}
    &lt;script src=&quot;{{=URL(&#x27;static&#x27;,&#x27;js/analytics.js&#x27;)}}&quot;&gt;&lt;/script&gt;
    &lt;script type=&quot;text/javascript&quot;&gt;
    analytics.initialize({
      &#x27;Google Analytics&#x27;:{trackingId:&#x27;{{=response.google_analytics_id}}&#x27;}
    });&lt;/script&gt;
  {{pass}}
&lt;/body&gt;
&lt;/html&gt;
``:code

There are a few features of this default layout that make it very easy to use and customize:

- It is written in HTML5 and uses the &quot;modernizr&quot; ``modernizr``:cite library for backward compatibility. The actual layout include some extra conditional statements required by IE and they are omitted for brevity.
- It displays both ``response.title`` and ``response.subtitle`` which can be set in a model. If they are not set, it adopts the application name as title
- It includes the ``web2py_ajax.html`` file in the header which generated all the link and script import statements.
- It uses a modified version of Twitter Boostrap for flexible layouts which works on mobile devices and re-arranges columns to fit small screens.
- It uses &quot;analytics.js&quot; to connect to Google Analytics.
- The ``{{=auth.navbar(...)}}`` displays a welcome to the current user and links to auth functions like login, logout, register, change password, etc. depending on context. It is a helper factory and its output can be manipulated as any other helper. It is placed in a ``{{try:}}...{{except:pass}}`` in case auth is undefined.
- The ``{{=MENU(response.menu)`` displays the menu structure as ``&lt;ul&gt;...&lt;/ul&gt;``.
- ``{{include}}`` is replaced by the content of the extending view when the page is rendered.
- By default it uses a conditional three column (the left and right sidebars can be turned off by the extending views)
- It uses the following classes: header, main, footer
- It contains the following blocks: statusbar, left_sidebar, center, right_sidebar, footer.

In views can turn on and fill sidebars as follows:

``
{{left_sidebar_enable=True}}
{{extend &#x27;layout.html&#x27;}}

This text goes in center

{{block left_sidebar}}
This text goes in sidebar
{{end}}
``:code

#### Customizing the default layout

``CSS``:inxx

Customizing the default layout without editing is easy because the welcome application is based on Twitter Bootstrap which is well documented and supports themes. In web2py four static files which are relevant to style:

- &quot;css/web2py.css&quot; contains web2py specific styles
- &quot;css/bootstrap.min.css&quot; contains the Twitter Boostrap CSS style ``bootstrap``:cite ``Bootstrap``:inxx
- &quot;css/web2py_bootstrap.css&quot; contains with overrides some Bootstrap styles to conform to web2py needs.
- &quot;js/bootstrap.min.js&quot; which includes the libraries for menu effects, modals, panels.
</pre></div>
</div>
<hr />

<ul><li><a href="https://github.com/mdipierro/web2py-book/commit/7a03a4c6ff63bf3919d846d23d0335091b23def6">7a03a4c</a><ul><li>Date : 2012-11-14</li><li>Typo + added references to bootstrap and superfish</li></ul></li></ul>
<div class="row-fluid" id="com_7a03a4c6ff63bf3919d846d23d0335091b23def6">
    <div class="span6"><pre style="background-color: #DFF0D8;">## The views
``views``:inxx ``template language``:inxx ``HTML``:inxx

web2py uses Python for its models, controllers, and views, although it uses a slightly modified Python syntax in the views to allow more readable code without imposing any restrictions on proper Python usage.

The purpose of a view is to embed code (Python) in an HTML document. In general, this poses some problems:
- How should embedded code be escaped?
- Should indenting be based on Python or HTML rules?

web2py uses ``{{ ... }}`` to escape Python code embedded in HTML. The advantage of using curly brackets instead of angle brackets is that it&#x27;s transparent to all common HTML editors. This allows the developer to use those editors to create web2py views.

Since the developer is embedding Python code into HTML, the document should be indented according to HTML rules, and not Python rules. Therefore, we allow unindented Python inside the ``{{ ... }}`` tags. Since Python normally uses indentation to delimit blocks of code, we need a different way to delimit them; this is why the web2py template language makes use of the Python keyword ``pass``.

-------
A code block starts with a line ending with a colon and ends with a line beginning with ``pass``. The keyword ``pass`` is not necessary when the end of the block is obvious from the context.
-------

Here is an example:

``
{{
if i == 0:
response.write(&#x27;i is 0&#x27;)
else:
response.write(&#x27;i is not 0&#x27;)
pass
}}
``:code

Note that ``pass`` is a Python keyword, not a web2py keyword. Some Python editors, such as Emacs, use the keyword ``pass`` to signify the division of blocks and use it to re-indent code automatically.

The web2py template language does exactly the same. When it finds something like:

``
&lt;html&gt;&lt;body&gt;
{{for x in range(10):}}{{=x}}hello&lt;br /&gt;{{pass}}
&lt;/body&gt;&lt;/html&gt;
``:code

it translates it into a program:
``
response.write(&quot;&quot;&quot;&lt;html&gt;&lt;body&gt;&quot;&quot;&quot;, escape=False)
for x in range(10):
    response.write(x)
    response.write(&quot;&quot;&quot;hello&lt;br /&gt;&quot;&quot;&quot;, escape=False)
response.write(&quot;&quot;&quot;&lt;/body&gt;&lt;/html&gt;&quot;&quot;&quot;, escape=False)
``:code
``response.write`` writes to the ``response.body``.

When there is an error in a web2py view, the error report shows the generated view code, not the actual view as written by the developer. This helps the developer debug the code by highlighting the actual code that is executed (which is something that can be debugged with an HTML editor or the DOM inspector of the browser).

Also note that:
``
{{=x}}
``:code

generates
``response.write``:inxx ``escape``:inxx
``
response.write(x)
``:code

Variables injected into the HTML in this way are escaped by default.
The escaping is ignored if ``x`` is an ``XML`` object, even if escape is set to ``True``.

Here is an example that introduces the ``H1`` helper:
``
{{=H1(i)}}
``:code

which is translated to:
``
response.write(H1(i))
``:code

upon evaluation, the ``H1`` object and its components are recursively serialized, escaped and written to the response body. The tags generated by ``H1`` and inner HTML are not escaped. This mechanism guarantees that all text --- and only text --- displayed on the web page is always escaped, thus preventing XSS vulnerabilities. At the same time, the code is simple and easy to debug.

The method ``response.write(obj, escape=True)`` takes two arguments, the object to be written and whether it has to be escaped (set to ``True`` by default). If ``obj`` has an ``.xml()`` method, it is called and the result written to the response body (the ``escape`` argument is ignored). Otherwise it uses the object&#x27;s ``__str__`` method to serialize it and, if the escape argument is ``True``, escapes it. All built-in helper objects (``H1`` in the example) are objects that know how to serialize themselves via the ``.xml()`` method.

This is all done transparently. You never need to (and never should) call the ``response.write`` method explicitly.

### Basic syntax

The web2py template language supports all Python control structures. Here we provide some examples of each of them. They can be nested according to usual programming practice.

#### ``for...in``
``for``:inxx

In templates you can loop over any iterable object:
``
{{items = [&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;]}}
&lt;ul&gt;
{{for item in items:}}&lt;li&gt;{{=item}}&lt;/li&gt;{{pass}}
&lt;/ul&gt;
``:code

which produces:
``
&lt;ul&gt;
&lt;li&gt;a&lt;/li&gt;
&lt;li&gt;b&lt;/li&gt;
&lt;li&gt;c&lt;/li&gt;
&lt;/ul&gt;
``:code

Here ``item`` is any iterable object such as a Python list, Python tuple, or Rows object, or any object that is implemented as an iterator. The elements displayed are first serialized and escaped.

#### ``while``
``while``:inxx

You can create a loop using the while keyword:
``
{{k = 3}}
&lt;ul&gt;
{{while k &gt; 0:}}&lt;li&gt;{{=k}}{{k = k - 1}}&lt;/li&gt;{{pass}}
&lt;/ul&gt;
``:code

which produces:
``
&lt;ul&gt;
&lt;li&gt;3&lt;/li&gt;
&lt;li&gt;2&lt;/li&gt;
&lt;li&gt;1&lt;/li&gt;
&lt;/ul&gt;
``:code

#### ``if...elif...else``
``if``:inxx ``elif``:inxx ``else``:inxx

You can use conditional clauses:
``
{{
import random
k = random.randint(0, 100)
}}
&lt;h2&gt;
{{=k}}
{{if k % 2:}}is odd{{else:}}is even{{pass}}
&lt;/h2&gt;
``:code

which produces:
``
&lt;h2&gt;
45 is odd
&lt;/h2&gt;
``:code

Since it is obvious that ``else`` closes the first ``if`` block, there is no need for a ``pass`` statement, and using one would be incorrect. However, you must explicitly close the ``else`` block with a ``pass``.

Recall that in Python &quot;else if&quot; is written ``elif`` as in the following example:
``
{{
import random
k = random.randint(0, 100)
}}
&lt;h2&gt;
{{=k}}
{{if k % 4 == 0:}}is divisible by 4
{{elif k % 2 == 0:}}is even
{{else:}}is odd
{{pass}}
&lt;/h2&gt;
``:code

It produces:
``
&lt;h2&gt;
64 is divisible by 4
&lt;/h2&gt;
``:code

#### ``try...except...else...finally``
``try``:inxx ``except``:inxx ``else``:inxx ``finally``:inxx

It is also possible to use ``try...except`` statements in views with one caveat. Consider the following example:
``
{{try:}}
Hello {{= 1 / 0}}
{{except:}}
division by zero
{{else:}}
no division by zero
{{finally}}
&lt;br /&gt;
{{pass}}
``:code

It will produce the following output:
``
Hello
division by zero
&lt;br /&gt;
``:code

This example illustrates that all output generated before an exception occurs is rendered (including output that preceded the exception) inside the try block. &quot;Hello&quot; is written because it precedes the exception.

#### ``def...return``
``def``:inxx ``return``:inxx

The web2py template language allows the developer to define and implement functions that can return any Python object or a text/html string. Here we consider two examples:
``
{{def itemize1(link): return LI(A(link, _href=&quot;http://&quot; + link))}}
&lt;ul&gt;
{{=itemize1(&#x27;www.google.com&#x27;)}}
&lt;/ul&gt;
``:code

produces the following output:
``
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http:/www.google.com&quot;&gt;www.google.com&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
``:code

The function ``itemize1`` returns a helper object that is inserted at the location where the function is called.

Consider now the following code:
``
{{def itemize2(link):}}
&lt;li&gt;&lt;a href=&quot;http://{{=link}}&quot;&gt;{{=link}}&lt;/a&gt;&lt;/li&gt;
{{return}}
&lt;ul&gt;
{{itemize2(&#x27;www.google.com&#x27;)}}
&lt;/ul&gt;
``:code

It produces exactly the same output as above. In this case, the function ``itemize2`` represents a piece of HTML that is going to replace the web2py tag where the function is called. Notice that there is no &#x27;=&#x27; in front of the call to ``itemize2``, since the function does not return the text, but it writes it directly into the response.

There is one caveat: functions defined inside a view must terminate with a return statement, or the automatic indentation will fail.

### HTML helpers
``helpers``:inxx

Consider the following code in a view:
``
{{=DIV(&#x27;this&#x27;, &#x27;is&#x27;, &#x27;a&#x27;, &#x27;test&#x27;, _id=&#x27;123&#x27;, _class=&#x27;myclass&#x27;)}}
``:code

it is rendered as:
``
&lt;div id=&quot;123&quot; class=&quot;myclass&quot;&gt;thisisatest&lt;/div&gt;
``:code
``DIV`` is a helper class, i.e., something that can be used to build HTML programmatically. It corresponds to the HTML ``&lt;div&gt;`` tag.

Positional arguments are interpreted as objects contained between the open and close tags. Named arguments that start with an underscore are interpreted as HTML tag attributes (without the underscore). Some helpers also have named arguments that do not start with underscore; these arguments are tag-specific.

Instead of a set of unnamed arguments, a helper can also take a single list or tuple as its set of components using the ``*`` notation and it can take a single dictionary as its set of attributes using the ``**``, for example:
``
{{
contents = [&#x27;this&#x27;,&#x27;is&#x27;,&#x27;a&#x27;,&#x27;test&#x27;]
attributes = {&#x27;_id&#x27;:&#x27;123&#x27;, &#x27;_class&#x27;:&#x27;myclass&#x27;}
=DIV(*contents,**attributes)
}}
``:code
(produces the same output as before).

The following set of helpers:

``A``,  ``B``,  ``BEAUTIFY``,  ``BODY``,  ``BR``,  ``CAT``,  ``CENTER``,  ``CODE``,  ``COL``, ``COLGROUP``, ``DIV``,  ``EM``,  ``EMBED``,  ``FIELDSET``,  ``FORM``,  ``H1``,  ``H2``,  ``H3``,  ``H4``,  ``H5``,  ``H6``,  ``HEAD``,  ``HR``,  ``HTML``,  ``I``,  ``IFRAME``,  ``IMG``,  ``INPUT``,  ``LABEL``,  ``LEGEND``,  ``LI``,  ``LINK``,  ``MARKMIN``,  ``MENU``,  ``META``,  ``OBJECT``,  ``ON``,  ``OL``,  ``OPTGROUP``,  ``OPTION``,  ``P``,  ``PRE``,  ``SCRIPT``,  ``SELECT``,  ``SPAN``,  ``STYLE``,  ``TABLE``,  ``TAG``,  ``TBODY``,  ``TD``,  ``TEXTAREA``,  ``TFOOT``,  ``TH``,  ``THEAD``,  ``TITLE``,  ``TR``,  ``TT``, ``UL``,   ``URL``,  ``XHTML``,  ``XML``,  ``embed64``,  ``xmlescape``

can be used to build complex expressions that can then be serialized to XML``xml:w``:cite ``xml:o``:cite. For example:
``
{{=DIV(B(I(&quot;hello &quot;, &quot;&lt;world&gt;&quot;))), _class=&quot;myclass&quot;)}}
``:code

is rendered:
``
&lt;div class=&quot;myclass&quot;&gt;&lt;b&gt;&lt;i&gt;hello &amp;lt;world&amp;gt;&lt;/i&gt;&lt;/b&gt;&lt;/div&gt;
``:code

Helpers can also be serialized into strings, equivalently, with the ``__str__`` and the ``xml`` methods:

``
&gt;&gt;&gt; print str(DIV(&quot;hello world&quot;))
&lt;div&gt;hello world&lt;/div&gt;
&gt;&gt;&gt; print DIV(&quot;hello world&quot;).xml()
&lt;div&gt;hello world&lt;/div&gt;
``

``Document Object Model (DOM)``:inxx
The helpers mechanism in web2py is more than a system to generate HTML without concatenating strings. It provides a server-side representation of the Document Object Model (DOM).

Components of helpers can be referenced via their position, and helpers act as lists with respect to their components:
``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;a&#x27;, &#x27;b&#x27;), &#x27;c&#x27;)
&gt;&gt;&gt; print a
&lt;div&gt;&lt;span&gt;ab&lt;/span&gt;c&lt;/div&gt;
&gt;&gt;&gt; del a[1]
&gt;&gt;&gt; a.append(B(&#x27;x&#x27;))
&gt;&gt;&gt; a[0][0] = &#x27;y&#x27;
&gt;&gt;&gt; print a
&lt;div&gt;&lt;span&gt;yb&lt;/span&gt;&lt;b&gt;x&lt;/b&gt;&lt;/div&gt;
``:code

Attributes of helpers can be referenced by name, and helpers act as dictionaries with respect to their attributes:
``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;a&#x27;, &#x27;b&#x27;), &#x27;c&#x27;)
&gt;&gt;&gt; a[&#x27;_class&#x27;] = &#x27;s&#x27;
&gt;&gt;&gt; a[0][&#x27;_class&#x27;] = &#x27;t&#x27;
&gt;&gt;&gt; print a
&lt;div class=&quot;s&quot;&gt;&lt;span class=&quot;t&quot;&gt;ab&lt;/span&gt;c&lt;/div&gt;
``:code

Note, the complete set of components can be accessed via a list called ``a.components``, and the complete set of attributes can be accessed via a dictionary called ``a.attributes``. So, ``a[i]`` is equivalent to ``a.components[i]`` when ``i`` is an integer, and ``a[s]`` is equivalent to ``a.attributes[s]`` when ``s`` is a string.

Notice that helper attributes are passed as keyword arguments to the helper. In some cases, however, attribute names include special characters that are not allowed in Python identifiers (e.g., hyphens) and therefore cannot be used as keyword argument names. For example:

``
DIV(&#x27;text&#x27;, _data-role=&#x27;collapsible&#x27;)
``:code

will not work because &quot;_data-role&quot; includes a hyphen, which will produce a Python syntax error.

In such cases, you can instead pass the attributes as a dictionary and make use of Python&#x27;s ``**`` function arguments notation, which map a dictionary of (key:value) pairs into a set of keyword arguments:

``
&gt;&gt;&gt; print DIV(&#x27;text&#x27;, **{&#x27;_data-role&#x27;: &#x27;collapsible&#x27;})
&lt;div data-role=&quot;collapsible&quot;&gt;text&lt;/div&gt;
``:code

You can also dynamically create special TAGs:

``
&gt;&gt;&gt; print TAG[&#x27;soap:Body&#x27;](&#x27;whatever&#x27;,**{&#x27;_xmlns:m&#x27;:&#x27;http://www.example.org&#x27;})
&lt;soap:Body xmlns:m=&quot;http://www.example.org&quot;&gt;whatever&lt;/soap:Body&gt;
``:code

#### ``XML``
``XML``:inxx
``XML`` is an object used to encapsulate text that should not be escaped. The text may or may not contain valid XML. For example, it could contain JavaScript.

The text in this example is escaped:
``
&gt;&gt;&gt; print DIV(&quot;&lt;b&gt;hello&lt;/b&gt;&quot;)
&amp;lt;b&amp;gt;hello&amp;lt;/b&amp;gt;
``:code

by using ``XML`` you can prevent escaping:
``
&gt;&gt;&gt; print DIV(XML(&quot;&lt;b&gt;hello&lt;/b&gt;&quot;))
&lt;b&gt;hello&lt;/b&gt;
``:code

Sometimes you want to render HTML stored in a variable, but the HTML may contain unsafe tags such as scripts:
``
&gt;&gt;&gt; print XML(&#x27;&lt;script&gt;alert(&quot;unsafe!&quot;)&lt;/script&gt;&#x27;)
&lt;script&gt;alert(&quot;unsafe!&quot;)&lt;/script&gt;
``:code

Un-escaped executable input such as this (for example, entered in the body of a comment in a blog) is unsafe, because it can be used to generate Cross Site Scripting (XSS) attacks against other visitors to the page.

``sanitize``:inxx
The web2py ``XML`` helper can sanitize our text to prevent injections and escape all tags except those that you explicitly allow. Here is an example:
``
&gt;&gt;&gt; print XML(&#x27;&lt;script&gt;alert(&quot;unsafe!&quot;)&lt;/script&gt;&#x27;, sanitize=True)
&amp;lt;script&amp;gt;alert(&amp;quot;unsafe!&amp;quot;)&amp;lt;/script&amp;gt;
``:code

The ``XML`` constructors, by default, consider the content of some tags and some of their attributes safe. You can override the defaults using the optional ``permitted_tags`` and ``allowed_attributes`` arguments. Here are the default values of the optional arguments of the ``XML`` helper.
``
XML(text, sanitize=False,
    permitted_tags=[&#x27;a&#x27;, &#x27;b&#x27;, &#x27;blockquote&#x27;, &#x27;br/&#x27;, &#x27;i&#x27;, &#x27;li&#x27;,
       &#x27;ol&#x27;, &#x27;ul&#x27;, &#x27;p&#x27;, &#x27;cite&#x27;, &#x27;code&#x27;, &#x27;pre&#x27;, &#x27;img/&#x27;],
    allowed_attributes={&#x27;a&#x27;:[&#x27;href&#x27;, &#x27;title&#x27;],
       &#x27;img&#x27;:[&#x27;src&#x27;, &#x27;alt&#x27;], &#x27;blockquote&#x27;:[&#x27;type&#x27;]})
``:code

#### Built-in helpers

##### ``A``

This helper is used to build links.

``A``:inxx
``
&gt;&gt;&gt; print A(&#x27;&lt;click&gt;&#x27;, XML(&#x27;&lt;b&gt;me&lt;/b&gt;&#x27;),
            _href=&#x27;http://www.web2py.com&#x27;)
&lt;a href=&#x27;http://www.web2py.com&#x27;&gt;&amp;lt;click&amp;gt;&lt;b&gt;me/b&gt;&lt;/a&gt;
``:code

Instead of ``_href`` you can pass the URL using the ``callback`` argument. For example in a view:

``
{{=A(&#x27;click me&#x27;, callback=URL(&#x27;myaction&#x27;))}}
``

and the effect of pressing the link will be an ajax call to &quot;myaction&quot; instead of a redirection.
In this case, optionally you can specify two more arguments: ``target`` and ``delete``:
``
{{=A(&#x27;click me&#x27;, callback=URL(&#x27;myaction&#x27;), target=&quot;t&quot;)}}
&lt;div id=&quot;t&quot;&gt;&lt;div&gt;
``
and the response of the ajax callback will be stored in the DIV with id equal to &quot;t&quot;.

``
&lt;div id=&quot;b&quot;&gt;{{=A(&#x27;click me&#x27;, callback=URL(&#x27;myaction&#x27;), delete=&#x27;div#b&quot;)}}&lt;/div&gt;
``
and upon response, the closest tag matching &quot;div#b&quot; will be deleted. In this case, the button will be deleted.
A typical application is:

``
{{=A(&#x27;click me&#x27;, callback=URL(&#x27;myaction&#x27;), delete=&#x27;tr&quot;)}}
``

in a table. Pressing the button will perform the callback and delete the table row.

``callback`` and ``delete`` can be combined.

The A helper takes a special argument called ``cid``. It works as follows:

``
{{=A(&#x27;linked page&#x27;, _href=&#x27;http://example.com&#x27;, cid=&#x27;myid&#x27;)}}
&lt;div id=&quot;myid&quot;&gt;&lt;/div&gt;
``:code

and a click on the link causes the content to be loaded in the div. This is similar but more powerful than the above syntax since it is designed to refresh page components. We discuss applications of ``cid`` in more detail in Chapter 12, in the context of components.

These ajax features require jQuery and &quot;static/js/web2py_ajax.js&quot;, which are automatically included by placing ``{{include &#x27;web2py_ajax.html&#x27;}}`` in the layout head. &quot;views/web2py_ajax.html&quot; defines some variables based on ``request`` and includes all necessary js and css files.


##### ``B``
``B``:inxx

This helper makes its contents bold.
``
&gt;&gt;&gt; print B(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;i&gt;world&lt;/i&gt;&#x27;), _class=&#x27;test&#x27;, _id=0)
&lt;b id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;i&gt;world&lt;/i&gt;&lt;/b&gt;
``:code

##### ``BODY``
``BODY``:inxx
This helper makes the body of a page.
``
&gt;&gt;&gt; print BODY(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;), _bgcolor=&#x27;red&#x27;)
&lt;body bgcolor=&quot;red&quot;&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/body&gt;
``:code

##### ``BR``
``BR``:inxx

This helper creates a line break.
``
&gt;&gt;&gt; print BR()
&lt;br /&gt;
``:code

##### ``CAT`` (1.98.1 and up)
``CAT``:inxx

This helper concatenates other helpers, same as TAG[&#x27;&#x27;].
``
&gt;&gt;&gt; print CAT(&#x27;Here is a &#x27;, A(&#x27;link&#x27;,_href=URL()), &#x27;, and here is some &#x27;, B(&#x27;bold text&#x27;), &#x27;.&#x27;)
Here is a &lt;a href=&quot;/app/default/index&quot;&gt;link&lt;/a&gt;, and here is some &lt;b&gt;bold text&lt;/b&gt;.
``:code

##### ``CENTER``
``CENTER``:inxx

This helper centers its content.
``
&gt;&gt;&gt; print CENTER(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;),
&gt;&gt;&gt;              _class=&#x27;test&#x27;, _id=0)
&lt;center id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/center&gt;
``:code

##### ``CODE``
``CODE``:inxx

This helper performs syntax highlighting for Python, C, C++, HTML and web2py code, and is preferable to ``PRE`` for code listings. ``CODE`` also has the ability to create links to the web2py API documentation.

Here is an example of highlighting sections of Python code.
``
&gt;&gt;&gt; print CODE(&#x27;print &quot;hello&quot;&#x27;, language=&#x27;python&#x27;).xml()
&lt;table&gt;&lt;tr valign=&quot;top&quot;&gt;&lt;td style=&quot;width:40px; text-align: right;&quot;&gt;&lt;pre style=&quot;
        font-size: 11px;
        font-family: Bitstream Vera Sans Mono,monospace;
        background-color: transparent;
            margin: 0;
            padding: 5px;
            border: none;
        background-color: #E0E0E0;
        color: #A0A0A0;
    &quot;&gt;1.&lt;/pre&gt;&lt;/td&gt;&lt;td&gt;&lt;pre style=&quot;
        font-size: 11px;
        font-family: Bitstream Vera Sans Mono,monospace;
        background-color: transparent;
            margin: 0;
            padding: 5px;
            border: none;
            overflow: auto;
    &quot;&gt;&lt;span style=&quot;color:#185369; font-weight: bold&quot;&gt;print &lt;/span&gt;
    &lt;span style=&quot;color: #FF9966&quot;&gt;&quot;hello&quot;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;
``:code

Here is a similar example for HTML
``
&gt;&gt;&gt; print CODE(
&gt;&gt;&gt;   &#x27;&lt;html&gt;&lt;body&gt;{{=request.env.remote_add}}&lt;/body&gt;&lt;/html&gt;&#x27;,
&gt;&gt;&gt;   language=&#x27;html&#x27;)
``:code
``
&lt;table&gt;...&lt;code&gt;...
&lt;html&gt;&lt;body&gt;{{=request.env.remote_add}}&lt;/body&gt;&lt;/html&gt;
...&lt;/code&gt;...&lt;/table&gt;
``:code

These are the default arguments for the ``CODE`` helper:
``
CODE(&quot;print &#x27;hello world&#x27;&quot;, language=&#x27;python&#x27;, link=None, counter=1, styles={})
``:code

Supported values for the ``language`` argument are &quot;python&quot;, &quot;html_plain&quot;, &quot;c&quot;, &quot;cpp&quot;, &quot;web2py&quot;, and &quot;html&quot;. The &quot;html&quot; language interprets {{ and }} tags as &quot;web2py&quot; code, while &quot;html_plain&quot; doesn&#x27;t.

If a ``link`` value is specified, for example &quot;/examples/global/vars/&quot;, web2py API references in the code are linked to documentation at the link URL. For example &quot;request&quot; would be linked to &quot;/examples/global/vars/request&quot;. In the above example, the link URL is handled by the &quot;vars&quot; action in the &quot;global.py&quot; controller that is distributed as part of the web2py &quot;examples&quot; application.

The ``counter`` argument is used for line numbering. It can be set to any of three different values. It can be ``None`` for no line numbers, a numerical value specifying the start number, or a string. If the counter is set to a string, it is interpreted as a prompt, and there are no line numbers.

The ``styles`` argument is a bit tricky. If you look at the generated HTML above, it contains a table with two columns, and each column has its own style declared inline using CSS. The ``styles`` attributes allows you to override those two CSS styles. For example:

``
{{=CODE(...,styles={&#x27;CODE&#x27;:&#x27;margin: 0;padding: 5px;border: none;&#x27;})}}
``:code

The ``styles`` attribute must be a dictionary, and it allows two possible keys: ``CODE`` for the style of the actual code, and ``LINENUMBERS`` for the style of the left column, which contains the line numbers. Mind that these styles completely replace the default styles and are not simply added to them.

##### ``COL``
``COL``:inxx

``
&gt;&gt;&gt; print COL(&#x27;a&#x27;,&#x27;b&#x27;)
&lt;col&gt;ab&lt;/col&gt;
``:code

##### ``COLGROUP``
``COLGROUP``:inxx

``
&gt;&gt;&gt; print COLGROUP(&#x27;a&#x27;,&#x27;b&#x27;)
&lt;colgroup&gt;ab&lt;/colgroup&gt;
``:code

##### ``DIV``
All helpers apart from ``XML`` are derived from ``DIV`` and inherit its basic methods.

``DIV``:inxx
``
&gt;&gt;&gt; print DIV(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;), _class=&#x27;test&#x27;, _id=0)
&lt;div id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/div&gt;
``:code

##### ``EM``

Emphasizes its content.

``EM``:inxx
``
&gt;&gt;&gt; print EM(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;), _class=&#x27;test&#x27;, _id=0)
&lt;em id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/em&gt;
``:code

##### ``FIELDSET``
``FIELDSET``:inxx

This is used to create an input field together with its label.
``
&gt;&gt;&gt; print FIELDSET(&#x27;Height:&#x27;, INPUT(_name=&#x27;height&#x27;), _class=&#x27;test&#x27;)
&lt;fieldset class=&quot;test&quot;&gt;Height:&lt;input name=&quot;height&quot; /&gt;&lt;/fieldset&gt;
``:code

##### ``FORM``
``FORM``:inxx

This is one of the most important helpers. In its simple form, it just makes a ``&lt;form&gt;...&lt;/form&gt;`` tag, but because helpers are objects and have knowledge of what they contain, they can process submitted forms (for example, perform validation of the fields). This will be discussed in detail in Chapter 7.
``
&gt;&gt;&gt; print FORM(INPUT(_type=&#x27;submit&#x27;), _action=&#x27;&#x27;, _method=&#x27;post&#x27;)
&lt;form enctype=&quot;multipart/form-data&quot; action=&quot;&quot; method=&quot;post&quot;&gt;
&lt;input type=&quot;submit&quot; /&gt;&lt;/form&gt;
``:code

The &quot;enctype&quot; is &quot;multipart/form-data&quot; by default.

``hidden``:inxx
The constructor of a ``FORM``, and of ``SQLFORM``, can also take a special argument called ``hidden``. When a dictionary is passed as ``hidden``, its items are translated into &quot;hidden&quot; INPUT fields. For example:
``
&gt;&gt;&gt; print FORM(hidden=dict(a=&#x27;b&#x27;))
&lt;form enctype=&quot;multipart/form-data&quot; action=&quot;&quot; method=&quot;post&quot;&gt;
&lt;input value=&quot;b&quot; type=&quot;hidden&quot; name=&quot;a&quot; /&gt;&lt;/form&gt;
``:code

##### ``H1``, ``H2``, ``H3``, ``H4``, ``H5``, ``H6``
``H1``:inxx

These helpers are for paragraph headings and subheadings:
``
&gt;&gt;&gt; print H1(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;), _class=&#x27;test&#x27;, _id=0)
&lt;h1 id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/h1&gt;
``:code

##### ``HEAD``

For tagging the HEAD of an HTML page.

``HEAD``:inxx
``
&gt;&gt;&gt; print HEAD(TITLE(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;)))
&lt;head&gt;&lt;title&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/title&gt;&lt;/head&gt;
``:code

##### ``HTML``
``HTML``:inxx ``XHTML``:inxx

This helper is a little different. In addition to making the ``&lt;html&gt;`` tags,
it prepends the tag with a doctype string``xhtml:w,xhtml:o,xhtml:school``:cite .
``
&gt;&gt;&gt; print HTML(BODY(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;)))
&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;
                      &quot;http://www.w3.org/TR/html4/loose.dtd&quot;&gt;
&lt;html&gt;&lt;body&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/body&gt;&lt;/html&gt;
``:code

The HTML helper also takes some additional optional arguments that have the following default:
``
HTML(..., lang=&#x27;en&#x27;, doctype=&#x27;transitional&#x27;)
``:code

where doctype can be &#x27;strict&#x27;, &#x27;transitional&#x27;, &#x27;frameset&#x27;, &#x27;html5&#x27;, or a full doctype string.

##### ``XHTML``
``XHTML``:inxx

XHTML is similar to HTML but it creates an XHTML doctype instead.
``
XHTML(..., lang=&#x27;en&#x27;, doctype=&#x27;transitional&#x27;, xmlns=&#x27;http://www.w3.org/1999/xhtml&#x27;)
``:code

where doctype can be &#x27;strict&#x27;, &#x27;transitional&#x27;, &#x27;frameset&#x27;, or a full doctype string.

##### ``HR``
``HR``:inxx

This helper creates a horizontal line in an HTML page
``
&gt;&gt;&gt; print HR()
&lt;hr /&gt;
``:code

##### ``I``
``I``:inxx

This helper makes its contents italic.
``
&gt;&gt;&gt; print I(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;), _class=&#x27;test&#x27;, _id=0)
&lt;i id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/i&gt;
``:code

##### ``INPUT``
``INPUT``:inxx

Creates an ``&lt;input.../&gt;`` tag. An input tag may not contain other tags, and is closed by ``/&gt;`` instead of ``&gt;``. The input tag has an optional attribute ``_type`` that can be set to &quot;text&quot; (the default), &quot;submit&quot;, &quot;checkbox&quot;, or &quot;radio&quot;.
``
&gt;&gt;&gt; print INPUT(_name=&#x27;test&#x27;, _value=&#x27;a&#x27;)
&lt;input value=&quot;a&quot; name=&quot;test&quot; /&gt;
``:code

It also takes an optional special argument called &quot;value&quot;, distinct from &quot;_value&quot;. The latter sets the default value for the input field; the former sets its current value. For an input of type &quot;text&quot;, the former overrides the latter:
``
&gt;&gt;&gt; print INPUT(_name=&#x27;test&#x27;, _value=&#x27;a&#x27;, value=&#x27;b&#x27;)
&lt;input value=&quot;b&quot; name=&quot;test&quot; /&gt;
``:code

For radio buttons, ``INPUT`` selectively sets the &quot;checked&quot; attribute:

``radio``:inxx
``
&gt;&gt;&gt; for v in [&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;]:
&gt;&gt;&gt;     print INPUT(_type=&#x27;radio&#x27;, _name=&#x27;test&#x27;, _value=v, value=&#x27;b&#x27;), v
&lt;input value=&quot;a&quot; type=&quot;radio&quot; name=&quot;test&quot; /&gt; a
&lt;input value=&quot;b&quot; type=&quot;radio&quot; checked=&quot;checked&quot; name=&quot;test&quot; /&gt; b
&lt;input value=&quot;c&quot; type=&quot;radio&quot; name=&quot;test&quot; /&gt; c
``:code

and similarly for checkboxes:

``checkbox``:inxx
``
&gt;&gt;&gt; print INPUT(_type=&#x27;checkbox&#x27;, _name=&#x27;test&#x27;, _value=&#x27;a&#x27;, value=True)
&lt;input value=&quot;a&quot; type=&quot;checkbox&quot; checked=&quot;checked&quot; name=&quot;test&quot; /&gt;
&gt;&gt;&gt; print INPUT(_type=&#x27;checkbox&#x27;, _name=&#x27;test&#x27;, _value=&#x27;a&#x27;, value=False)
&lt;input value=&quot;a&quot; type=&quot;checkbox&quot; name=&quot;test&quot; /&gt;
``:code

##### ``IFRAME``

This helper includes another web page in the current page. The url of the other page is specified via the &quot;_src&quot; attribute.

``IFRAME``:inxx
``
&gt;&gt;&gt; print IFRAME(_src=&#x27;http://www.web2py.com&#x27;)
&lt;iframe src=&quot;http://www.web2py.com&quot;&gt;&lt;/iframe&gt;
``:code

##### ``IMG``
``IMG``:inxx

It can be used to embed images into HTML:

``
&gt;&gt;&gt; IMG(_src=&#x27;http://example.com/image.png&#x27;,_alt=&#x27;test&#x27;)
&lt;img src=&quot;http://example.com/image.ong&quot; alt=&quot;rest&quot; /&gt;
``:code

Here is a combination of A, IMG, and URL helpers for including a static image with a link:

``
&gt;&gt;&gt; A(IMG(_src=URL(&#x27;static&#x27;,&#x27;logo.png&#x27;), _alt=&quot;My Logo&quot;),
      _href=URL(&#x27;default&#x27;,&#x27;index&#x27;))
&lt;a href=&quot;/myapp/default/index&quot;&gt;
  &lt;img src=&quot;/myapp/static/logo.png&quot; alt=&quot;My Logo&quot; /&gt;
&lt;/a&gt;
``:code

##### ``LABEL``

It is used to create a LABEL tag for an INPUT field.

``LABEL``:inxx
``
&gt;&gt;&gt; print LABEL(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;), _class=&#x27;test&#x27;, _id=0)
&lt;label id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/label&gt;
``:code

##### ``LEGEND``

It is used to create a legend tag for a field in a form.

``LEGEND``:inxx
``
&gt;&gt;&gt; print LEGEND(&#x27;Name&#x27;, _for=&#x27;myfield&#x27;)
&lt;legend for=&quot;myfield&quot;&gt;Name&lt;/legend&gt;
``:code

##### ``LI``

It makes a list item and should be contained in a ``UL`` or ``OL`` tag.

``LI``:inxx
``
&gt;&gt;&gt; print LI(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;), _class=&#x27;test&#x27;, _id=0)
&lt;li id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/li&gt;
``:code

##### ``META``

To be used for building ``META`` tags in the ``HTML`` head. For example:

``META``:inxx
``
&gt;&gt;&gt; print META(_name=&#x27;security&#x27;, _content=&#x27;high&#x27;)
&lt;meta name=&quot;security&quot; content=&quot;high&quot; /&gt;
``:code

##### ``MARKMIN``

Implements the markmin wiki syntax. It converts the input text into output html according to the markmin rules described in the example below:

``MARKMIN``:inxx
``
&gt;&gt;&gt; print MARKMIN(&quot;this is **bold** or &#x27;&#x27;italic&#x27;&#x27; and this [[a link http://web2py.com]]&quot;)
&lt;p&gt;this is &lt;b&gt;bold&lt;/b&gt; or &lt;i&gt;italic&lt;/i&gt; and
this &lt;a href=&quot;http://web2py.com&quot;&gt;a link&lt;/a&gt;&lt;/p&gt;
``:code

The markmin syntax is described in this file that ships with web2py:
``
http://127.0.0.1:8000/examples/static/markmin.html
``:code

and some examples are shown in chapter 12 in the context of plugin_wiki, which uses MARKMIN extensively.

You can use markmin to generate HTML, LaTeX and PDF documents:

``
m = &quot;Hello **world** [[link http://web2py.com]]&quot;
from gluon.contrib.markmin.markmin2html import markmin2html
print markmin2html(m)
from gluon.contrib.markmin.markmin2latex import markmin2latex
print markmin2latex(m)
from gluon.contrib.markmin.markmin2pdf import markmin2pdf
print markmin2pdf(m) # requires pdflatex
``

(the ``MARKMIN`` helper is a shortcut for ``markmin2html``)

Here is a basic syntax primer:

--------------------------------------------------
**SOURCE**                 | **OUTPUT**
``# title``                | **title**
``## section``             | **section**
``### subsection``         | **subsection**
``**bold**``               | **bold**
``&#x27;&#x27;italic&#x27;&#x27;``             | &#x27;&#x27;italic&#x27;&#x27;
``!`!`verbatim`!`!``       | ``verbatim``
``http://google.com``      | http://google.com
``http://...`` | ``&lt;a href=&quot;http://...&quot;&gt;http:...&lt;/a&gt;``
``http://...png`` | ``&lt;img src=&quot;http://...png&quot; /&gt;``
``http://...mp3`` | ``&lt;audio src=&quot;http://...mp3&quot;&gt;&lt;/audio&gt;``
``http://...mp4`` | ``&lt;video src=&quot;http://...mp4&quot;&gt;&lt;/video&gt;``
``qr:http://...`` | ``&lt;a href=&quot;http://...&quot;&gt;&lt;img src=&quot;qr code&quot;/&gt;&lt;/a&gt;``
``embed:http://...`` | ``&lt;iframe src=&quot;http://...&quot;&gt;&lt;/iframe&gt;``
``[[click me #myanchor]]`` | [[click me #myanchor]]
``$````$\int_a^b sin(x)dx$````$``  | $$\int_a^b sin(x)dx$$
---------------------------------------------------

Simply including a link to an image, a videos or an audio files without markup result in the corresponding image, video or audio file being included automatically (for audio and video it uses html &lt;audio&gt; and &lt;video&gt; tags).

Adding a link with the ``qr:`` prefix such as

``
qr:http://web2py.com
``

results in the corresponding QR code being embedded and linking the said URL.

Adding a link with the ``embed:`` prefix such as

``
embed:http://www.youtube.com/embed/x1w8hKTJ2Co
``

results in the page being embedded, in this case a youtube video is embedded.

Images can also be embedded with the following syntax:

``
[[image-description http://.../image.png right 200px]]
``

Unordered lists with:
``
- one
- two
- three
``

Ordered lists with:
``
+ one
+ two
+ three
``

and tables with:
``
----------
 X | 0 | 0
 0 | X | 0
 0 | 0 | 1
----------
``

The MARKMIN syntax also supports blockquotes, HTML5 audio and video tags, image alignment, custom css, and it can be extended:

``
MARKMIN(&quot;!`!!`!abab!`!!`!:custom&quot;, extra=dict(custom=lambda text: text.replace(&#x27;a&#x27;,&#x27;c&#x27;))
``:code

generates

``&#x27;cbcb&#x27;``:code

Custom blocks are delimited by ``!`!!`!...!`!!`!:&lt;key&gt;`` and they are rendered by the function passed as value for the corresponding key in the extra dictionary argument of MARKMIN. Mind that the function may need to escape the output to prevent XSS.

##### ``OBJECT``

Used to embed objects (for example, a flash player) in the HTML.

``OBJECT``:inxx
``
&gt;&gt;&gt; print OBJECT(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;),
&gt;&gt;&gt;              _src=&#x27;http://www.web2py.com&#x27;)
&lt;object src=&quot;http://www.web2py.com&quot;&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/object&gt;
``:code

##### ``OL``

It stands for Ordered List. The list should contain LI tags. ``OL`` arguments that are not ``LI`` objects are automatically enclosed in ``&lt;li&gt;...&lt;/li&gt;`` tags.

``OL``:inxx
``
&gt;&gt;&gt; print OL(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;), _class=&#x27;test&#x27;, _id=0)
&lt;ol id=&quot;0&quot; class=&quot;test&quot;&gt;&lt;li&gt;&amp;lt;hello&amp;gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;world&lt;/b&gt;&lt;/li&gt;&lt;/ol&gt;
``:code

##### ``ON``

This is here for backward compatibility and it is simply an alias for ``True``. It is used exclusively for checkboxes and deprecated since ``True`` is more Pythonic.

``ON``:inxx
``
&gt;&gt;&gt; print INPUT(_type=&#x27;checkbox&#x27;, _name=&#x27;test&#x27;, _checked=ON)
&lt;input checked=&quot;checked&quot; type=&quot;checkbox&quot; name=&quot;test&quot; /&gt;
``:code

##### ``OPTGROUP``

Allows you to group multiple options in a SELECT and it is useful to customize the fields using CSS.

``OPTGROUP``:inxx
``
&gt;&gt;&gt; print SELECT(&#x27;a&#x27;, OPTGROUP(&#x27;b&#x27;, &#x27;c&#x27;))
&lt;select&gt;
  &lt;option value=&quot;a&quot;&gt;a&lt;/option&gt;
  &lt;optgroup&gt;
    &lt;option value=&quot;b&quot;&gt;b&lt;/option&gt;
    &lt;option value=&quot;c&quot;&gt;c&lt;/option&gt;
  &lt;/optgroup&gt;
&lt;/select&gt;
``:code

##### ``OPTION``

This should only be used as part of a SELECT/OPTION combination.

``OPTION``:inxx
``
&gt;&gt;&gt; print OPTION(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;), _value=&#x27;a&#x27;)
&lt;option value=&quot;a&quot;&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/option&gt;
``:code

As in the case of ``INPUT``, web2py make a distinction between &quot;_value&quot; (the value of the OPTION), and &quot;value&quot; (the current value of the enclosing select). If they are equal, the option is &quot;selected&quot;.

``selected``:inxx
``
&gt;&gt;&gt; print SELECT(&#x27;a&#x27;, &#x27;b&#x27;, value=&#x27;b&#x27;):
&lt;select&gt;
&lt;option value=&quot;a&quot;&gt;a&lt;/option&gt;
&lt;option value=&quot;b&quot; selected=&quot;selected&quot;&gt;b&lt;/option&gt;
&lt;/select&gt;
``:code

##### ``P``
``P``:inxx

This is for tagging a paragraph.
``
&gt;&gt;&gt; print P(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;), _class=&#x27;test&#x27;, _id=0)
&lt;p id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/p&gt;
``:code

##### ``PRE``
``PRE``:inxx

Generates a ``&lt;pre&gt;...&lt;/pre&gt;`` tag for displaying pre-formatted text. The ``CODE`` helper is generally preferable for code listings.
``
&gt;&gt;&gt; print PRE(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;), _class=&#x27;test&#x27;, _id=0)
&lt;pre id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/pre&gt;
``:code

##### ``SCRIPT``
``SCRIPT``:inxx

This is include or link a script, such as JavaScript. The content between the tags is rendered as an HTML comment, for the benefit of really old browsers.
``
&gt;&gt;&gt; print SCRIPT(&#x27;alert(&quot;hello world&quot;);&#x27;, _type=&#x27;text/javascript&#x27;)
&lt;script type=&quot;text/javascript&quot;&gt;&lt;!--
alert(&quot;hello world&quot;);
//--&gt;&lt;/script&gt;
``:code

##### ``SELECT``
``SELECT``:inxx

Makes a ``&lt;select&gt;...&lt;/select&gt;`` tag. This is used with the ``OPTION`` helper. Those ``SELECT`` arguments that are not ``OPTION`` objects are automatically converted to options.
``
&gt;&gt;&gt; print SELECT(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;), _class=&#x27;test&#x27;, _id=0)
&lt;select id=&quot;0&quot; class=&quot;test&quot;&gt;
   &lt;option value=&quot;&amp;lt;hello&amp;gt;&quot;&gt;&amp;lt;hello&amp;gt;&lt;/option&gt;
   &lt;option value=&quot;&amp;lt;b&amp;gt;world&amp;lt;/b&amp;gt;&quot;&gt;&lt;b&gt;world&lt;/b&gt;&lt;/option&gt;
&lt;/select&gt;
``:code

##### ``SPAN``
``SPAN``:inxx

Similar to ``DIV`` but used to tag inline (rather than block) content.
``
&gt;&gt;&gt; print SPAN(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;), _class=&#x27;test&#x27;, _id=0)
&lt;span id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/span&gt;
``:code

##### ``STYLE``
``STYLE``:inxx

Similar to script, but used to either include or link CSS code.
Here the CSS is included:
``
&gt;&gt;&gt; print STYLE(XML(&#x27;body {color: white}&#x27;))
&lt;style&gt;&lt;!--
body { color: white }
//--&gt;&lt;/style&gt;
``:code

and here it is linked:
``
&gt;&gt;&gt; print STYLE(_src=&#x27;style.css&#x27;)
&lt;style src=&quot;style.css&quot;&gt;&lt;!--
//--&gt;&lt;/style&gt;
``:code

##### ``TABLE``, ``TR``, ``TD``
``TABLE``:inxx ``TR``:inxx ``TD``:inxx

These tags (along with the optional ``THEAD``, ``TBODY`` and ``TFOOTER`` helpers) are used to build HTML tables.
``
&gt;&gt;&gt; print TABLE(TR(TD(&#x27;a&#x27;), TD(&#x27;b&#x27;)), TR(TD(&#x27;c&#x27;), TD(&#x27;d&#x27;)))
&lt;table&gt;&lt;tr&gt;&lt;td&gt;a&lt;/td&gt;&lt;td&gt;b&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;c&lt;/td&gt;&lt;td&gt;d&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
``:code
``TR`` expects ``TD`` content; arguments that are not ``TD`` objects are converted automatically.
``
&gt;&gt;&gt; print TABLE(TR(&#x27;a&#x27;, &#x27;b&#x27;), TR(&#x27;c&#x27;, &#x27;d&#x27;))
&lt;table&gt;&lt;tr&gt;&lt;td&gt;a&lt;/td&gt;&lt;td&gt;b&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;c&lt;/td&gt;&lt;td&gt;d&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
``:code

It is easy to convert a Python array into an HTML table using Python&#x27;s ``*`` function arguments notation, which maps list elements to positional function arguments.

Here, we will do it line by line:
``
&gt;&gt;&gt; table = [[&#x27;a&#x27;, &#x27;b&#x27;], [&#x27;c&#x27;, &#x27;d&#x27;]]
&gt;&gt;&gt; print TABLE(TR(*table[0]), TR(*table[1]))
&lt;table&gt;&lt;tr&gt;&lt;td&gt;a&lt;/td&gt;&lt;td&gt;b&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;c&lt;/td&gt;&lt;td&gt;d&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
``:code

Here we do all lines at once:
``
&gt;&gt;&gt; table = [[&#x27;a&#x27;, &#x27;b&#x27;], [&#x27;c&#x27;, &#x27;d&#x27;]]
&gt;&gt;&gt; print TABLE(*[TR(*rows) for rows in table])
&lt;table&gt;&lt;tr&gt;&lt;td&gt;a&lt;/td&gt;&lt;td&gt;b&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;c&lt;/td&gt;&lt;td&gt;d&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
``:code

##### ``TBODY``
``TBODY``:inxx

This is used to tag rows contained in the table body, as opposed to header or footer rows. It is optional.
``
&gt;&gt;&gt; print TBODY(TR(&#x27;&lt;hello&gt;&#x27;), _class=&#x27;test&#x27;, _id=0)
&lt;tbody id=&quot;0&quot; class=&quot;test&quot;&gt;&lt;tr&gt;&lt;td&gt;&amp;lt;hello&amp;gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;
``:code

##### ``TEXTAREA``
``TEXTAREA``:inxx

This helper makes a ``&lt;textarea&gt;...&lt;/textarea&gt;`` tag.
``
&gt;&gt;&gt; print TEXTAREA(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;), _class=&#x27;test&#x27;)
&lt;textarea class=&quot;test&quot; cols=&quot;40&quot; rows=&quot;10&quot;&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/textarea&gt;
``:code

The only caveat is that its optional &quot;value&quot; overrides its content (inner HTML)
``
&gt;&gt;&gt; print TEXTAREA(value=&quot;&lt;hello world&gt;&quot;, _class=&quot;test&quot;)
&lt;textarea class=&quot;test&quot; cols=&quot;40&quot; rows=&quot;10&quot;&gt;&amp;lt;hello world&amp;gt;&lt;/textarea&gt;
``:code

##### ``TFOOT``
``TFOOT``:inxx

This is used to tag table footer rows.
``
&gt;&gt;&gt; print TFOOT(TR(TD(&#x27;&lt;hello&gt;&#x27;)), _class=&#x27;test&#x27;, _id=0)
&lt;tfoot id=&quot;0&quot; class=&quot;test&quot;&gt;&lt;tr&gt;&lt;td&gt;&amp;lt;hello&amp;gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tfoot&gt;
``:code

##### ``TH``
``TH``:inxx

This is used instead of ``TD`` in table headers.
``
&gt;&gt;&gt; print TH(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;), _class=&#x27;test&#x27;, _id=0)
&lt;th id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/th&gt;
``:code

##### ``THEAD``
``THEAD``:inxx

This is used to tag table header rows.
``
&gt;&gt;&gt; print THEAD(TR(TH(&#x27;&lt;hello&gt;&#x27;)), _class=&#x27;test&#x27;, _id=0)
&lt;thead id=&quot;0&quot; class=&quot;test&quot;&gt;&lt;tr&gt;&lt;th&gt;&amp;lt;hello&amp;gt;&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;
``:code

##### ``TITLE``
``TITLE``:inxx

This is used to tag the title of a page in an HTML header.
``
&gt;&gt;&gt; print TITLE(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;))
&lt;title&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/title&gt;
``:code

##### ``TR``
``TR``:inxx

Tags a table row. It should be rendered inside a table and contain ``&lt;td&gt;...&lt;/td&gt;`` tags. ``TR`` arguments that are not ``TD`` objects will be automatically converted.
``
&gt;&gt;&gt; print TR(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;), _class=&#x27;test&#x27;, _id=0)
&lt;tr id=&quot;0&quot; class=&quot;test&quot;&gt;&lt;td&gt;&amp;lt;hello&amp;gt;&lt;/td&gt;&lt;td&gt;&lt;b&gt;world&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;
``:code

##### ``TT``
``TT``:inxx

Tags text as typewriter (monospaced) text.
``
&gt;&gt;&gt; print TT(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;), _class=&#x27;test&#x27;, _id=0)
&lt;tt id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/tt&gt;
``:code

##### ``UL``

Signifies an Unordered List and should contain LI items. If its content is not tagged as LI, UL does it automatically.

``UL``:inxx
``
&gt;&gt;&gt; print UL(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;), _class=&#x27;test&#x27;, _id=0)
&lt;ul id=&quot;0&quot; class=&quot;test&quot;&gt;&lt;li&gt;&amp;lt;hello&amp;gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;world&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;
``:code

##### ``embed64``

``embed64(filename=None, file=None, data=None, extension=&#x27;image/gif&#x27;)`` encodes the provided (binary) data into base64.

filename: if provided, opens and reads this file in &#x27;rb&#x27; mode.
file: if provided, reads this file.
data: if provided, uses the provided data.

``embed64``:inxx

##### ``xmlescape``

``xmlescape(data, quote=True)`` returns an escaped string of the provided data.

``xmlescape``:inxx
``
&gt;&gt;&gt; print xmlescape(&#x27;&lt;hello&gt;&#x27;)
&amp;lt;hello&amp;gt;
``:code

#### Custom helpers

##### ``TAG``
``TAG``:inxx

Sometimes you need to generate custom XML tags. web2py provides ``TAG``, a universal tag generator.
``
{{=TAG.name(&#x27;a&#x27;, &#x27;b&#x27;, _c=&#x27;d&#x27;)}}
``:code

generates the following XML
``
&lt;name c=&quot;d&quot;&gt;ab&lt;/name&gt;
``:code

Arguments &quot;a&quot;, &quot;b&quot;, and &quot;d&quot; are automatically escaped; use the ``XML`` helper to suppress this behavior. Using ``TAG`` you can generate HTML/XML tags not already provided by the API. TAGs can be nested, and are serialized with ``str().``
An equivalent syntax is:
``
{{=TAG[&#x27;name&#x27;](&#x27;a&#x27;, &#x27;b&#x27;, c=&#x27;d&#x27;)}}
``:code

If the TAG object is created with an empty name, it can be used to concatenate multiple strings and HTML helpers together without inserting them into a surrounding tag, but this use is deprecated. Use the ``CAT`` helper instead.

Notice that ``TAG`` is an object, and ``TAG.name`` or ``TAG[&#x27;name&#x27;]`` is a function that returns a temporary helper class.

##### ``MENU``
``MENU``:inxx

The MENU helper takes a list of lists or of tuples of the form of ``response.menu`` (as described in Chapter 4) and generates a tree-like structure using unordered lists representing the menu. For example:
``
&gt;&gt;&gt; print MENU([[&#x27;One&#x27;, False, &#x27;link1&#x27;], [&#x27;Two&#x27;, False, &#x27;link2&#x27;]])
&lt;ul class=&quot;web2py-menu web2py-menu-vertical&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;link1&quot;&gt;One&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;link2&quot;&gt;Two&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
``:code

Each menu item can have a fourth argument that is a nested submenu (and so on recursively):
``
&gt;&gt;&gt; print MENU([[&#x27;One&#x27;, False, &#x27;link1&#x27;, [[&#x27;Two&#x27;, False, &#x27;link2&#x27;]]]])
&lt;ul class=&quot;web2py-menu web2py-menu-vertical&quot;&gt;
  &lt;li class=&quot;web2py-menu-expand&quot;&gt;
     &lt;a href=&quot;link1&quot;&gt;One&lt;/a&gt;
     &lt;ul class=&quot;web2py-menu-vertical&quot;&gt;
        &lt;li&gt;&lt;a href=&quot;link2&quot;&gt;Two&lt;/a&gt;&lt;/li&gt;
     &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;
``:code

A menu item can also have an optional 5th element, which is a boolean. When false, the menu item is ignored by the MENU helper.

The MENU helper takes the following optional arguments:
- ``_class``: defaults to &quot;web2py-menu web2py-menu-vertical&quot; and sets the class of the outer UL elements.
- ``ul_class``: defaults to &quot;web2py-menu-vertical&quot; and sets the class of the inner UL elements.
- ``li_class``: defaults to &quot;web2py-menu-expand&quot; and sets the class of the inner LI elements.

``mobile``:inxx

``MENU`` takes an optional argument ``mobile``. When set to ``True`` instead of building a recursive ``UL`` menu structure it returns a ``SELECT`` dropdown with all the menu options and a ``onchange`` attribute that redirects to the page corresponding to the selected option. This is designed an an alternative menu representation that increases usability on small mobile devices such as phones.

Normally the menu is used in a layout with the following syntax:

``
{{=MENU(response.menu, mobile=request.user_agent().is_mobile)}}
``

In this way a mobile device is automatically detected and the menu is rendered accordingly.

### ``BEAUTIFY``
``BEAUTIFY`` is used to build HTML representations of compound objects, including lists, tuples and dictionaries:
``
{{=BEAUTIFY({&quot;a&quot;: [&quot;hello&quot;, XML(&quot;world&quot;)], &quot;b&quot;: (1, 2)})}}
``:code
``BEAUTIFY`` returns an XML-like object serializable to XML, with a nice looking representation of its constructor argument. In this case, the XML representation of:
``
{&quot;a&quot;: [&quot;hello&quot;, XML(&quot;world&quot;)], &quot;b&quot;: (1, 2)}
``:code

will render as:
``
&lt;table&gt;
&lt;tr&gt;&lt;td&gt;a&lt;/td&gt;&lt;td&gt;:&lt;/td&gt;&lt;td&gt;hello&lt;br /&gt;world&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;b&lt;/td&gt;&lt;td&gt;:&lt;/td&gt;&lt;td&gt;1&lt;br /&gt;2&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;
``:code

### Server-side &#x27;&#x27;DOM&#x27;&#x27; and parsing
``element``:inxx ``elements``:inxx

#### ``elements``

The DIV helper and all derived helpers provide the search methods ``element`` and ``elements``.

``element`` returns the first child element matching a specified condition (or None if no match).

``elements`` returns a list of all matching children.

**element** and **elements** use the same syntax to specify the matching condition, which allows for three possibilities that can be mixed and matched: jQuery-like expressions, match by exact attribute value, match using regular expressions.

Here is a simple example:
``
&gt;&gt;&gt; a = DIV(DIV(DIV(&#x27;a&#x27;, _id=&#x27;target&#x27;,_class=&#x27;abc&#x27;)))
&gt;&gt;&gt; d = a.elements(&#x27;div#target&#x27;)
&gt;&gt;&gt; d[0][0] = &#x27;changed&#x27;
&gt;&gt;&gt; print a
&lt;div&gt;&lt;div&gt;&lt;div id=&quot;target&quot; class=&quot;abc&quot;&gt;changed&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;
``:code

The un-named argument of ``elements`` is a string, which may contain: the name of a tag, the id of a tag preceded by a pound symbol, the class preceded by a dot, the explicit value of an attribute in square brackets.

Here are 4 equivalent ways to search the previous tag by id:
``
&gt;&gt;&gt; d = a.elements(&#x27;#target&#x27;)
&gt;&gt;&gt; d = a.elements(&#x27;div#target&#x27;)
&gt;&gt;&gt; d = a.elements(&#x27;div[id=target]&#x27;)
&gt;&gt;&gt; d = a.elements(&#x27;div&#x27;,_id=&#x27;target&#x27;)
``:code

Here are 4 equivalent ways to search the previous tag by class:
``
&gt;&gt;&gt; d = a.elements(&#x27;.abc&#x27;)
&gt;&gt;&gt; d = a.elements(&#x27;div.abc&#x27;)
&gt;&gt;&gt; d = a.elements(&#x27;div[class=abc]&#x27;)
&gt;&gt;&gt; d = a.elements(&#x27;div&#x27;,_class=&#x27;abc&#x27;)
``:code

Any attribute can be used to locate an element (not just ``id`` and ``class``), including multiple attributes (the function element can take multiple named arguments), but only the first matching element will be returned.

Using the jQuery syntax &quot;div#target&quot; it is possible to specify multiple search criteria separated by a space:
``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;a&#x27;, _id=&#x27;t1&#x27;), DIV(&#x27;b&#x27;, _class=&#x27;c2&#x27;))
&gt;&gt;&gt; d = a.elements(&#x27;span#t1, div.c2&#x27;)
``:code

or equivalently
``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;a&#x27;, _id=&#x27;t1&#x27;), DIV(&#x27;b&#x27;, _class=&#x27;c2&#x27;))
&gt;&gt;&gt; d = a.elements(&#x27;span#t1&#x27;, &#x27;div.c2&#x27;)
``:code

If the value of an attribute is specified using a name argument, it can be a string or a regular expression:
``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;a&#x27;, _id=&#x27;test123&#x27;), DIV(&#x27;b&#x27;, _class=&#x27;c2&#x27;))
&gt;&gt;&gt; d = a.elements(&#x27;span&#x27;, _id=re.compile(&#x27;test\d{3}&#x27;)
``:code

A special named argument of the DIV (and derived) helpers is ``find``. It can be used to specify a search value or a search regular expression in the text content of the tag. For example:
``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;abcde&#x27;), DIV(&#x27;fghij&#x27;))
&gt;&gt;&gt; d = a.elements(find=&#x27;bcd&#x27;)
&gt;&gt;&gt; print d[0]
&lt;span&gt;abcde&lt;/span&gt;
``:code

or
``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;abcde&#x27;), DIV(&#x27;fghij&#x27;))
&gt;&gt;&gt; d = a.elements(find=re.compile(&#x27;fg\w{3}&#x27;))
&gt;&gt;&gt; print d[0]
&lt;div&gt;fghij&lt;/div&gt;
``:code

#### ``components``
Here&#x27;s an example of listing all elements in an html string:
``
html = TAG(&#x27;&lt;a&gt;xxx&lt;/a&gt;&lt;b&gt;yyy&lt;/b&gt;&#x27;)
for item in html.components: print item
``:code

#### ``parent``
``parent`` returns the parent of the current element.
``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;a&#x27;),DIV(&#x27;b&#x27;))
&gt;&gt;&gt; d = a.element(&#x27;a&#x27;).parent()
&gt;&gt;&gt; d[&#x27;_class&#x27;]=&#x27;abc&#x27;
&gt;&gt;&gt; print a
&lt;div class=&quot;abc&quot;&gt;&lt;span&gt;a&lt;/span&gt;&lt;div&gt;b&lt;/div&gt;&lt;/div&gt;
``:code

#### ``flatten``

The flatten method recursively serializes the content of the children of a given element into regular text (without tags):
``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;this&#x27;, DIV(&#x27;is&#x27;, B(&#x27;a&#x27;))), SPAN(&#x27;test&#x27;))
&gt;&gt;&gt; print a.flatten()
thisisatest
``:code

Flatten can be passed an optional argument, ``render``, i.e. a function that renders/flattens the content using a different protocol. Here is an example to serialize some tags into Markmin wiki syntax:
``
&gt;&gt;&gt; a = DIV(H1(&#x27;title&#x27;), P(&#x27;example of a &#x27;, A(&#x27;link&#x27;, _href=&#x27;#test&#x27;)))
&gt;&gt;&gt; from gluon.html import markmin_serializer
&gt;&gt;&gt; print a.flatten(render=markmin_serializer)
## titles

example of [[a link #test]]
``:code

At the time of writing we provide ``markmin_serializer`` and ``markdown_serializer``.

#### Parsing

The TAG object is also an XML/HTML parser. It can read text and convert into a tree structure of helpers. This allows manipulation using the API above:
``
&gt;&gt;&gt; html = &#x27;&lt;h1&gt;Title&lt;/h1&gt;&lt;p&gt;this is a &lt;span&gt;test&lt;/span&gt;&lt;/p&gt;&#x27;
&gt;&gt;&gt; parsed_html = TAG(html)
&gt;&gt;&gt; parsed_html.element(&#x27;span&#x27;)[0]=&#x27;TEST&#x27;
&gt;&gt;&gt; print parsed_html
&lt;h1&gt;Title&lt;/h1&gt;&lt;p&gt;this is a &lt;span&gt;TEST&lt;/span&gt;&lt;/p&gt;
``:code

### Page layout
``page layout``:inxx ``layout.html``:inxx ``extent``:inxx ``include``:inxx

Views can extend and include other views in a tree-like structure.

For example, we can think of a view &quot;index.html&quot; that extends &quot;layout.html&quot; and includes &quot;body.html&quot;.
At the same time,  &quot;layout.html&quot; may include &quot;header.html&quot; and &quot;footer.html&quot;.

The root of the tree is what we call a layout view.  Just like any other HTML template file, you can edit it using the web2py administrative interface. The file name &quot;layout.html&quot; is just a convention.

Here is a minimalist page that extends the &quot;layout.html&quot; view and includes the &quot;page.html&quot; view:

``
{{extend &#x27;layout.html&#x27;}}
&lt;h1&gt;Hello World&lt;/h1&gt;
{{include &#x27;page.html&#x27;}}
``:code

The extended layout file must contain an ``{{include}}`` directive, something like:
``
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;Page Title&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    {{include}}
  &lt;/body&gt;
&lt;/html&gt;
``:code

When the view is called, the extended (layout) view is loaded, and the calling view replaces the ``{{include}}`` directive inside the layout. Processing continues recursively until all ``extend`` and ``include`` directives have been processed. The resulting template is then translated into Python code. Note, when an application is bytecode compiled, it is this Python code that is compiled, not the original view files themselves. So, the bytecode compiled version of a given view is a single .pyc file that includes the Python code not just for the original view file, but for its entire tree of extended and included views.

-------
``extend``, ``include``, ``block`` and ``super`` are special template directives,
not Python commands.
-------

Any content or code that precedes the ``{{extend ...}}`` directive will be inserted (and therefore executed) before the beginning of the extended view&#x27;s content/code. Although this is not typically used to insert actual HTML content before the extended view&#x27;s content, it can be useful as a means to define variables or functions that you want to make available to the extended view. For example, consider a view &quot;index.html&quot;:
``
{{sidebar_enabled=True}}
{{extend &#x27;layout.html&#x27;}}
&lt;h1&gt;Home Page&lt;/h1&gt;
``:code

and an excerpt from &quot;layout.html&quot;:
``
{{if sidebar_enabled:}}
    &lt;div id=&quot;sidebar&quot;&gt;
        Sidebar Content
    &lt;/div&gt;
{{pass}}
``:code

Because the ``sidebar_enabled`` assignment in &quot;index.html&quot; comes before the ``extend``, that line gets inserted before the beginning of &quot;layout.html&quot;, making ``sidebar_enabled`` available anywhere within the &quot;layout.html&quot; code (a somewhat more sophisticated version of this is used in the **welcome** app).

It is also worth pointing out that the variables returned by the controller function are available not only in the function&#x27;s main view, but in all of its extended and included views as well.

The argument of an ``extend`` or ``include`` (i.e., the extended or included view name) can be a python variable (though not a python expression). However, this imposes a limitation -- views that use variables in ``extend`` or ``include`` statements cannot be bytecode compiled. As noted above, bytecode-compiled views include the entire tree of extended and included views, so the specific extended and included views must be known at compile time, which is not possible if the view names are variables (whose values are not determined until run time). Because bytecode compiling views can provide a significant speed boost, using variables in ``extend`` and ``include`` should generally be avoided if possible.

In some cases, an alternative to using a variable in an ``include`` is simply to place regular ``{{include ...}}`` directives inside an ``if...else`` block.

``
{{if some_condition:}}
{{include &#x27;this_view.html&#x27;}}
{{else:}}
{{include &#x27;that_view.html&#x27;}}
{{pass}}
``:code

The above code does not present any problem for bytecode compilation because no variables are involved. Note, however, that the bytecode compiled view will actually include the Python code for both &quot;this_view.html&quot; and &quot;that_view.html&quot;, though only the code for one of those views will be executed, depending on the value of ``some_condition``.

Keep in mind, this only works for ``include`` -- you cannot place ``{{extend ...}}`` directives inside ``if...else`` blocks.

``response.menu``:inxx ``menu``:inxx ``response.meta``:inxx ``meta``:inxx

Layouts are used to encapsulate page commonality (headers, footers, menus), and though they are not mandatory, they will make your application easier to write and maintain.  In particular, we suggest writing layouts that take advantage of the following variables that can be set in the controller. Using these well known variables will help make your layouts interchangeable:
``
response.title
response.subtitle
response.meta.author
response.meta.keywords
response.meta.description
response.flash
response.menu
response.files
``:code

Except for ``menu`` and ``files``, these are all strings and their meaning should be obvious.

``response.menu`` menu is a list of 3-tuples or 4-tuples. The three elements are: the link name, a boolean representing whether the link is active (is the current link), and the URL of the linked page. For example:
``
response.menu = [(&#x27;Google&#x27;, False, &#x27;http://www.google.com&#x27;,[]),
                 (&#x27;Index&#x27;,  True,  URL(&#x27;index&#x27;), [])]
``:code

``sub-menu``:inxx
The fourth tuple element is an optional sub-menu.

``response.files`` is a list of CSS and JS files that are needed by your page.

We also recommend that you use:

``
{{include &#x27;web2py_ajax.html&#x27;}}
``:code

in the HTML head, since this will include the jQuery libraries and define some backward-compatible JavaScript functions for special effects and Ajax. &quot;web2py_ajax.html&quot; includes the ``response.meta`` tags in the view, jQuery base, the calendar datepicker, and all required CSS and JS ``response.files``.

#### Default page layout
``superfish``:inxx ``ez.css``:inxx

Below is the &quot;views/layout.html&quot; that ships with the web2py scaffolding application **welcome** (stripped down of some optional parts). Any new application will have a similar default layout:

``
&lt;!DOCTYPE html&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot; /&gt;
  &lt;title&gt;{{=response.title or request.application}}&lt;/title&gt;

  &lt;!-- http://dev.w3.org/html5/markup/meta.name.html --&gt;
  &lt;meta name=&quot;application-name&quot; content=&quot;{{=request.application}}&quot; /&gt;

  &lt;script src=&quot;{{=URL(&#x27;static&#x27;,&#x27;js/modernizr.custom.js&#x27;)}}&quot;&gt;&lt;/script&gt;

  &lt;!-- include stylesheets --&gt;
  {{
  response.files.append(URL(&#x27;static&#x27;,&#x27;css/skeleton.css&#x27;))
  response.files.append(URL(&#x27;static&#x27;,&#x27;css/web2py.css&#x27;))
  response.files.append(URL(&#x27;static&#x27;,&#x27;css/superfish.css&#x27;))
  response.files.append(URL(&#x27;static&#x27;,&#x27;js/superfish.js&#x27;))
  }}

  {{include &#x27;web2py_ajax.html&#x27;}}

  &lt;script type=&quot;text/javascript&quot;&gt;
    jQuery(function(){ jQuery(&#x27;ul.sf-menu&#x27;).supersubs({minWidth:12,maxWidth:30,extraWidth:3}).superfish(); });
  &lt;/script&gt;

  {{
  # using sidebars need to know what sidebar you want to use
  left_sidebar_enabled = globals().get(&#x27;left_sidebar_enabled&#x27;,False)
  right_sidebar_enabled = globals().get(&#x27;right_sidebar_enabled&#x27;,False)
  middle_columns = {0:&#x27;sixteen&#x27;,1:&#x27;twelve&#x27;,2:&#x27;eight&#x27;}[
     (left_sidebar_enabled and 1 or 0)+(right_sidebar_enabled and 1 or 0)]
  }}

&lt;/head&gt;
&lt;body&gt;
  &lt;div class=&quot;wrapper&quot;&gt;&lt;!-- for sticky footer --&gt;

    &lt;div class=&quot;topbar&quot;&gt;
      &lt;div class=&quot;container&quot;&gt;
        &lt;div class=&quot;sixteen columns&quot;&gt;
          &lt;div id=&quot;navbar&quot;&gt;
            {{=&#x27;auth&#x27; in globals() and auth.navbar(separators=(&#x27; &#x27;,&#x27; | &#x27;,&#x27;&#x27;))}}
          &lt;/div&gt;
          &lt;div id=&quot;menu&quot;&gt;
            {{=MENU(response.menu,
                    _class=&#x27;mobile-menu&#x27; if is_mobile else &#x27;sf-menu&#x27;,
                    mobile=request.user_agent().is_mobile)}}
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;&lt;!-- topbar --&gt;

    &lt;div class=&quot;flash&quot;&gt;{{=response.flash or &#x27;&#x27;}}&lt;/div&gt;

    &lt;div class=&quot;header&quot;&gt;
      &lt;div class=&quot;container&quot;&gt;
        &lt;div class=&quot;sixteen columns&quot;&gt;
          &lt;h1 class=&quot;remove-bottom&quot; style=&quot;margin-top: .5em;&quot;&gt;
          {{=response.title or request.application}}
          &lt;/h1&gt;
          &lt;h5&gt;{{=response.subtitle or &#x27;&#x27;}}&lt;/h5&gt;
        &lt;/div&gt;

        &lt;div class=&quot;sixteen columns&quot;&gt;
          &lt;div class=&quot;statusbar&quot;&gt;
            {{block statusbar}}
            &lt;span class=&quot;breadcrumbs&quot;&gt;{{=request.function}}&lt;/span&gt;
            {{end}}
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;

    &lt;div class=&quot;main&quot;&gt;
      &lt;div class=&quot;container&quot;&gt;
        {{if left_sidebar_enabled:}}
        &lt;div class=&quot;four columns left-sidebar&quot;&gt;
          {{block left_sidebar}}
          &lt;h3&gt;Left Sidebar&lt;/h3&gt;
          &lt;p&gt;&lt;/p&gt;
          {{end}}
        &lt;/div&gt;
        {{pass}}

        &lt;div class=&quot;{{=middle_columns}} columns center&quot;&gt;
          {{block center}}
          {{include}}
          {{end}}
        &lt;/div&gt;

        {{if right_sidebar_enabled:}}
        &lt;div class=&quot;four columns&quot;&gt;
          {{block right_sidebar}}
          &lt;h3&gt;Right Sidebar&lt;/h3&gt;
          &lt;p&gt;&lt;/p&gt;
          {{end}}
        &lt;/div&gt;
        {{pass}}

      &lt;/div&gt;&lt;!-- container --&gt;
    &lt;/div&gt;&lt;!-- main --&gt;

    &lt;div class=&quot;push&quot;&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;!-- wrapper --&gt;

  &lt;div class=&quot;footer&quot;&gt;
    &lt;div class=&quot;container header&quot;&gt;
      &lt;div class=&quot;sixteen columns&quot;&gt;
        {{block footer}} &lt;!-- this is default footer --&gt;
        &lt;div class=&quot;footer-content&quot; &gt;
          {{=T(&#x27;Copyright&#x27;)}} &amp;#169; 2011
          &lt;div style=&quot;float: right;&quot;&gt;
            &lt;a href=&quot;http://www.web2py.com/&quot;&gt;
            &lt;img style=&quot;padding-bottom: 0;&quot;
                 src=&quot;{{=URL(&#x27;static&#x27;,&#x27;images/poweredby.png&#x27;)}}&quot;/&gt;
            &lt;/a&gt;
          &lt;/div&gt;
        &lt;/div&gt;
        {{end}}
      &lt;/div&gt;
    &lt;/div&gt;&lt;!-- container --&gt;
  &lt;/div&gt;&lt;!-- footer --&gt;

&lt;/body&gt;
&lt;/html&gt;

``:code

There are a few features of this default layout that make it very easy to use and customize:

- It is written in HTML5 and uses the &quot;modernizr&quot; ``modernizr``:cite library for backward compatibility. The actual layout include some extra conditional statements required by IE and they are omitted for brevity.
- It displays both ``response.title`` and ``response.subtitle`` which can be set in a model. If they are not set, it adopts the application name as title
- It includes the ``web2py_ajax.html`` file in the header which generated all the link and script import statements.
- It uses a modified version of &quot;skeleton&quot; ``skeleton``:cite a library for flexible layouts which works on mobile devices and re-arranges columns to fit small screens.
- It uses &quot;superfish.js&quot; ``superfish``:cite for dynamic cascading menus. There is an explicit script to activate the superfish cascading menu and it can be removed if not necessary.
- The ``{{=auth.navbar(...)}}`` displays a welcome to the current user and links to auth functions like login, logout, register, change password, etc. depending on context. It is a helper factory and its output can be manipulated as any other helper. It is placed in a ``{{try:}}...{{except:pass}}`` in case auth is undefined.
- The ``{{=MENU(response.menu)`` displays the menu structure as ``&lt;ul&gt;...&lt;/ul&gt;``.
- ``{{include}}`` is replaced by the content of the extending view when the page is rendered.
- By default it uses a conditional three column (the left and right sidebars can be turned off by the extending views)
- It uses the following classes: header, main, footer
- It contains the following blocks: statusbar, left_sidebar, center, right_sidebar, footer.

Views can turn on and fill sidebars as follows:

``
{{left_sidebar_enable=True}}
{{extend &#x27;layout.html&#x27;}}

This text goes in center

{{block left_sidebar}}
This text goes in sidebar
{{end}}
``:code

#### Customizing the default layout

``CSS``:inxx

Customizing the default layout without editing is very easy because the CSS files are documented:

- &quot;bootstrap.min.css&quot; contains the Twitter Boostrap CSS style ``bootstrap``:cite ``Bootstrap``:inxx
- &quot;web2py.css&quot; contains web2py specific styles

To change colors and background images,
try append the following code to layout.html header:

``
&lt;style&gt;
body { background: url(&#x27;images/background.png&#x27;) repeat-x #3A3A3A; }
a { color: #349C01; }
.header h1 { color: #349C01; }
.header h2 { color: white; font-style: italic; font-size: 14px;}
.statusbar { background: #333333; border-bottom: 5px #349C01 solid; }
.statusbar a { color: white; }
.footer { border-top: 5px #349C01 solid; }
&lt;/style&gt;
``:code

Of course you can also completely replace the &quot;layout.html&quot; and &quot;web2py.css&quot; files with your own.

#### Mobile development

The default layout.html is designed to be friendly to mobile devices but that is not enough. One may need to use different views when a page is visited by a mobile device.

To make developing for desktop and mobile devices easier, web2py includes the ``@mobilize`` decorator. This decorator is applied to actions that should have a normal view and a mobile view. This is demonstrated here:

``
from gluon.contrib.user_agent_parser import mobilize
@mobilize
def index():
   return dict()
``

Notice that the decorator must be imported before using it in a controller.
When the &quot;index&quot; function is called from a regular browser (desktop computer), web2py will render the returned dictionary using the view &quot;[controller]/index.html&quot;. However, when it is called by a mobile device, the dictionary will be rendered by &quot;[controller]/index.mobile.html&quot;. Notice that mobile views have the &quot;mobile.html&quot; extension.

Alternatively you can apply the following logic to make all views mobile friendly:

``
if request.user_agent().is_mobile:
    response.view.replace(&#x27;.html&#x27;,&#x27;.mobile.html&#x27;)
``

The task of creating the &quot;*.mobile.html&quot; views is left to the developer but we strongly suggest using the &quot;jQuery Mobile&quot; plugin which makes the task very easy.

### Functions in views

Consider this &quot;layout.html&quot;:

``
&lt;html&gt;
  &lt;body&gt;
    {{include}}
    &lt;div class=&quot;sidebar&quot;&gt;
      {{if &#x27;mysidebar&#x27; in globals():}}{{mysidebar()}}{{else:}}
        my default sidebar
      {{pass}}
    &lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;
``:code

and this extending view

``
{{def mysidebar():}}
my new sidebar!!!
{{return}}
{{extend &#x27;layout.html&#x27;}}
Hello World!!!
``:code

Notice the function is defined before the ``{{extend...}}`` statement -- this results in the function being created before the &quot;layout.html&quot; code is executed, so the function can be called anywhere within &quot;layout.html&quot;, even before the ``{{include}}``. Also notice the function is included in the extended view without the ``=`` prefix.

The code generates the following output:

``
&lt;html&gt;
  &lt;body&gt;
    Hello World!!!
    &lt;div class=&quot;sidebar&quot;&gt;
        my new sidebar!!!
    &lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;
``:code

Notice that the function is defined in HTML (although it could also contain Python code) so that ``response.write`` is used to write its content (the function does not return the content). This is why the layout calls the view function using ``{{mysidebar()}}`` rather than ``{{=mysidebar()}}``. Functions defined in this way can take arguments.

### Blocks in views
``block``:inxx

Another way to make a view more modular is by using ``{{block...}}s`` and this mechanism is an alternative to the mechanism discussed in the previous section.

Consider this &quot;layout.html&quot;:

``
&lt;html&gt;
  &lt;body&gt;
    {{include}}
    &lt;div class=&quot;sidebar&quot;&gt;
      {{block mysidebar}}
        my default sidebar
      {{end}}
    &lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;
``:code

and this extending view

``
{{extend &#x27;layout.html&#x27;}}
Hello World!!!
{{block mysidebar}}
my new sidebar!!!
{{end}}
``:code

It generates the following output:

``
&lt;html&gt;
  &lt;body&gt;
    Hello World!!!
    &lt;div class=&quot;sidebar&quot;&gt;
        my new sidebar!!!
    &lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;
``:code

You can have many blocks, and if a block is present in the extended view but not in the extending view, the content of the extended view is used. Also, notice that unlike with functions, it is not necessary to define blocks before the ``{{extend ...}}`` -- even if defined after the ``extend``, they can be used to make substitutions anywhere in the extended view.

``super``:inxx

Inside a block, you can use the expression ``{{super}}`` to include the content of the parent. For example, if we replace the above extending view with:

``
{{extend &#x27;layout.html&#x27;}}
Hello World!!!
{{block mysidebar}}
{{super}}
my new sidebar!!!
{{end}}
``:code

we get:

``
&lt;html&gt;
  &lt;body&gt;
    Hello World!!!
    &lt;div class=&quot;sidebar&quot;&gt;
        my default sidebar
        my new sidebar!!!
    &lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;
``:code

</pre></div>
    <div class="span6"><pre style="background-color: #F2DEDE;">## The views
``views``:inxx ``template language``:inxx ``HTML``:inxx

web2py uses Python for its models, controllers, and views, although it uses a slightly modified Python syntax in the views to allow more readable code without imposing any restrictions on proper Python usage.

The purpose of a view is to embed code (Python) in an HTML document. In general, this poses some problems:
- How should embedded code be escaped?
- Should indenting be based on Python or HTML rules?

web2py uses ``{{ ... }}`` to escape Python code embedded in HTML. The advantage of using curly brackets instead of angle brackets is that it&#x27;s transparent to all common HTML editors. This allows the developer to use those editors to create web2py views.

Since the developer is embedding Python code into HTML, the document should be indented according to HTML rules, and not Python rules. Therefore, we allow unindented Python inside the ``{{ ... }}`` tags. Since Python normally uses indentation to delimit blocks of code, we need a different way to delimit them; this is why the web2py template language makes use of the Python keyword ``pass``.

A code block starts with a line ending with a colon and ends with a line beginning with ``pass``. The keyword ``pass`` is not necessary when the end of the block is obvious from the context.

Here is an example:

``
{{
if i == 0:
response.write(&#x27;i is 0&#x27;)
else:
response.write(&#x27;i is not 0&#x27;)
pass
}}
``:code

Note that ``pass`` is a Python keyword, not a web2py keyword. Some Python editors, such as Emacs, use the keyword ``pass`` to signify the division of blocks and use it to re-indent code automatically.

The web2py template language does exactly the same. When it finds something like:

``
&lt;html&gt;&lt;body&gt;
{{for x in range(10):}}{{=x}}hello&lt;br /&gt;{{pass}}
&lt;/body&gt;&lt;/html&gt;
``:code

it translates it into a program:
``
response.write(&quot;&quot;&quot;&lt;html&gt;&lt;body&gt;&quot;&quot;&quot;, escape=False)
for x in range(10):
    response.write(x)
    response.write(&quot;&quot;&quot;hello&lt;br /&gt;&quot;&quot;&quot;, escape=False)
response.write(&quot;&quot;&quot;&lt;/body&gt;&lt;/html&gt;&quot;&quot;&quot;, escape=False)
``:code
``response.write`` writes to the ``response.body``.

When there is an error in a web2py view, the error report shows the generated view code, not the actual view as written by the developer. This helps the developer debug the code by highlighting the actual code that is executed (which is something that can be debugged with an HTML editor or the DOM inspector of the browser).

Also note that:
``
{{=x}}
``:code

generates
``response.write``:inxx ``escape``:inxx
``
response.write(x)
``:code

Variables injected into the HTML in this way are escaped by default.
The escaping is ignored if ``x`` is an ``XML`` object, even if escape is set to ``True``.

Here is an example that introduces the ``H1`` helper:
``
{{=H1(i)}}
``:code

which is translated to:
``
response.write(H1(i))
``:code

upon evaluation, the ``H1`` object and its components are recursively serialized, escaped and written to the response body. The tags generated by ``H1`` and inner HTML are not escaped. This mechanism guarantees that all text --- and only text --- displayed on the web page is always escaped, thus preventing XSS vulnerabilities. At the same time, the code is simple and easy to debug.

The method ``response.write(obj, escape=True)`` takes two arguments, the object to be written and whether it has to be escaped (set to ``True`` by default). If ``obj`` has an ``.xml()`` method, it is called and the result written to the response body (the ``escape`` argument is ignored). Otherwise it uses the object&#x27;s ``__str__`` method to serialize it and, if the escape argument is ``True``, escapes it. All built-in helper objects (``H1`` in the example) are objects that know how to serialize themselves via the ``.xml()`` method.

This is all done transparently. You never need to (and never should) call the ``response.write`` method explicitly.

### Basic syntax

The web2py template language supports all Python control structures. Here we provide some examples of each of them. They can be nested according to usual programming practice.

#### ``for...in``
``for``:inxx

In templates you can loop over any iterable object:
``
{{items = [&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;]}}
&lt;ul&gt;
{{for item in items:}}&lt;li&gt;{{=item}}&lt;/li&gt;{{pass}}
&lt;/ul&gt;
``:code

which produces:
``
&lt;ul&gt;
&lt;li&gt;a&lt;/li&gt;
&lt;li&gt;b&lt;/li&gt;
&lt;li&gt;c&lt;/li&gt;
&lt;/ul&gt;
``:code

Here ``item`` is any iterable object such as a Python list, Python tuple, or Rows object, or any object that is implemented as an iterator. The elements displayed are first serialized and escaped.

#### ``while``
``while``:inxx

You can create a loop using the while keyword:
``
{{k = 3}}
&lt;ul&gt;
{{while k &gt; 0:}}&lt;li&gt;{{=k}}{{k = k - 1}}&lt;/li&gt;{{pass}}
&lt;/ul&gt;
``:code

which produces:
``
&lt;ul&gt;
&lt;li&gt;3&lt;/li&gt;
&lt;li&gt;2&lt;/li&gt;
&lt;li&gt;1&lt;/li&gt;
&lt;/ul&gt;
``:code

#### ``if...elif...else``
``if``:inxx ``elif``:inxx ``else``:inxx

You can use conditional clauses:
``
{{
import random
k = random.randint(0, 100)
}}
&lt;h2&gt;
{{=k}}
{{if k % 2:}}is odd{{else:}}is even{{pass}}
&lt;/h2&gt;
``:code

which produces:
``
&lt;h2&gt;
45 is odd
&lt;/h2&gt;
``:code

Since it is obvious that ``else`` closes the first ``if`` block, there is no need for a ``pass`` statement, and using one would be incorrect. However, you must explicitly close the ``else`` block with a ``pass``.

Recall that in Python &quot;else if&quot; is written ``elif`` as in the following example:
``
{{
import random
k = random.randint(0, 100)
}}
&lt;h2&gt;
{{=k}}
{{if k % 4 == 0:}}is divisible by 4
{{elif k % 2 == 0:}}is even
{{else:}}is odd
{{pass}}
&lt;/h2&gt;
``:code

It produces:
``
&lt;h2&gt;
64 is divisible by 4
&lt;/h2&gt;
``:code

#### ``try...except...else...finally``
``try``:inxx ``except``:inxx ``else``:inxx ``finally``:inxx

It is also possible to use ``try...except`` statements in views with one caveat. Consider the following example:
``
{{try:}}
Hello {{= 1 / 0}}
{{except:}}
division by zero
{{else:}}
no division by zero
{{finally}}
&lt;br /&gt;
{{pass}}
``:code

It will produce the following output:
``
Hello
division by zero
&lt;br /&gt;
``:code

This example illustrates that all output generated before an exception occurs is rendered (including output that preceded the exception) inside the try block. &quot;Hello&quot; is written because it precedes the exception.

#### ``def...return``
``def``:inxx ``return``:inxx

The web2py template language allows the developer to define and implement functions that can return any Python object or a text/html string. Here we consider two examples:
``
{{def itemize1(link): return LI(A(link, _href=&quot;http://&quot; + link))}}
&lt;ul&gt;
{{=itemize1(&#x27;www.google.com&#x27;)}}
&lt;/ul&gt;
``:code

produces the following output:
``
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http:/www.google.com&quot;&gt;www.google.com&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
``:code

The function ``itemize1`` returns a helper object that is inserted at the location where the function is called.

Consider now the following code:
``
{{def itemize2(link):}}
&lt;li&gt;&lt;a href=&quot;http://{{=link}}&quot;&gt;{{=link}}&lt;/a&gt;&lt;/li&gt;
{{return}}
&lt;ul&gt;
{{itemize2(&#x27;www.google.com&#x27;)}}
&lt;/ul&gt;
``:code

It produces exactly the same output as above. In this case, the function ``itemize2`` represents a piece of HTML that is going to replace the web2py tag where the function is called. Notice that there is no &#x27;=&#x27; in front of the call to ``itemize2``, since the function does not return the text, but it writes it directly into the response.

There is one caveat: functions defined inside a view must terminate with a return statement, or the automatic indentation will fail.

### HTML helpers
``helpers``:inxx

Consider the following code in a view:
``
{{=DIV(&#x27;this&#x27;, &#x27;is&#x27;, &#x27;a&#x27;, &#x27;test&#x27;, _id=&#x27;123&#x27;, _class=&#x27;myclass&#x27;)}}
``:code

it is rendered as:
``
&lt;div id=&quot;123&quot; class=&quot;myclass&quot;&gt;thisisatest&lt;/div&gt;
``:code
``DIV`` is a helper class, i.e., something that can be used to build HTML programmatically. It corresponds to the HTML ``&lt;div&gt;`` tag.

Positional arguments are interpreted as objects contained between the open and close tags. Named arguments that start with an underscore are interpreted as HTML tag attributes (without the underscore). Some helpers also have named arguments that do not start with underscore; these arguments are tag-specific.

Instead of a set of unnamed arguments, a helper can also take a single list or tuple as its set of components using the ``*`` notation and it can take a single dictionary as its set of attributes using the ``**``, for example:
``
{{
contents = [&#x27;this&#x27;,&#x27;is&#x27;,&#x27;a&#x27;,&#x27;test&#x27;]
attributes = {&#x27;_id&#x27;:&#x27;123&#x27;, &#x27;_class&#x27;:&#x27;myclass&#x27;}
=DIV(*contents,**attributes)
}}
``:code
(produces the same output as before).

The following set of helpers:

``A``,  ``B``,  ``BEAUTIFY``,  ``BODY``,  ``BR``,  ``CAT``,  ``CENTER``,  ``CODE``,  ``COL``, ``COLGROUP``, ``DIV``,  ``EM``,  ``EMBED``,  ``FIELDSET``,  ``FORM``,  ``H1``,  ``H2``,  ``H3``,  ``H4``,  ``H5``,  ``H6``,  ``HEAD``,  ``HR``,  ``HTML``,  ``I``,  ``IFRAME``,  ``IMG``,  ``INPUT``,  ``LABEL``,  ``LEGEND``,  ``LI``,  ``LINK``,  ``MARKMIN``,  ``MENU``,  ``META``,  ``OBJECT``,  ``ON``,  ``OL``,  ``OPTGROUP``,  ``OPTION``,  ``P``,  ``PRE``,  ``SCRIPT``,  ``SELECT``,  ``SPAN``,  ``STYLE``,  ``TABLE``,  ``TAG``,  ``TBODY``,  ``TD``,  ``TEXTAREA``,  ``TFOOT``,  ``TH``,  ``THEAD``,  ``TITLE``,  ``TR``,  ``TT``, ``UL``,   ``URL``,  ``XHTML``,  ``XML``,  ``embed64``,  ``xmlescape``

can be used to build complex expressions that can then be serialized to XML``xml:w``:cite ``xml:o``:cite. For example:
``
{{=DIV(B(I(&quot;hello &quot;, &quot;&lt;world&gt;&quot;))), _class=&quot;myclass&quot;)}}
``:code

is rendered:
``
&lt;div class=&quot;myclass&quot;&gt;&lt;b&gt;&lt;i&gt;hello &amp;lt;world&amp;gt;&lt;/i&gt;&lt;/b&gt;&lt;/div&gt;
``:code

Helpers can also be serialized into strings, equivalently, with the ``__str__`` and the ``xml`` methods:

``
&gt;&gt;&gt; print str(DIV(&quot;hello world&quot;))
&lt;div&gt;hello world&lt;/div&gt;
&gt;&gt;&gt; print DIV(&quot;hello world&quot;).xml()
&lt;div&gt;hello world&lt;/div&gt;
``

``Document Object Model (DOM)``:inxx
The helpers mechanism in web2py is more than a system to generate HTML without concatenating strings. It provides a server-side representation of the Document Object Model (DOM).

Components of helpers can be referenced via their position, and helpers act as lists with respect to their components:
``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;a&#x27;, &#x27;b&#x27;), &#x27;c&#x27;)
&gt;&gt;&gt; print a
&lt;div&gt;&lt;span&gt;ab&lt;/span&gt;c&lt;/div&gt;
&gt;&gt;&gt; del a[1]
&gt;&gt;&gt; a.append(B(&#x27;x&#x27;))
&gt;&gt;&gt; a[0][0] = &#x27;y&#x27;
&gt;&gt;&gt; print a
&lt;div&gt;&lt;span&gt;yb&lt;/span&gt;&lt;b&gt;x&lt;/b&gt;&lt;/div&gt;
``:code

Attributes of helpers can be referenced by name, and helpers act as dictionaries with respect to their attributes:
``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;a&#x27;, &#x27;b&#x27;), &#x27;c&#x27;)
&gt;&gt;&gt; a[&#x27;_class&#x27;] = &#x27;s&#x27;
&gt;&gt;&gt; a[0][&#x27;_class&#x27;] = &#x27;t&#x27;
&gt;&gt;&gt; print a
&lt;div class=&quot;s&quot;&gt;&lt;span class=&quot;t&quot;&gt;ab&lt;/span&gt;c&lt;/div&gt;
``:code

Note, the complete set of components can be accessed via a list called ``a.components``, and the complete set of attributes can be accessed via a dictionary called ``a.attributes``. So, ``a[i]`` is equivalent to ``a.components[i]`` when ``i`` is an integer, and ``a[s]`` is equivalent to ``a.attributes[s]`` when ``s`` is a string.

Notice that helper attributes are passed as keyword arguments to the helper. In some cases, however, attribute names include special characters that are not allowed in Python identifiers (e.g., hyphens) and therefore cannot be used as keyword argument names. For example:

``
DIV(&#x27;text&#x27;, _data-role=&#x27;collapsible&#x27;)
``:code

will not work because &quot;_data-role&quot; includes a hyphen, which will produce a Python syntax error.

In such cases, you can instead pass the attributes as a dictionary and make use of Python&#x27;s ``**`` function arguments notation, which map a dictionary of (key:value) pairs into a set of keyword arguments:

``
&gt;&gt;&gt; print DIV(&#x27;text&#x27;, **{&#x27;_data-role&#x27;: &#x27;collapsible&#x27;})
&lt;div data-role=&quot;collapsible&quot;&gt;text&lt;/div&gt;
``:code

You can also dynamically create special TAGs:

``
&gt;&gt;&gt; print TAG[&#x27;soap:Body&#x27;](&#x27;whatever&#x27;,**{&#x27;_xmlns:m&#x27;:&#x27;http://www.example.org&#x27;})
&lt;soap:Body xmlns:m=&quot;http://www.example.org&quot;&gt;whatever&lt;/soap:Body&gt;
``:code

#### ``XML``
``XML``:inxx
``XML`` is an object used to encapsulate text that should not be escaped. The text may or may not contain valid XML. For example, it could contain JavaScript.

The text in this example is escaped:
``
&gt;&gt;&gt; print DIV(&quot;&lt;b&gt;hello&lt;/b&gt;&quot;)
&amp;lt;b&amp;gt;hello&amp;lt;/b&amp;gt;
``:code

by using ``XML`` you can prevent escaping:
``
&gt;&gt;&gt; print DIV(XML(&quot;&lt;b&gt;hello&lt;/b&gt;&quot;))
&lt;b&gt;hello&lt;/b&gt;
``:code

Sometimes you want to render HTML stored in a variable, but the HTML may contain unsafe tags such as scripts:
``
&gt;&gt;&gt; print XML(&#x27;&lt;script&gt;alert(&quot;unsafe!&quot;)&lt;/script&gt;&#x27;)
&lt;script&gt;alert(&quot;unsafe!&quot;)&lt;/script&gt;
``:code

Un-escaped executable input such as this (for example, entered in the body of a comment in a blog) is unsafe, because it can be used to generate Cross Site Scripting (XSS) attacks against other visitors to the page.

``sanitize``:inxx
The web2py ``XML`` helper can sanitize our text to prevent injections and escape all tags except those that you explicitly allow. Here is an example:
``
&gt;&gt;&gt; print XML(&#x27;&lt;script&gt;alert(&quot;unsafe!&quot;)&lt;/script&gt;&#x27;, sanitize=True)
&amp;lt;script&amp;gt;alert(&amp;quot;unsafe!&amp;quot;)&amp;lt;/script&amp;gt;
``:code

The ``XML`` constructors, by default, consider the content of some tags and some of their attributes safe. You can override the defaults using the optional ``permitted_tags`` and ``allowed_attributes`` arguments. Here are the default values of the optional arguments of the ``XML`` helper.
``
XML(text, sanitize=False,
    permitted_tags=[&#x27;a&#x27;, &#x27;b&#x27;, &#x27;blockquote&#x27;, &#x27;br/&#x27;, &#x27;i&#x27;, &#x27;li&#x27;,
       &#x27;ol&#x27;, &#x27;ul&#x27;, &#x27;p&#x27;, &#x27;cite&#x27;, &#x27;code&#x27;, &#x27;pre&#x27;, &#x27;img/&#x27;],
    allowed_attributes={&#x27;a&#x27;:[&#x27;href&#x27;, &#x27;title&#x27;],
       &#x27;img&#x27;:[&#x27;src&#x27;, &#x27;alt&#x27;], &#x27;blockquote&#x27;:[&#x27;type&#x27;]})
``:code

#### Built-in helpers

##### ``A``

This helper is used to build links.

``A``:inxx
``
&gt;&gt;&gt; print A(&#x27;&lt;click&gt;&#x27;, XML(&#x27;&lt;b&gt;me&lt;/b&gt;&#x27;),
            _href=&#x27;http://www.web2py.com&#x27;)
&lt;a href=&#x27;http://www.web2py.com&#x27;&gt;&amp;lt;click&amp;gt;&lt;b&gt;me/b&gt;&lt;/a&gt;
``:code

Instead of ``_href`` you can pass the URL using the ``callback`` argument. For example in a view:

``
{{=A(&#x27;click me&#x27;, callback=URL(&#x27;myaction&#x27;))}}
``

and the effect of pressing the link will be an ajax call to &quot;myaction&quot; instead of a redirection.
In this case, optionally you can specify two more arguments: ``target`` and ``delete``:
``
{{=A(&#x27;click me&#x27;, callback=URL(&#x27;myaction&#x27;), target=&quot;t&quot;)}}
&lt;div id=&quot;t&quot;&gt;&lt;div&gt;
``
and the response of the ajax callback will be stored in the DIV with id equal to &quot;t&quot;.

``
&lt;div id=&quot;b&quot;&gt;{{=A(&#x27;click me&#x27;, callback=URL(&#x27;myaction&#x27;), delete=&#x27;div#b&quot;)}}&lt;/div&gt;
``
and upon response, the closest tag matching &quot;div#b&quot; will be deleted. In this case, the button will be deleted.
A typical application is:

``
{{=A(&#x27;click me&#x27;, callback=URL(&#x27;myaction&#x27;), delete=&#x27;tr&quot;)}}
``

in a table. Pressing the button will perform the callback and delete the table row.

``callback`` and ``delete`` can be combined.

The A helper takes a special argument called ``cid``. It works as follows:

``
{{=A(&#x27;linked page&#x27;, _href=&#x27;http://example.com&#x27;, cid=&#x27;myid&#x27;)}}
&lt;div id=&quot;myid&quot;&gt;&lt;/div&gt;
``:code

and a click on the link causes the content to be loaded in the div. This is similar but more powerful than the above syntax since it is designed to refresh page components. We discuss applications of ``cid`` in more detail in Chapter 12, in the context of components.

These ajax features require jQuery and &quot;static/js/web2py_ajax.js&quot;, which are automatically included by placing ``{{include &#x27;web2py_ajax.html&#x27;}}`` in the layout head. &quot;views/web2py_ajax.html&quot; defines some variables based on ``request`` and includes all necessary js and css files.


##### ``B``
``B``:inxx

This helper makes its contents bold.
``
&gt;&gt;&gt; print B(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;i&gt;world&lt;/i&gt;&#x27;), _class=&#x27;test&#x27;, _id=0)
&lt;b id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;i&gt;world&lt;/i&gt;&lt;/b&gt;
``:code

##### ``BODY``
``BODY``:inxx
This helper makes the body of a page.
``
&gt;&gt;&gt; print BODY(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;), _bgcolor=&#x27;red&#x27;)
&lt;body bgcolor=&quot;red&quot;&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/body&gt;
``:code

##### ``BR``
``BR``:inxx

This helper creates a line break.
``
&gt;&gt;&gt; print BR()
&lt;br /&gt;
``:code

##### ``CAT`` (1.98.1 and up)
``CAT``:inxx

This helper concatenates other helpers, same as TAG[&#x27;&#x27;].
``
&gt;&gt;&gt; print CAT(&#x27;Here is a &#x27;, A(&#x27;link&#x27;,_href=URL()), &#x27;, and here is some &#x27;, B(&#x27;bold text&#x27;), &#x27;.&#x27;)
Here is a &lt;a href=&quot;/app/default/index&quot;&gt;link&lt;/a&gt;, and here is some &lt;b&gt;bold text&lt;/b&gt;.
``:code

##### ``CENTER``
``CENTER``:inxx

This helper centers its content.
``
&gt;&gt;&gt; print CENTER(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;),
&gt;&gt;&gt;              _class=&#x27;test&#x27;, _id=0)
&lt;center id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/center&gt;
``:code

##### ``CODE``
``CODE``:inxx

This helper performs syntax highlighting for Python, C, C++, HTML and web2py code, and is preferable to ``PRE`` for code listings. ``CODE`` also has the ability to create links to the web2py API documentation.

Here is an example of highlighting sections of Python code.
``
&gt;&gt;&gt; print CODE(&#x27;print &quot;hello&quot;&#x27;, language=&#x27;python&#x27;).xml()
&lt;table&gt;&lt;tr valign=&quot;top&quot;&gt;&lt;td style=&quot;width:40px; text-align: right;&quot;&gt;&lt;pre style=&quot;
        font-size: 11px;
        font-family: Bitstream Vera Sans Mono,monospace;
        background-color: transparent;
            margin: 0;
            padding: 5px;
            border: none;
        background-color: #E0E0E0;
        color: #A0A0A0;
    &quot;&gt;1.&lt;/pre&gt;&lt;/td&gt;&lt;td&gt;&lt;pre style=&quot;
        font-size: 11px;
        font-family: Bitstream Vera Sans Mono,monospace;
        background-color: transparent;
            margin: 0;
            padding: 5px;
            border: none;
            overflow: auto;
    &quot;&gt;&lt;span style=&quot;color:#185369; font-weight: bold&quot;&gt;print &lt;/span&gt;
    &lt;span style=&quot;color: #FF9966&quot;&gt;&quot;hello&quot;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;
``:code

Here is a similar example for HTML
``
&gt;&gt;&gt; print CODE(
&gt;&gt;&gt;   &#x27;&lt;html&gt;&lt;body&gt;{{=request.env.remote_add}}&lt;/body&gt;&lt;/html&gt;&#x27;,
&gt;&gt;&gt;   language=&#x27;html&#x27;)
``:code
``
&lt;table&gt;...&lt;code&gt;...
&lt;html&gt;&lt;body&gt;{{=request.env.remote_add}}&lt;/body&gt;&lt;/html&gt;
...&lt;/code&gt;...&lt;/table&gt;
``:code

These are the default arguments for the ``CODE`` helper:
``
CODE(&quot;print &#x27;hello world&#x27;&quot;, language=&#x27;python&#x27;, link=None, counter=1, styles={})
``:code

Supported values for the ``language`` argument are &quot;python&quot;, &quot;html_plain&quot;, &quot;c&quot;, &quot;cpp&quot;, &quot;web2py&quot;, and &quot;html&quot;. The &quot;html&quot; language interprets {{ and }} tags as &quot;web2py&quot; code, while &quot;html_plain&quot; doesn&#x27;t.

If a ``link`` value is specified, for example &quot;/examples/global/vars/&quot;, web2py API references in the code are linked to documentation at the link URL. For example &quot;request&quot; would be linked to &quot;/examples/global/vars/request&quot;. In the above example, the link URL is handled by the &quot;vars&quot; action in the &quot;global.py&quot; controller that is distributed as part of the web2py &quot;examples&quot; application.

The ``counter`` argument is used for line numbering. It can be set to any of three different values. It can be ``None`` for no line numbers, a numerical value specifying the start number, or a string. If the counter is set to a string, it is interpreted as a prompt, and there are no line numbers.

The ``styles`` argument is a bit tricky. If you look at the generated HTML above, it contains a table with two columns, and each column has its own style declared inline using CSS. The ``styles`` attributes allows you to override those two CSS styles. For example:

``
{{=CODE(...,styles={&#x27;CODE&#x27;:&#x27;margin: 0;padding: 5px;border: none;&#x27;})}}
``:code

The ``styles`` attribute must be a dictionary, and it allows two possible keys: ``CODE`` for the style of the actual code, and ``LINENUMBERS`` for the style of the left column, which contains the line numbers. Mind that these styles completely replace the default styles and are not simply added to them.

##### ``COL``
``COL``:inxx

``
&gt;&gt;&gt; print COL(&#x27;a&#x27;,&#x27;b&#x27;)
&lt;col&gt;ab&lt;/col&gt;
``:code

##### ``COLGROUP``
``COLGROUP``:inxx

``
&gt;&gt;&gt; print COLGROUP(&#x27;a&#x27;,&#x27;b&#x27;)
&lt;colgroup&gt;ab&lt;/colgroup&gt;
``:code

##### ``DIV``
All helpers apart from ``XML`` are derived from ``DIV`` and inherit its basic methods.

``DIV``:inxx
``
&gt;&gt;&gt; print DIV(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;), _class=&#x27;test&#x27;, _id=0)
&lt;div id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/div&gt;
``:code

##### ``EM``

Emphasizes its content.

``EM``:inxx
``
&gt;&gt;&gt; print EM(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;), _class=&#x27;test&#x27;, _id=0)
&lt;em id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/em&gt;
``:code

##### ``FIELDSET``
``FIELDSET``:inxx

This is used to create an input field together with its label.
``
&gt;&gt;&gt; print FIELDSET(&#x27;Height:&#x27;, INPUT(_name=&#x27;height&#x27;), _class=&#x27;test&#x27;)
&lt;fieldset class=&quot;test&quot;&gt;Height:&lt;input name=&quot;height&quot; /&gt;&lt;/fieldset&gt;
``:code

##### ``FORM``
``FORM``:inxx

This is one of the most important helpers. In its simple form, it just makes a ``&lt;form&gt;...&lt;/form&gt;`` tag, but because helpers are objects and have knowledge of what they contain, they can process submitted forms (for example, perform validation of the fields). This will be discussed in detail in Chapter 7.
``
&gt;&gt;&gt; print FORM(INPUT(_type=&#x27;submit&#x27;), _action=&#x27;&#x27;, _method=&#x27;post&#x27;)
&lt;form enctype=&quot;multipart/form-data&quot; action=&quot;&quot; method=&quot;post&quot;&gt;
&lt;input type=&quot;submit&quot; /&gt;&lt;/form&gt;
``:code

The &quot;enctype&quot; is &quot;multipart/form-data&quot; by default.

``hidden``:inxx
The constructor of a ``FORM``, and of ``SQLFORM``, can also take a special argument called ``hidden``. When a dictionary is passed as ``hidden``, its items are translated into &quot;hidden&quot; INPUT fields. For example:
``
&gt;&gt;&gt; print FORM(hidden=dict(a=&#x27;b&#x27;))
&lt;form enctype=&quot;multipart/form-data&quot; action=&quot;&quot; method=&quot;post&quot;&gt;
&lt;input value=&quot;b&quot; type=&quot;hidden&quot; name=&quot;a&quot; /&gt;&lt;/form&gt;
``:code

##### ``H1``, ``H2``, ``H3``, ``H4``, ``H5``, ``H6``
``H1``:inxx

These helpers are for paragraph headings and subheadings:
``
&gt;&gt;&gt; print H1(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;), _class=&#x27;test&#x27;, _id=0)
&lt;h1 id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/h1&gt;
``:code

##### ``HEAD``

For tagging the HEAD of an HTML page.

``HEAD``:inxx
``
&gt;&gt;&gt; print HEAD(TITLE(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;)))
&lt;head&gt;&lt;title&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/title&gt;&lt;/head&gt;
``:code

##### ``HTML``
``HTML``:inxx ``XHTML``:inxx

This helper is a little different. In addition to making the ``&lt;html&gt;`` tags,
it prepends the tag with a doctype string``xhtml:w,xhtml:o,xhtml:school``:cite .
``
&gt;&gt;&gt; print HTML(BODY(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;)))
&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;
                      &quot;http://www.w3.org/TR/html4/loose.dtd&quot;&gt;
&lt;html&gt;&lt;body&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/body&gt;&lt;/html&gt;
``:code

The HTML helper also takes some additional optional arguments that have the following default:
``
HTML(..., lang=&#x27;en&#x27;, doctype=&#x27;transitional&#x27;)
``:code

where doctype can be &#x27;strict&#x27;, &#x27;transitional&#x27;, &#x27;frameset&#x27;, &#x27;html5&#x27;, or a full doctype string.

##### ``XHTML``
``XHTML``:inxx

XHTML is similar to HTML but it creates an XHTML doctype instead.
``
XHTML(..., lang=&#x27;en&#x27;, doctype=&#x27;transitional&#x27;, xmlns=&#x27;http://www.w3.org/1999/xhtml&#x27;)
``:code

where doctype can be &#x27;strict&#x27;, &#x27;transitional&#x27;, &#x27;frameset&#x27;, or a full doctype string.

##### ``HR``
``HR``:inxx

This helper creates a horizontal line in an HTML page
``
&gt;&gt;&gt; print HR()
&lt;hr /&gt;
``:code

##### ``I``
``I``:inxx

This helper makes its contents italic.
``
&gt;&gt;&gt; print I(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;), _class=&#x27;test&#x27;, _id=0)
&lt;i id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/i&gt;
``:code

##### ``INPUT``
``INPUT``:inxx

Creates an ``&lt;input.../&gt;`` tag. An input tag may not contain other tags, and is closed by ``/&gt;`` instead of ``&gt;``. The input tag has an optional attribute ``_type`` that can be set to &quot;text&quot; (the default), &quot;submit&quot;, &quot;checkbox&quot;, or &quot;radio&quot;.
``
&gt;&gt;&gt; print INPUT(_name=&#x27;test&#x27;, _value=&#x27;a&#x27;)
&lt;input value=&quot;a&quot; name=&quot;test&quot; /&gt;
``:code

It also takes an optional special argument called &quot;value&quot;, distinct from &quot;_value&quot;. The latter sets the default value for the input field; the former sets its current value. For an input of type &quot;text&quot;, the former overrides the latter:
``
&gt;&gt;&gt; print INPUT(_name=&#x27;test&#x27;, _value=&#x27;a&#x27;, value=&#x27;b&#x27;)
&lt;input value=&quot;b&quot; name=&quot;test&quot; /&gt;
``:code

For radio buttons, ``INPUT`` selectively sets the &quot;checked&quot; attribute:

``radio``:inxx
``
&gt;&gt;&gt; for v in [&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;]:
&gt;&gt;&gt;     print INPUT(_type=&#x27;radio&#x27;, _name=&#x27;test&#x27;, _value=v, value=&#x27;b&#x27;), v
&lt;input value=&quot;a&quot; type=&quot;radio&quot; name=&quot;test&quot; /&gt; a
&lt;input value=&quot;b&quot; type=&quot;radio&quot; checked=&quot;checked&quot; name=&quot;test&quot; /&gt; b
&lt;input value=&quot;c&quot; type=&quot;radio&quot; name=&quot;test&quot; /&gt; c
``:code

and similarly for checkboxes:

``checkbox``:inxx
``
&gt;&gt;&gt; print INPUT(_type=&#x27;checkbox&#x27;, _name=&#x27;test&#x27;, _value=&#x27;a&#x27;, value=True)
&lt;input value=&quot;a&quot; type=&quot;checkbox&quot; checked=&quot;checked&quot; name=&quot;test&quot; /&gt;
&gt;&gt;&gt; print INPUT(_type=&#x27;checkbox&#x27;, _name=&#x27;test&#x27;, _value=&#x27;a&#x27;, value=False)
&lt;input value=&quot;a&quot; type=&quot;checkbox&quot; name=&quot;test&quot; /&gt;
``:code

##### ``IFRAME``

This helper includes another web page in the current page. The url of the other page is specified via the &quot;_src&quot; attribute.

``IFRAME``:inxx
``
&gt;&gt;&gt; print IFRAME(_src=&#x27;http://www.web2py.com&#x27;)
&lt;iframe src=&quot;http://www.web2py.com&quot;&gt;&lt;/iframe&gt;
``:code

##### ``IMG``
``IMG``:inxx

It can be used to embed images into HTML:

``
&gt;&gt;&gt; IMG(_src=&#x27;http://example.com/image.png&#x27;,_alt=&#x27;test&#x27;)
&lt;img src=&quot;http://example.com/image.ong&quot; alt=&quot;rest&quot; /&gt;
``:code

Here is a combination of A, IMG, and URL helpers for including a static image with a link:

``
&gt;&gt;&gt; A(IMG(_src=URL(&#x27;static&#x27;,&#x27;logo.png&#x27;), _alt=&quot;My Logo&quot;),
      _href=URL(&#x27;default&#x27;,&#x27;index&#x27;))
&lt;a href=&quot;/myapp/default/index&quot;&gt;
  &lt;img src=&quot;/myapp/static/logo.png&quot; alt=&quot;My Logo&quot; /&gt;
&lt;/a&gt;
``:code

##### ``LABEL``

It is used to create a LABEL tag for an INPUT field.

``LABEL``:inxx
``
&gt;&gt;&gt; print LABEL(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;), _class=&#x27;test&#x27;, _id=0)
&lt;label id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/label&gt;
``:code

##### ``LEGEND``

It is used to create a legend tag for a field in a form.

``LEGEND``:inxx
``
&gt;&gt;&gt; print LEGEND(&#x27;Name&#x27;, _for=&#x27;myfield&#x27;)
&lt;legend for=&quot;myfield&quot;&gt;Name&lt;/legend&gt;
``:code

##### ``LI``

It makes a list item and should be contained in a ``UL`` or ``OL`` tag.

``LI``:inxx
``
&gt;&gt;&gt; print LI(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;), _class=&#x27;test&#x27;, _id=0)
&lt;li id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/li&gt;
``:code

##### ``META``

To be used for building ``META`` tags in the ``HTML`` head. For example:

``META``:inxx
``
&gt;&gt;&gt; print META(_name=&#x27;security&#x27;, _content=&#x27;high&#x27;)
&lt;meta name=&quot;security&quot; content=&quot;high&quot; /&gt;
``:code

##### ``MARKMIN``

Implements the markmin wiki syntax. It converts the input text into output html according to the markmin rules described in the example below:

``MARKMIN``:inxx
``
&gt;&gt;&gt; print MARKMIN(&quot;this is **bold** or &#x27;&#x27;italic&#x27;&#x27; and this [[a link http://web2py.com]]&quot;)
&lt;p&gt;this is &lt;b&gt;bold&lt;/b&gt; or &lt;i&gt;italic&lt;/i&gt; and
this &lt;a href=&quot;http://web2py.com&quot;&gt;a link&lt;/a&gt;&lt;/p&gt;
``:code

The markmin syntax is described in this file that ships with web2py:
``
http://127.0.0.1:8000/examples/static/markmin.html
``:code

and some examples are shown in chapter 12 in the context of plugin_wiki, which uses MARKMIN extensively.

You can use markmin to generate HTML, LaTeX and PDF documents:

``
m = &quot;Hello **world** [[link http://web2py.com]]&quot;
from gluon.contrib.markmin.markmin2html import markmin2html
print markmin2html(m)
from gluon.contrib.markmin.markmin2latex import markmin2latex
print markmin2latex(m)
from gluon.contrib.markmin.markmin2pdf import markmin2pdf
print markmin2pdf(m) # requires pdflatex
``

(the ``MARKMIN`` helper is a shortcut for ``markmin2html``)

Here is a basic syntax primer:

**SOURCE**                 | **OUTPUT**
``# title``                | **title**
``## section``             | **section**
``### subsection``         | **subsection**
``**bold**``               | **bold**
``&#x27;&#x27;italic&#x27;&#x27;``             | &#x27;&#x27;italic&#x27;&#x27;
``!`!`verbatim`!`!``       | ``verbatim``
``http://google.com``      | http://google.com
``http://...`` | ``&lt;a href=&quot;http://...&quot;&gt;http:...&lt;/a&gt;``
``http://...png`` | ``&lt;img src=&quot;http://...png&quot; /&gt;``
``http://...mp3`` | ``&lt;audio src=&quot;http://...mp3&quot;&gt;&lt;/audio&gt;``
``http://...mp4`` | ``&lt;video src=&quot;http://...mp4&quot;&gt;&lt;/video&gt;``
``qr:http://...`` | ``&lt;a href=&quot;http://...&quot;&gt;&lt;img src=&quot;qr code&quot;/&gt;&lt;/a&gt;``
``embed:http://...`` | ``&lt;iframe src=&quot;http://...&quot;&gt;&lt;/iframe&gt;``
``[[click me #myanchor]]`` | [[click me #myanchor]]
``$````$\int_a^b sin(x)dx$````$``  | $$\int_a^b sin(x)dx$$

Simply including a link to an image, a videos or an audio files without markup result in the corresponding image, video or audio file being included automatically (for audio and video it uses html &lt;audio&gt; and &lt;video&gt; tags).

Adding a link with the ``qr:`` prefix such as 

``
qr:http://web2py.com
``

results in the corresponding QR code being embedded and linking the said URL.

Adding a link with the ``embed:`` prefix such as

``
embed:http://www.youtube.com/embed/x1w8hKTJ2Co
`` 

results in the page being embedded, in this case a youtube video is embedded.

Images can also be embedded with the following syntax:

``
[[image-description http://.../image.png right 200px]]
``

Unordered lists with:
``
- one
- two
- three
``

Ordered lists with:
``
+ one
+ two
+ three
``

and tables with:
``
 X | 0 | 0
 0 | X | 0
 0 | 0 | 1
``

The MARKMIN syntax also supports blockquotes, HTML5 audio and video tags, image alignment, custom css, and it can be extended:

``
MARKMIN(&quot;!`!!`!abab!`!!`!:custom&quot;, extra=dict(custom=lambda text: text.replace(&#x27;a&#x27;,&#x27;c&#x27;))
``:code

generates

``&#x27;cbcb&#x27;``:code

Custom blocks are delimited by ``!`!!`!...!`!!`!:&lt;key&gt;`` and they are rendered by the function passed as value for the corresponding key in the extra dictionary argument of MARKMIN. Mind that the function may need to escape the output to prevent XSS.

##### ``OBJECT``

Used to embed objects (for example, a flash player) in the HTML.

``OBJECT``:inxx
``
&gt;&gt;&gt; print OBJECT(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;),
&gt;&gt;&gt;              _src=&#x27;http://www.web2py.com&#x27;)
&lt;object src=&quot;http://www.web2py.com&quot;&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/object&gt;
``:code

##### ``OL``

It stands for Ordered List. The list should contain LI tags. ``OL`` arguments that are not ``LI`` objects are automatically enclosed in ``&lt;li&gt;...&lt;/li&gt;`` tags.

``OL``:inxx
``
&gt;&gt;&gt; print OL(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;), _class=&#x27;test&#x27;, _id=0)
&lt;ol id=&quot;0&quot; class=&quot;test&quot;&gt;&lt;li&gt;&amp;lt;hello&amp;gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;world&lt;/b&gt;&lt;/li&gt;&lt;/ol&gt;
``:code

##### ``ON``

This is here for backward compatibility and it is simply an alias for ``True``. It is used exclusively for checkboxes and deprecated since ``True`` is more Pythonic.

``ON``:inxx
``
&gt;&gt;&gt; print INPUT(_type=&#x27;checkbox&#x27;, _name=&#x27;test&#x27;, _checked=ON)
&lt;input checked=&quot;checked&quot; type=&quot;checkbox&quot; name=&quot;test&quot; /&gt;
``:code

##### ``OPTGROUP``

Allows you to group multiple options in a SELECT and it is useful to customize the fields using CSS.

``OPTGROUP``:inxx
``
&gt;&gt;&gt; print SELECT(&#x27;a&#x27;, OPTGROUP(&#x27;b&#x27;, &#x27;c&#x27;))
&lt;select&gt;
  &lt;option value=&quot;a&quot;&gt;a&lt;/option&gt;
  &lt;optgroup&gt;
    &lt;option value=&quot;b&quot;&gt;b&lt;/option&gt;
    &lt;option value=&quot;c&quot;&gt;c&lt;/option&gt;
  &lt;/optgroup&gt;
&lt;/select&gt;
``:code

##### ``OPTION``

This should only be used as part of a SELECT/OPTION combination.

``OPTION``:inxx
``
&gt;&gt;&gt; print OPTION(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;), _value=&#x27;a&#x27;)
&lt;option value=&quot;a&quot;&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/option&gt;
``:code

As in the case of ``INPUT``, web2py make a distinction between &quot;_value&quot; (the value of the OPTION), and &quot;value&quot; (the current value of the enclosing select). If they are equal, the option is &quot;selected&quot;.

``selected``:inxx
``
&gt;&gt;&gt; print SELECT(&#x27;a&#x27;, &#x27;b&#x27;, value=&#x27;b&#x27;):
&lt;select&gt;
&lt;option value=&quot;a&quot;&gt;a&lt;/option&gt;
&lt;option value=&quot;b&quot; selected=&quot;selected&quot;&gt;b&lt;/option&gt;
&lt;/select&gt;
``:code

##### ``P``
``P``:inxx

This is for tagging a paragraph.
``
&gt;&gt;&gt; print P(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;), _class=&#x27;test&#x27;, _id=0)
&lt;p id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/p&gt;
``:code

##### ``PRE``
``PRE``:inxx

Generates a ``&lt;pre&gt;...&lt;/pre&gt;`` tag for displaying pre-formatted text. The ``CODE`` helper is generally preferable for code listings.
``
&gt;&gt;&gt; print PRE(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;), _class=&#x27;test&#x27;, _id=0)
&lt;pre id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/pre&gt;
``:code

##### ``SCRIPT``
``SCRIPT``:inxx

This is include or link a script, such as JavaScript. The content between the tags is rendered as an HTML comment, for the benefit of really old browsers.
``
&gt;&gt;&gt; print SCRIPT(&#x27;alert(&quot;hello world&quot;);&#x27;, _type=&#x27;text/javascript&#x27;)
&lt;script type=&quot;text/javascript&quot;&gt;&lt;!--
alert(&quot;hello world&quot;);
//--&gt;&lt;/script&gt;
``:code

##### ``SELECT``
``SELECT``:inxx

Makes a ``&lt;select&gt;...&lt;/select&gt;`` tag. This is used with the ``OPTION`` helper. Those ``SELECT`` arguments that are not ``OPTION`` objects are automatically converted to options.
``
&gt;&gt;&gt; print SELECT(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;), _class=&#x27;test&#x27;, _id=0)
&lt;select id=&quot;0&quot; class=&quot;test&quot;&gt;
   &lt;option value=&quot;&amp;lt;hello&amp;gt;&quot;&gt;&amp;lt;hello&amp;gt;&lt;/option&gt;
   &lt;option value=&quot;&amp;lt;b&amp;gt;world&amp;lt;/b&amp;gt;&quot;&gt;&lt;b&gt;world&lt;/b&gt;&lt;/option&gt;
&lt;/select&gt;
``:code

##### ``SPAN``
``SPAN``:inxx

Similar to ``DIV`` but used to tag inline (rather than block) content.
``
&gt;&gt;&gt; print SPAN(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;), _class=&#x27;test&#x27;, _id=0)
&lt;span id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/span&gt;
``:code

##### ``STYLE``
``STYLE``:inxx

Similar to script, but used to either include or link CSS code.
Here the CSS is included:
``
&gt;&gt;&gt; print STYLE(XML(&#x27;body {color: white}&#x27;))
&lt;style&gt;&lt;!--
body { color: white }
//--&gt;&lt;/style&gt;
``:code

and here it is linked:
``
&gt;&gt;&gt; print STYLE(_src=&#x27;style.css&#x27;)
&lt;style src=&quot;style.css&quot;&gt;&lt;!--
//--&gt;&lt;/style&gt;
``:code

##### ``TABLE``, ``TR``, ``TD``
``TABLE``:inxx ``TR``:inxx ``TD``:inxx

These tags (along with the optional ``THEAD``, ``TBODY`` and ``TFOOTER`` helpers) are used to build HTML tables.
``
&gt;&gt;&gt; print TABLE(TR(TD(&#x27;a&#x27;), TD(&#x27;b&#x27;)), TR(TD(&#x27;c&#x27;), TD(&#x27;d&#x27;)))
&lt;table&gt;&lt;tr&gt;&lt;td&gt;a&lt;/td&gt;&lt;td&gt;b&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;c&lt;/td&gt;&lt;td&gt;d&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
``:code
``TR`` expects ``TD`` content; arguments that are not ``TD`` objects are converted automatically.
``
&gt;&gt;&gt; print TABLE(TR(&#x27;a&#x27;, &#x27;b&#x27;), TR(&#x27;c&#x27;, &#x27;d&#x27;))
&lt;table&gt;&lt;tr&gt;&lt;td&gt;a&lt;/td&gt;&lt;td&gt;b&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;c&lt;/td&gt;&lt;td&gt;d&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
``:code

It is easy to convert a Python array into an HTML table using Python&#x27;s ``*`` function arguments notation, which maps list elements to positional function arguments.

Here, we will do it line by line:
``
&gt;&gt;&gt; table = [[&#x27;a&#x27;, &#x27;b&#x27;], [&#x27;c&#x27;, &#x27;d&#x27;]]
&gt;&gt;&gt; print TABLE(TR(*table[0]), TR(*table[1]))
&lt;table&gt;&lt;tr&gt;&lt;td&gt;a&lt;/td&gt;&lt;td&gt;b&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;c&lt;/td&gt;&lt;td&gt;d&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
``:code

Here we do all lines at once:
``
&gt;&gt;&gt; table = [[&#x27;a&#x27;, &#x27;b&#x27;], [&#x27;c&#x27;, &#x27;d&#x27;]]
&gt;&gt;&gt; print TABLE(*[TR(*rows) for rows in table])
&lt;table&gt;&lt;tr&gt;&lt;td&gt;a&lt;/td&gt;&lt;td&gt;b&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;c&lt;/td&gt;&lt;td&gt;d&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
``:code

##### ``TBODY``
``TBODY``:inxx

This is used to tag rows contained in the table body, as opposed to header or footer rows. It is optional.
``
&gt;&gt;&gt; print TBODY(TR(&#x27;&lt;hello&gt;&#x27;), _class=&#x27;test&#x27;, _id=0)
&lt;tbody id=&quot;0&quot; class=&quot;test&quot;&gt;&lt;tr&gt;&lt;td&gt;&amp;lt;hello&amp;gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;
``:code

##### ``TEXTAREA``
``TEXTAREA``:inxx

This helper makes a ``&lt;textarea&gt;...&lt;/textarea&gt;`` tag.
``
&gt;&gt;&gt; print TEXTAREA(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;), _class=&#x27;test&#x27;)
&lt;textarea class=&quot;test&quot; cols=&quot;40&quot; rows=&quot;10&quot;&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/textarea&gt;
``:code

The only caveat is that its optional &quot;value&quot; overrides its content (inner HTML)
``
&gt;&gt;&gt; print TEXTAREA(value=&quot;&lt;hello world&gt;&quot;, _class=&quot;test&quot;)
&lt;textarea class=&quot;test&quot; cols=&quot;40&quot; rows=&quot;10&quot;&gt;&amp;lt;hello world&amp;gt;&lt;/textarea&gt;
``:code

##### ``TFOOT``
``TFOOT``:inxx

This is used to tag table footer rows.
``
&gt;&gt;&gt; print TFOOT(TR(TD(&#x27;&lt;hello&gt;&#x27;)), _class=&#x27;test&#x27;, _id=0)
&lt;tfoot id=&quot;0&quot; class=&quot;test&quot;&gt;&lt;tr&gt;&lt;td&gt;&amp;lt;hello&amp;gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tfoot&gt;
``:code

##### ``TH``
``TH``:inxx

This is used instead of ``TD`` in table headers.
``
&gt;&gt;&gt; print TH(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;), _class=&#x27;test&#x27;, _id=0)
&lt;th id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/th&gt;
``:code

##### ``THEAD``
``THEAD``:inxx

This is used to tag table header rows.
``
&gt;&gt;&gt; print THEAD(TR(TH(&#x27;&lt;hello&gt;&#x27;)), _class=&#x27;test&#x27;, _id=0)
&lt;thead id=&quot;0&quot; class=&quot;test&quot;&gt;&lt;tr&gt;&lt;th&gt;&amp;lt;hello&amp;gt;&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;
``:code

##### ``TITLE``
``TITLE``:inxx

This is used to tag the title of a page in an HTML header.
``
&gt;&gt;&gt; print TITLE(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;))
&lt;title&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/title&gt;
``:code

##### ``TR``
``TR``:inxx

Tags a table row. It should be rendered inside a table and contain ``&lt;td&gt;...&lt;/td&gt;`` tags. ``TR`` arguments that are not ``TD`` objects will be automatically converted.
``
&gt;&gt;&gt; print TR(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;), _class=&#x27;test&#x27;, _id=0)
&lt;tr id=&quot;0&quot; class=&quot;test&quot;&gt;&lt;td&gt;&amp;lt;hello&amp;gt;&lt;/td&gt;&lt;td&gt;&lt;b&gt;world&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;
``:code

##### ``TT``
``TT``:inxx

Tags text as typewriter (monospaced) text.
``
&gt;&gt;&gt; print TT(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;), _class=&#x27;test&#x27;, _id=0)
&lt;tt id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/tt&gt;
``:code

##### ``UL``

Signifies an Unordered List and should contain LI items. If its content is not tagged as LI, UL does it automatically.

``UL``:inxx
``
&gt;&gt;&gt; print UL(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;), _class=&#x27;test&#x27;, _id=0)
&lt;ul id=&quot;0&quot; class=&quot;test&quot;&gt;&lt;li&gt;&amp;lt;hello&amp;gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;world&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;
``:code

##### ``embed64``

``embed64(filename=None, file=None, data=None, extension=&#x27;image/gif&#x27;)`` encodes the provided (binary) data into base64.

filename: if provided, opens and reads this file in &#x27;rb&#x27; mode.
file: if provided, reads this file.
data: if provided, uses the provided data.

``embed64``:inxx

##### ``xmlescape``

``xmlescape(data, quote=True)`` returns an escaped string of the provided data.

``xmlescape``:inxx
``
&gt;&gt;&gt; print xmlescape(&#x27;&lt;hello&gt;&#x27;)
&amp;lt;hello&amp;gt;
``:code

#### Custom helpers

##### ``TAG``
``TAG``:inxx

Sometimes you need to generate custom XML tags. web2py provides ``TAG``, a universal tag generator.
``
{{=TAG.name(&#x27;a&#x27;, &#x27;b&#x27;, _c=&#x27;d&#x27;)}}
``:code

generates the following XML
``
&lt;name c=&quot;d&quot;&gt;ab&lt;/name&gt;
``:code

Arguments &quot;a&quot;, &quot;b&quot;, and &quot;d&quot; are automatically escaped; use the ``XML`` helper to suppress this behavior. Using ``TAG`` you can generate HTML/XML tags not already provided by the API. TAGs can be nested, and are serialized with ``str().``
An equivalent syntax is:
``
{{=TAG[&#x27;name&#x27;](&#x27;a&#x27;, &#x27;b&#x27;, c=&#x27;d&#x27;)}}
``:code

If the TAG object is created with an empty name, it can be used to concatenate multiple strings and HTML helpers together without inserting them into a surrounding tag, but this use is deprecated. Use the ``CAT`` helper instead.

Notice that ``TAG`` is an object, and ``TAG.name`` or ``TAG[&#x27;name&#x27;]`` is a function that returns a temporary helper class.

##### ``MENU``
``MENU``:inxx

The MENU helper takes a list of lists or of tuples of the form of ``response.menu`` (as described in Chapter 4) and generates a tree-like structure using unordered lists representing the menu. For example:
``
&gt;&gt;&gt; print MENU([[&#x27;One&#x27;, False, &#x27;link1&#x27;], [&#x27;Two&#x27;, False, &#x27;link2&#x27;]])
&lt;ul class=&quot;web2py-menu web2py-menu-vertical&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;link1&quot;&gt;One&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;link2&quot;&gt;Two&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
``:code

Each menu item can have a fourth argument that is a nested submenu (and so on recursively):
``
&gt;&gt;&gt; print MENU([[&#x27;One&#x27;, False, &#x27;link1&#x27;, [[&#x27;Two&#x27;, False, &#x27;link2&#x27;]]]])
&lt;ul class=&quot;web2py-menu web2py-menu-vertical&quot;&gt;
  &lt;li class=&quot;web2py-menu-expand&quot;&gt;
     &lt;a href=&quot;link1&quot;&gt;One&lt;/a&gt;
     &lt;ul class=&quot;web2py-menu-vertical&quot;&gt;
        &lt;li&gt;&lt;a href=&quot;link2&quot;&gt;Two&lt;/a&gt;&lt;/li&gt;
     &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;
``:code

A menu item can also have an optional 5th element, which is a boolean. When false, the menu item is ignored by the MENU helper.

The MENU helper takes the following optional arguments:
- ``_class``: defaults to &quot;web2py-menu web2py-menu-vertical&quot; and sets the class of the outer UL elements.
- ``ul_class``: defaults to &quot;web2py-menu-vertical&quot; and sets the class of the inner UL elements.
- ``li_class``: defaults to &quot;web2py-menu-expand&quot; and sets the class of the inner LI elements.

``mobile``:inxx

``MENU`` takes an optional argument ``mobile``. When set to ``True`` instead of building a recursive ``UL`` menu structure it returns a ``SELECT`` dropdown with all the menu options and a ``onchange`` attribute that redirects to the page corresponding to the selected option. This is designed an an alternative menu representation that increases usability on small mobile devices such as phones.

Normally the menu is used in a layout with the following syntax:

``
{{=MENU(response.menu, mobile=request.user_agent().is_mobile)}}
``

In this way a mobile device is automatically detected and the menu is rendered accordingly.

### ``BEAUTIFY``
``BEAUTIFY`` is used to build HTML representations of compound objects, including lists, tuples and dictionaries:
``
{{=BEAUTIFY({&quot;a&quot;: [&quot;hello&quot;, XML(&quot;world&quot;)], &quot;b&quot;: (1, 2)})}}
``:code
``BEAUTIFY`` returns an XML-like object serializable to XML, with a nice looking representation of its constructor argument. In this case, the XML representation of:
``
{&quot;a&quot;: [&quot;hello&quot;, XML(&quot;world&quot;)], &quot;b&quot;: (1, 2)}
``:code

will render as:
``
&lt;table&gt;
&lt;tr&gt;&lt;td&gt;a&lt;/td&gt;&lt;td&gt;:&lt;/td&gt;&lt;td&gt;hello&lt;br /&gt;world&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;b&lt;/td&gt;&lt;td&gt;:&lt;/td&gt;&lt;td&gt;1&lt;br /&gt;2&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;
``:code

### Server-side &#x27;&#x27;DOM&#x27;&#x27; and parsing
``element``:inxx ``elements``:inxx

#### ``elements``

The DIV helper and all derived helpers provide the search methods ``element`` and ``elements``.

``element`` returns the first child element matching a specified condition (or None if no match).

``elements`` returns a list of all matching children.

**element** and **elements** use the same syntax to specify the matching condition, which allows for three possibilities that can be mixed and matched: jQuery-like expressions, match by exact attribute value, match using regular expressions.

Here is a simple example:
``
&gt;&gt;&gt; a = DIV(DIV(DIV(&#x27;a&#x27;, _id=&#x27;target&#x27;,_class=&#x27;abc&#x27;)))
&gt;&gt;&gt; d = a.elements(&#x27;div#target&#x27;)
&gt;&gt;&gt; d[0][0] = &#x27;changed&#x27;
&gt;&gt;&gt; print a
&lt;div&gt;&lt;div&gt;&lt;div id=&quot;target&quot; class=&quot;abc&quot;&gt;changed&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;
``:code

The un-named argument of ``elements`` is a string, which may contain: the name of a tag, the id of a tag preceded by a pound symbol, the class preceded by a dot, the explicit value of an attribute in square brackets.

Here are 4 equivalent ways to search the previous tag by id:
``
&gt;&gt;&gt; d = a.elements(&#x27;#target&#x27;)
&gt;&gt;&gt; d = a.elements(&#x27;div#target&#x27;)
&gt;&gt;&gt; d = a.elements(&#x27;div[id=target]&#x27;)
&gt;&gt;&gt; d = a.elements(&#x27;div&#x27;,_id=&#x27;target&#x27;)
``:code

Here are 4 equivalent ways to search the previous tag by class:
``
&gt;&gt;&gt; d = a.elements(&#x27;.abc&#x27;)
&gt;&gt;&gt; d = a.elements(&#x27;div.abc&#x27;)
&gt;&gt;&gt; d = a.elements(&#x27;div[class=abc]&#x27;)
&gt;&gt;&gt; d = a.elements(&#x27;div&#x27;,_class=&#x27;abc&#x27;)
``:code

Any attribute can be used to locate an element (not just ``id`` and ``class``), including multiple attributes (the function element can take multiple named arguments), but only the first matching element will be returned.

Using the jQuery syntax &quot;div#target&quot; it is possible to specify multiple search criteria separated by a space:
``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;a&#x27;, _id=&#x27;t1&#x27;), DIV(&#x27;b&#x27;, _class=&#x27;c2&#x27;))
&gt;&gt;&gt; d = a.elements(&#x27;span#t1, div.c2&#x27;)
``:code

or equivalently
``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;a&#x27;, _id=&#x27;t1&#x27;), DIV(&#x27;b&#x27;, _class=&#x27;c2&#x27;))
&gt;&gt;&gt; d = a.elements(&#x27;span#t1&#x27;, &#x27;div.c2&#x27;)
``:code

If the value of an attribute is specified using a name argument, it can be a string or a regular expression:
``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;a&#x27;, _id=&#x27;test123&#x27;), DIV(&#x27;b&#x27;, _class=&#x27;c2&#x27;))
&gt;&gt;&gt; d = a.elements(&#x27;span&#x27;, _id=re.compile(&#x27;test\d{3}&#x27;)
``:code

A special named argument of the DIV (and derived) helpers is ``find``. It can be used to specify a search value or a search regular expression in the text content of the tag. For example:
``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;abcde&#x27;), DIV(&#x27;fghij&#x27;))
&gt;&gt;&gt; d = a.elements(find=&#x27;bcd&#x27;)
&gt;&gt;&gt; print d[0]
&lt;span&gt;abcde&lt;/span&gt;
``:code

or
``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;abcde&#x27;), DIV(&#x27;fghij&#x27;))
&gt;&gt;&gt; d = a.elements(find=re.compile(&#x27;fg\w{3}&#x27;))
&gt;&gt;&gt; print d[0]
&lt;div&gt;fghij&lt;/div&gt;
``:code

#### ``components``
Here&#x27;s an example of listing all elements in an html string:
``
html = TAG(&#x27;&lt;a&gt;xxx&lt;/a&gt;&lt;b&gt;yyy&lt;/b&gt;&#x27;)
for item in html.components: print item
``:code

#### ``parent``
``parent`` returns the parent of the current element.
``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;a&#x27;),DIV(&#x27;b&#x27;))
&gt;&gt;&gt; d = a.element(&#x27;a&#x27;).parent()
&gt;&gt;&gt; d[&#x27;_class&#x27;]=&#x27;abc&#x27;
&gt;&gt;&gt; print a
&lt;div class=&quot;abc&quot;&gt;&lt;span&gt;a&lt;/span&gt;&lt;div&gt;b&lt;/div&gt;&lt;/div&gt;
``:code

#### ``flatten``

The flatten method recursively serializes the content of the children of a given element into regular text (without tags):
``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;this&#x27;, DIV(&#x27;is&#x27;, B(&#x27;a&#x27;))), SPAN(&#x27;test&#x27;))
&gt;&gt;&gt; print a.flatten()
thisisatest
``:code

Flatten can be passed an optional argument, ``render``, i.e. a function that renders/flattens the content using a different protocol. Here is an example to serialize some tags into Markmin wiki syntax:
``
&gt;&gt;&gt; a = DIV(H1(&#x27;title&#x27;), P(&#x27;example of a &#x27;, A(&#x27;link&#x27;, _href=&#x27;#test&#x27;)))
&gt;&gt;&gt; from gluon.html import markmin_serializer
&gt;&gt;&gt; print a.flatten(render=markmin_serializer)
## titles

example of [[a link #test]]
``:code

At the time of writing we provide ``markmin_serializer`` and ``markdown_serializer``.

#### Parsing

The TAG object is also an XML/HTML parser. It can read text and convert into a tree structure of helpers. This allows manipulation using the API above:
``
&gt;&gt;&gt; html = &#x27;&lt;h1&gt;Title&lt;/h1&gt;&lt;p&gt;this is a &lt;span&gt;test&lt;/span&gt;&lt;/p&gt;&#x27;
&gt;&gt;&gt; parsed_html = TAG(html)
&gt;&gt;&gt; parsed_html.element(&#x27;span&#x27;)[0]=&#x27;TEST&#x27;
&gt;&gt;&gt; print parsed_html
&lt;h1&gt;Title&lt;/h1&gt;&lt;p&gt;this is a &lt;span&gt;TEST&lt;/span&gt;&lt;/p&gt;
``:code

### Page layout
``page layout``:inxx ``layout.html``:inxx ``extent``:inxx ``include``:inxx

Views can extend and include other views in a tree-like structure.

For example, we can think of a view &quot;index.html&quot; that extends &quot;layout.html&quot; and includes &quot;body.html&quot;.
At the same time,  &quot;layout.html&quot; may include &quot;header.html&quot; and &quot;footer.html&quot;.

The root of the tree is what we call a layout view.  Just like any other HTML template file, you can edit it using the web2py administrative interface. The file name &quot;layout.html&quot; is just a convention.

Here is a minimalist page that extends the &quot;layout.html&quot; view and includes the &quot;page.html&quot; view:

``
{{extend &#x27;layout.html&#x27;}}
&lt;h1&gt;Hello World&lt;/h1&gt;
{{include &#x27;page.html&#x27;}}
``:code

The extended layout file must contain an ``{{include}}`` directive, something like:
``
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;Page Title&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    {{include}}
  &lt;/body&gt;
&lt;/html&gt;
``:code

When the view is called, the extended (layout) view is loaded, and the calling view replaces the ``{{include}}`` directive inside the layout. Processing continues recursively until all ``extend`` and ``include`` directives have been processed. The resulting template is then translated into Python code. Note, when an application is bytecode compiled, it is this Python code that is compiled, not the original view files themselves. So, the bytecode compiled version of a given view is a single .pyc file that includes the Python code not just for the original view file, but for its entire tree of extended and included views.

``extend``, ``include``, ``block`` and ``super`` are special template directives,
not Python commands.

Any content or code that precedes the ``{{extend ...}}`` directive will be inserted (and therefore executed) before the beginning of the extended view&#x27;s content/code. Although this is not typically used to insert actual HTML content before the extended view&#x27;s content, it can be useful as a means to define variables or functions that you want to make available to the extended view. For example, consider a view &quot;index.html&quot;:
``
{{sidebar_enabled=True}}
{{extend &#x27;layout.html&#x27;}}
&lt;h1&gt;Home Page&lt;/h1&gt;
``:code

and an excerpt from &quot;layout.html&quot;:
``
{{if sidebar_enabled:}}
    &lt;div id=&quot;sidebar&quot;&gt;
        Sidebar Content
    &lt;/div&gt;
{{pass}}
``:code

Because the ``sidebar_enabled`` assignment in &quot;index.html&quot; comes before the ``extend``, that line gets inserted before the beginning of &quot;layout.html&quot;, making ``sidebar_enabled`` available anywhere within the &quot;layout.html&quot; code (a somewhat more sophisticated version of this is used in the **welcome** app).

It is also worth pointing out that the variables returned by the controller function are available not only in the function&#x27;s main view, but in all of its extended and included views as well.

The argument of an ``extend`` or ``include`` (i.e., the extended or included view name) can be a python variable (though not a python expression). However, this imposes a limitation -- views that use variables in ``extend`` or ``include`` statements cannot be bytecode compiled. As noted above, bytecode-compiled views include the entire tree of extended and included views, so the specific extended and included views must be known at compile time, which is not possible if the view names are variables (whose values are not determined until run time). Because bytecode compiling views can provide a significant speed boost, using variables in ``extend`` and ``include`` should generally be avoided if possible.

In some cases, an alternative to using a variable in an ``include`` is simply to place regular ``{{include ...}}`` directives inside an ``if...else`` block.

``
{{if some_condition:}}
{{include &#x27;this_view.html&#x27;}}
{{else:}}
{{include &#x27;that_view.html&#x27;}}
{{pass}}
``:code

The above code does not present any problem for bytecode compilation because no variables are involved. Note, however, that the bytecode compiled view will actually include the Python code for both &quot;this_view.html&quot; and &quot;that_view.html&quot;, though only the code for one of those views will be executed, depending on the value of ``some_condition``.

Keep in mind, this only works for ``include`` -- you cannot place ``{{extend ...}}`` directives inside ``if...else`` blocks.

``response.menu``:inxx ``menu``:inxx ``response.meta``:inxx ``meta``:inxx

Layouts are used to encapsulate page commonality (headers, footers, menus), and though they are not mandatory, they will make your application easier to write and maintain.  In particular, we suggest writing layouts that take advantage of the following variables that can be set in the controller. Using these well known variables will help make your layouts interchangeable:
``
response.title
response.subtitle
response.meta.author
response.meta.keywords
response.meta.description
response.flash
response.menu
response.files
``:code

Except for ``menu`` and ``files``, these are all strings and their meaning should be obvious.

``response.menu`` menu is a list of 3-tuples or 4-tuples. The three elements are: the link name, a boolean representing whether the link is active (is the current link), and the URL of the linked page. For example:
``
response.menu = [(&#x27;Google&#x27;, False, &#x27;http://www.google.com&#x27;,[]),
                 (&#x27;Index&#x27;,  True,  URL(&#x27;index&#x27;), [])]
``:code

``sub-menu``:inxx
The fourth tuple element is an optional sub-menu.

``response.files`` is a list of CSS and JS files that are needed by your page.

We also recommend that you use:

``
{{include &#x27;web2py_ajax.html&#x27;}}
``:code

in the HTML head, since this will include the jQuery libraries and define some backward-compatible JavaScript functions for special effects and Ajax. &quot;web2py_ajax.html&quot; includes the ``response.meta`` tags in the view, jQuery base, the calendar datepicker, and all required CSS and JS ``response.files``.

#### Default page layout
``superfish``:inxx ``ez.css``:inxx

Below is the &quot;views/layout.html&quot; that ships with the web2py scaffolding application **welcome** (stripped down of some optional parts). Any new application will have a similar default layout:

``
&lt;!DOCTYPE html&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot; /&gt;
  &lt;title&gt;{{=response.title or request.application}}&lt;/title&gt;

  &lt;!-- http://dev.w3.org/html5/markup/meta.name.html --&gt;
  &lt;meta name=&quot;application-name&quot; content=&quot;{{=request.application}}&quot; /&gt;

  &lt;script src=&quot;{{=URL(&#x27;static&#x27;,&#x27;js/modernizr.custom.js&#x27;)}}&quot;&gt;&lt;/script&gt;

  &lt;!-- include stylesheets --&gt;
  {{
  response.files.append(URL(&#x27;static&#x27;,&#x27;css/skeleton.css&#x27;))
  response.files.append(URL(&#x27;static&#x27;,&#x27;css/web2py.css&#x27;))
  response.files.append(URL(&#x27;static&#x27;,&#x27;css/superfish.css&#x27;))
  response.files.append(URL(&#x27;static&#x27;,&#x27;js/superfish.js&#x27;))
  }}

  {{include &#x27;web2py_ajax.html&#x27;}}

  &lt;script type=&quot;text/javascript&quot;&gt;
    jQuery(function(){ jQuery(&#x27;ul.sf-menu&#x27;).supersubs({minWidth:12,maxWidth:30,extraWidth:3}).superfish(); });
  &lt;/script&gt;

  {{
  # using sidebars need to know what sidebar you want to use
  left_sidebar_enabled = globals().get(&#x27;left_sidebar_enabled&#x27;,False)
  right_sidebar_enabled = globals().get(&#x27;right_sidebar_enabled&#x27;,False)
  middle_columns = {0:&#x27;sixteen&#x27;,1:&#x27;twelve&#x27;,2:&#x27;eight&#x27;}[
     (left_sidebar_enabled and 1 or 0)+(right_sidebar_enabled and 1 or 0)]
  }}

&lt;/head&gt;
&lt;body&gt;
  &lt;div class=&quot;wrapper&quot;&gt;&lt;!-- for sticky footer --&gt;

    &lt;div class=&quot;topbar&quot;&gt;
      &lt;div class=&quot;container&quot;&gt;
        &lt;div class=&quot;sixteen columns&quot;&gt;
          &lt;div id=&quot;navbar&quot;&gt;
            {{=&#x27;auth&#x27; in globals() and auth.navbar(separators=(&#x27; &#x27;,&#x27; | &#x27;,&#x27;&#x27;))}}
          &lt;/div&gt;
          &lt;div id=&quot;menu&quot;&gt;
            {{=MENU(response.menu, 
                    _class=&#x27;mobile-menu&#x27; if is_mobile else &#x27;sf-menu&#x27;,
                    mobile=request.user_agent().is_mobile)}}
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;&lt;!-- topbar --&gt;

    &lt;div class=&quot;flash&quot;&gt;{{=response.flash or &#x27;&#x27;}}&lt;/div&gt;

    &lt;div class=&quot;header&quot;&gt;
      &lt;div class=&quot;container&quot;&gt;
        &lt;div class=&quot;sixteen columns&quot;&gt;
          &lt;h1 class=&quot;remove-bottom&quot; style=&quot;margin-top: .5em;&quot;&gt;
          {{=response.title or request.application}}
          &lt;/h1&gt;
          &lt;h5&gt;{{=response.subtitle or &#x27;&#x27;}}&lt;/h5&gt;
        &lt;/div&gt;

        &lt;div class=&quot;sixteen columns&quot;&gt;
          &lt;div class=&quot;statusbar&quot;&gt;
            {{block statusbar}}
            &lt;span class=&quot;breadcrumbs&quot;&gt;{{=request.function}}&lt;/span&gt;
            {{end}}
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;

    &lt;div class=&quot;main&quot;&gt;
      &lt;div class=&quot;container&quot;&gt;
        {{if left_sidebar_enabled:}}
        &lt;div class=&quot;four columns left-sidebar&quot;&gt;
          {{block left_sidebar}}
          &lt;h3&gt;Left Sidebar&lt;/h3&gt;
          &lt;p&gt;&lt;/p&gt;
          {{end}}
        &lt;/div&gt;
        {{pass}}

        &lt;div class=&quot;{{=middle_columns}} columns center&quot;&gt;
          {{block center}}
          {{include}}
          {{end}}
        &lt;/div&gt;

        {{if right_sidebar_enabled:}}
        &lt;div class=&quot;four columns&quot;&gt;
          {{block right_sidebar}}
          &lt;h3&gt;Right Sidebar&lt;/h3&gt;
          &lt;p&gt;&lt;/p&gt;
          {{end}}
        &lt;/div&gt;
        {{pass}}

      &lt;/div&gt;&lt;!-- container --&gt;
    &lt;/div&gt;&lt;!-- main --&gt;

    &lt;div class=&quot;push&quot;&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;!-- wrapper --&gt;

  &lt;div class=&quot;footer&quot;&gt;
    &lt;div class=&quot;container header&quot;&gt;
      &lt;div class=&quot;sixteen columns&quot;&gt;
        {{block footer}} &lt;!-- this is default footer --&gt;
        &lt;div class=&quot;footer-content&quot; &gt;
          {{=T(&#x27;Copyright&#x27;)}} &amp;#169; 2011
          &lt;div style=&quot;float: right;&quot;&gt;
            &lt;a href=&quot;http://www.web2py.com/&quot;&gt;
            &lt;img style=&quot;padding-bottom: 0;&quot; 
                 src=&quot;{{=URL(&#x27;static&#x27;,&#x27;images/poweredby.png&#x27;)}}&quot;/&gt;
            &lt;/a&gt;
          &lt;/div&gt;
        &lt;/div&gt;
        {{end}}
      &lt;/div&gt;
    &lt;/div&gt;&lt;!-- container --&gt;
  &lt;/div&gt;&lt;!-- footer --&gt;

&lt;/body&gt;
&lt;/html&gt;

``:code

There are a few features of this default layout that make it very easy to use and customize:

- It is written in HTML5 and uses the &quot;modernizr&quot; ``modernizr``:cite library for backward compatibility. The actual layout include some extra conditional statements required by IE and they are omitted for brevity.
- It displays both ``response.title`` and ``response.subtitle`` which can be set in a model. If they are not set, it adopts the application name as title
- It includes the ``web2py_ajax.html`` file in the header which generated all the link and script import statements.
- It uses a modified version of &quot;skeleton&quot; ``skeleton``:cite a library for flexible layouts which works on mobile devices and re-arranges columns to fit small screened.
- It uses &quot;superfish.js&quot; for dynamic cascading menus. There is an explicit script to activate the superfish cascading menu and it can be removed if not necessary.
- The ``{{=auth.navbar(...)}}`` displays a welcome to the current user and links to auth functions like login, logout, register, change password, etc. depending on context. It is a helper factory and its output can be manipulated as any other helper. It is placed in a ``{{try:}}...{{except:pass}}`` in case auth is undefined.
- The ``{{=MENU(response.menu)`` displays the menu structure as ``&lt;ul&gt;...&lt;/ul&gt;``.
- ``{{include}}`` is replaced by the content of the extending view when the page is rendered.
- By default it uses a conditional three column (the left and right sidebars can be turned off by the extending views)
- It uses the following classes: header, main, footer
- It contains the following blocks: statusbar, left_sidebar, center, right_sidebar, footer.

Views can turn on and fill sidebars as follows:

``
{{left_sidebar_enable=True}}
{{extend &#x27;layout.html&#x27;}}

This text goes in center

{{block left_sidebar}}
This text goes in sidebar
{{end}}
``:code

#### Customizing the default layout

``CSS``:inxx

Customizing the default layout without editing is very easy because the CSS files are documented:

- &quot;bootstrap.min.css&quot; contains the Twitter Boostrap CSS style ``Bootstrap``:inxx
- &quot;web2py.css&quot; contains web2py specific styles

To change colors and background images, 
try append the following code to layout.html header:

``
&lt;style&gt;
body { background: url(&#x27;images/background.png&#x27;) repeat-x #3A3A3A; }
a { color: #349C01; }
.header h1 { color: #349C01; }
.header h2 { color: white; font-style: italic; font-size: 14px;}
.statusbar { background: #333333; border-bottom: 5px #349C01 solid; }
.statusbar a { color: white; }
.footer { border-top: 5px #349C01 solid; }
&lt;/style&gt;
``:code

Of course you can also completely replace the &quot;layout.html&quot; and &quot;web2py.css&quot; files with your own.

#### Mobile development

The default layout.html is designed to be friendly to mobile devices but that is not enough. One may need to use different views when a page is visited by a mobile device.

To make developing for desktop and mobile devices easier, web2py includes the ``@mobilize`` decorator. This decorator is applied to actions that should have a normal view and a mobile view. This is demonstrated here:

``
from gluon.contrib.user_agent_parser import mobilize 
@mobilize
def index():
   return dict()
``

Notice that the decorator must be imported before using it in a controller.
When the &quot;index&quot; function is called from a regular browser (desktop computer), web2py will render the returned dictionary using the view &quot;[controller]/index.html&quot;. However, when it is called by a mobile device, the dictionary will be rendered by &quot;[controller]/index.mobile.html&quot;. Notice that mobile views have the &quot;mobile.html&quot; extension.

Alternatively you can apply the following logic to make all views mobile friendly:

``
if request.user_agent().is_mobile:
    response.view.replace(&#x27;.html&#x27;,&#x27;.mobile.html&#x27;)
``

The task of creating the &quot;*.mobile.html&quot; views is left to the developer but we strongly suggest using the &quot;jQuery Mobile&quot; plugin which makes the task very easy.

### Functions in views

Consider this &quot;layout.html&quot;:

``
&lt;html&gt;
  &lt;body&gt;
    {{include}}
    &lt;div class=&quot;sidebar&quot;&gt;
      {{if &#x27;mysidebar&#x27; in globals():}}{{mysidebar()}}{{else:}}
        my default sidebar
      {{pass}}
    &lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;
``:code

and this extending view

``
{{def mysidebar():}}
my new sidebar!!!
{{return}}
{{extend &#x27;layout.html&#x27;}}
Hello World!!!
``:code

Notice the function is defined before the ``{{extend...}}`` statement -- this results in the function being created before the &quot;layout.html&quot; code is executed, so the function can be called anywhere within &quot;layout.html&quot;, even before the ``{{include}}``. Also notice the function is included in the extended view without the ``=`` prefix.

The code generates the following output:

``
&lt;html&gt;
  &lt;body&gt;
    Hello World!!!
    &lt;div class=&quot;sidebar&quot;&gt;
        my new sidebar!!!
    &lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;
``:code

Notice that the function is defined in HTML (although it could also contain Python code) so that ``response.write`` is used to write its content (the function does not return the content). This is why the layout calls the view function using ``{{mysidebar()}}`` rather than ``{{=mysidebar()}}``. Functions defined in this way can take arguments.

### Blocks in views
``block``:inxx

Another way to make a view more modular is by using ``{{block...}}s`` and this mechanism is an alternative to the mechanism discussed in the previous section.

Consider this &quot;layout.html&quot;:

``
&lt;html&gt;
  &lt;body&gt;
    {{include}}
    &lt;div class=&quot;sidebar&quot;&gt;
      {{block mysidebar}}
        my default sidebar
      {{end}}
    &lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;
``:code

and this extending view

``
{{extend &#x27;layout.html&#x27;}}
Hello World!!!
{{block mysidebar}}
my new sidebar!!!
{{end}}
``:code

It generates the following output:

``
&lt;html&gt;
  &lt;body&gt;
    Hello World!!!
    &lt;div class=&quot;sidebar&quot;&gt;
        my new sidebar!!!
    &lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;
``:code

You can have many blocks, and if a block is present in the extended view but not in the extending view, the content of the extended view is used. Also, notice that unlike with functions, it is not necessary to define blocks before the ``{{extend ...}}`` -- even if defined after the ``extend``, they can be used to make substitutions anywhere in the extended view.

``super``:inxx

Inside a block, you can use the expression ``{{super}}`` to include the content of the parent. For example, if we replace the above extending view with:

``
{{extend &#x27;layout.html&#x27;}}
Hello World!!!
{{block mysidebar}}
{{super}}
my new sidebar!!!
{{end}}
``:code

we get:

``
&lt;html&gt;
  &lt;body&gt;
    Hello World!!!
    &lt;div class=&quot;sidebar&quot;&gt;
        my default sidebar
        my new sidebar!!!
    &lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;
``:code

</pre></div>
</div>
<hr />

<ul><li><a href="https://github.com/mdipierro/web2py-book/commit/82dc64e7baa231edd3896ca7a0d41393e426f123">82dc64e</a><ul><li>Date : 2012-12-19</li><li>lots of small additions</li></ul></li></ul>
<div class="row-fluid" id="com_82dc64e7baa231edd3896ca7a0d41393e426f123">
    <div class="span6"><pre style="background-color: #DFF0D8;">web2py uses ``{{ ... }}`` to escape Python code embedded in HTML. The advantage of using curly brackets instead of angle brackets is that it&#x27;s transparent to all common HTML editors. This allows the developer to use those editors to create web2py views. These delimiters can be changed for example with

``
response.delimiters = (&#x27;&lt;?&#x27;,&#x27;?&gt;&#x27;)
``:code

If this line is in a model it will be applied everywhere, if in a controller only to views for the controller actions, if inside an action only to the view for that action.

Since the developer is embedding Python code into HTML, the document should be indented according to HTML rules, and not Python rules. Therefore, we allow unindented Python inside the ``{{ ... }}`` tags. Since Python normally uses indentation to delimit blocks of code, we need a different way to delimit them; this is why the web2py template language makes use of the Python keyword ``pass``.

-------
A code block starts with a line ending with a colon and ends with a line beginning with ``pass``. The keyword ``pass`` is not necessary when the end of the block is obvious from the context.
-------

Here is an example:

``
{{
if i == 0:
response.write(&#x27;i is 0&#x27;)
else:
response.write(&#x27;i is not 0&#x27;)
pass
}}
``:code

Note that ``pass`` is a Python keyword, not a web2py keyword. Some Python editors, such as Emacs, use the keyword ``pass`` to signify the division of blocks and use it to re-indent code automatically.

The web2py template language does exactly the same. When it finds something like:

``
&lt;html&gt;&lt;body&gt;
{{for x in range(10):}}{{=x}}hello&lt;br /&gt;{{pass}}
&lt;/body&gt;&lt;/html&gt;
``:code

it translates it into a program:
Sometimes you need to generate custom XML tags. web2py provides ``TAG``, a unive
{{=TAG.name(&#x27;a&#x27;, &#x27;b&#x27;, _c=&#x27;d&#x27;)}}
``:code

generates the following XML
``
&lt;name c=&quot;d&quot;&gt;ab&lt;/name&gt;
``:code

Arguments &quot;a&quot;, &quot;b&quot;, and &quot;d&quot; are automatically escaped; use the ``XML`` helper to suppress this behavior. Using ``TAG`` you can generate HTML/XML tags not already provided by the API. TAGs can be nested, and are serialized with ``str().``
An equivalent syntax is:
``
{{=TAG[&#x27;name&#x27;](&#x27;a&#x27;, &#x27;b&#x27;, c=&#x27;d&#x27;)}}
``:code

If the TAG object is created with an empty name, it can be used to concatenate multiple strings and HTML helpers together without inserting them into a surrounding tag, but this use is deprecated. Use the ``CAT`` helper instead.

Notice that ``TAG`` is an object, and ``TAG.name`` or ``TAG[&#x27;name&#x27;]`` is a function that returns a temporary helper class.

##### ``MENU``
``MENU``:inxx

The MENU helper takes a list of lists or of tuples of the form of ``response.menu`` (as described in Chapter 4) and generates a tree-like structure using unordered lists representing the menu. For example:
``
&gt;&gt;&gt; print MENU([[&#x27;One&#x27;, False, &#x27;link1&#x27;], [&#x27;Two&#x27;, False, &#x27;link2&#x27;]])
&lt;ul class=&quot;web2py-menu web2py-menu-vertical&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;link1&quot;&gt;One&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;link2&quot;&gt;Two&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
``:code

------
The third item in each list/tuple can be an HTML helper (which could include nested helpers), and the ``MENU`` helper will simply render that helper rather than creating its own ``&lt;a&gt;`` tag.
------

Each menu item can have a fourth argument that is a nested submenu (and so on recursively):
``
&gt;&gt;&gt; print MENU([[&#x27;One&#x27;, False, &#x27;link1&#x27;, [[&#x27;Two&#x27;, False, &#x27;link2&#x27;]]]])
&lt;ul class=&quot;web2py-menu web2py-menu-vertical&quot;&gt;
  &lt;li class=&quot;web2py-menu-expand&quot;&gt;
     &lt;a href=&quot;link1&quot;&gt;One&lt;/a&gt;
     &lt;ul class=&quot;web2py-menu-vertical&quot;&gt;
        &lt;li&gt;&lt;a href=&quot;link2&quot;&gt;Two&lt;/a&gt;&lt;/li&gt;
     &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;
``:code

A menu item can also have an optional 5th element, which is a boolean. When false, the menu item is ignored by the MENU helper.

The MENU helper takes the following optional arguments:
- ``_class``: defaults to &quot;web2py-menu web2py-menu-vertical&quot; and sets the class of the outer UL elements.
- ``ul_class``: defaults to &quot;web2py-menu-vertical&quot; and sets the class of the inner UL elements.
- ``li_class``: defaults to &quot;web2py-menu-expand&quot; and sets the class of the inner LI elements.

``mobile``:inxx

``MENU`` takes an optional argument ``mobile``. When set to ``True`` instead of building a recursive ``UL`` menu structure it returns a ``SELECT`` dropdown with all the menu options and a ``onchange`` attribute that redirects to the page corresponding to the selected option. This is designed an an alternative menu representation that increases usability on small mobile devices such as phones.

Normally the menu is used in a layout with the following syntax:

``
{{=MENU(response.menu, mobile=request.user_agent().is_mobile)}}
``

Using the jQuery syntax &quot;div#target&quot; it is possible to specify multiple search c
``:code

or equivalently
``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;a&#x27;, _id=&#x27;t1&#x27;), DIV(&#x27;b&#x27;, _class=&#x27;c2&#x27;))
&gt;&gt;&gt; d = a.elements(&#x27;span#t1&#x27;, &#x27;div.c2&#x27;)
``:code

If the value of an attribute is specified using a name argument, it can be a string or a regular expression:
``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;a&#x27;, _id=&#x27;test123&#x27;), DIV(&#x27;b&#x27;, _class=&#x27;c2&#x27;))
&gt;&gt;&gt; d = a.elements(&#x27;span&#x27;, _id=re.compile(&#x27;test\d{3}&#x27;)
``:code

A special named argument of the DIV (and derived) helpers is ``find``. It can be used to specify a search value or a search regular expression in the text content of the tag. For example:
``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;abcde&#x27;), DIV(&#x27;fghij&#x27;))
&gt;&gt;&gt; d = a.elements(find=&#x27;bcd&#x27;)
&gt;&gt;&gt; print d[0]
&lt;span&gt;abcde&lt;/span&gt;
``:code

or
``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;abcde&#x27;), DIV(&#x27;fghij&#x27;))
&gt;&gt;&gt; d = a.elements(find=re.compile(&#x27;fg\w{3}&#x27;))
&gt;&gt;&gt; print d[0]
&lt;div&gt;fghij&lt;/div&gt;
``:code

#### ``components`` ``components``:inxx
Here&#x27;s an example of listing all elements in an html string:
``
html = TAG(&#x27;&lt;a&gt;xxx&lt;/a&gt;&lt;b&gt;yyy&lt;/b&gt;&#x27;)
for item in html.components: print item
``:code

``parent``:inxx ``sibling``Linxx

#### ``parent`` and ``siblings``
``parent`` returns the parent of the current element.
``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;a&#x27;),DIV(&#x27;b&#x27;))
&gt;&gt;&gt; s = a.element(&#x27;span&#x27;)
&gt;&gt;&gt; d = s.parent
&gt;&gt;&gt; d[&#x27;_class&#x27;]=&#x27;abc&#x27;
&gt;&gt;&gt; print a
&lt;div class=&quot;abc&quot;&gt;&lt;span&gt;a&lt;/span&gt;&lt;div&gt;b&lt;/div&gt;&lt;/div&gt;
&gt;&gt;&gt; for e in s.siblings(): print e
&lt;div&gt;b&lt;/div&gt;
``:code

#### ``flatten`` ``flatten``:inxx
</pre></div>
    <div class="span6"><pre style="background-color: #F2DEDE;">web2py uses ``{{ ... }}`` to escape Python code embedded in HTML. The advantage of using curly brackets instead of angle brackets is that it&#x27;s transparent to all common HTML editors. This allows the developer to use those editors to create web2py views.

Since the developer is embedding Python code into HTML, the document should be indented according to HTML rules, and not Python rules. Therefore, we allow unindented Python inside the ``{{ ... }}`` tags. Since Python normally uses indentation to delimit blocks of code, we need a different way to delimit them; this is why the web2py template language makes use of the Python keyword ``pass``.

-------
A code block starts with a line ending with a colon and ends with a line beginning with ``pass``. The keyword ``pass`` is not necessary when the end of the block is obvious from the context.
-------

Here is an example:

``
{{
if i == 0:
response.write(&#x27;i is 0&#x27;)
else:
response.write(&#x27;i is not 0&#x27;)
pass
}}
``:code

Note that ``pass`` is a Python keyword, not a web2py keyword. Some Python editors, such as Emacs, use the keyword ``pass`` to signify the division of blocks and use it to re-indent code automatically.

The web2py template language does exactly the same. When it finds something like:

``
&lt;html&gt;&lt;body&gt;
{{for x in range(10):}}{{=x}}hello&lt;br /&gt;{{pass}}
&lt;/body&gt;&lt;/html&gt;
``:code

it translates it into a program:
Sometimes you need to generate custom XML tags. web2py provides ``TAG``, a unive
{{=TAG.name(&#x27;a&#x27;, &#x27;b&#x27;, _c=&#x27;d&#x27;)}}
``:code

generates the following XML
``
&lt;name c=&quot;d&quot;&gt;ab&lt;/name&gt;
``:code

Arguments &quot;a&quot;, &quot;b&quot;, and &quot;d&quot; are automatically escaped; use the ``XML`` helper to suppress this behavior. Using ``TAG`` you can generate HTML/XML tags not already provided by the API. TAGs can be nested, and are serialized with ``str().``
An equivalent syntax is:
``
{{=TAG[&#x27;name&#x27;](&#x27;a&#x27;, &#x27;b&#x27;, c=&#x27;d&#x27;)}}
``:code

If the TAG object is created with an empty name, it can be used to concatenate multiple strings and HTML helpers together without inserting them into a surrounding tag, but this use is deprecated. Use the ``CAT`` helper instead.

Notice that ``TAG`` is an object, and ``TAG.name`` or ``TAG[&#x27;name&#x27;]`` is a function that returns a temporary helper class.

##### ``MENU``
``MENU``:inxx

The MENU helper takes a list of lists or of tuples of the form of ``response.menu`` (as described in Chapter 4) and generates a tree-like structure using unordered lists representing the menu. For example:
``
&gt;&gt;&gt; print MENU([[&#x27;One&#x27;, False, &#x27;link1&#x27;], [&#x27;Two&#x27;, False, &#x27;link2&#x27;]])
&lt;ul class=&quot;web2py-menu web2py-menu-vertical&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;link1&quot;&gt;One&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;link2&quot;&gt;Two&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
``:code

Each menu item can have a fourth argument that is a nested submenu (and so on recursively):
``
&gt;&gt;&gt; print MENU([[&#x27;One&#x27;, False, &#x27;link1&#x27;, [[&#x27;Two&#x27;, False, &#x27;link2&#x27;]]]])
&lt;ul class=&quot;web2py-menu web2py-menu-vertical&quot;&gt;
  &lt;li class=&quot;web2py-menu-expand&quot;&gt;
     &lt;a href=&quot;link1&quot;&gt;One&lt;/a&gt;
     &lt;ul class=&quot;web2py-menu-vertical&quot;&gt;
        &lt;li&gt;&lt;a href=&quot;link2&quot;&gt;Two&lt;/a&gt;&lt;/li&gt;
     &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;
``:code

A menu item can also have an optional 5th element, which is a boolean. When false, the menu item is ignored by the MENU helper.

The MENU helper takes the following optional arguments:
- ``_class``: defaults to &quot;web2py-menu web2py-menu-vertical&quot; and sets the class of the outer UL elements.
- ``ul_class``: defaults to &quot;web2py-menu-vertical&quot; and sets the class of the inner UL elements.
- ``li_class``: defaults to &quot;web2py-menu-expand&quot; and sets the class of the inner LI elements.

``mobile``:inxx

``MENU`` takes an optional argument ``mobile``. When set to ``True`` instead of building a recursive ``UL`` menu structure it returns a ``SELECT`` dropdown with all the menu options and a ``onchange`` attribute that redirects to the page corresponding to the selected option. This is designed an an alternative menu representation that increases usability on small mobile devices such as phones.

Normally the menu is used in a layout with the following syntax:

``
{{=MENU(response.menu, mobile=request.user_agent().is_mobile)}}
``

Using the jQuery syntax &quot;div#target&quot; it is possible to specify multiple search c
``:code

or equivalently
``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;a&#x27;, _id=&#x27;t1&#x27;), DIV(&#x27;b&#x27;, _class=&#x27;c2&#x27;))
&gt;&gt;&gt; d = a.elements(&#x27;span#t1&#x27;, &#x27;div.c2&#x27;)
``:code

If the value of an attribute is specified using a name argument, it can be a string or a regular expression:
``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;a&#x27;, _id=&#x27;test123&#x27;), DIV(&#x27;b&#x27;, _class=&#x27;c2&#x27;))
&gt;&gt;&gt; d = a.elements(&#x27;span&#x27;, _id=re.compile(&#x27;test\d{3}&#x27;)
``:code

A special named argument of the DIV (and derived) helpers is ``find``. It can be used to specify a search value or a search regular expression in the text content of the tag. For example:
``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;abcde&#x27;), DIV(&#x27;fghij&#x27;))
&gt;&gt;&gt; d = a.elements(find=&#x27;bcd&#x27;)
&gt;&gt;&gt; print d[0]
&lt;span&gt;abcde&lt;/span&gt;
``:code

or
``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;abcde&#x27;), DIV(&#x27;fghij&#x27;))
&gt;&gt;&gt; d = a.elements(find=re.compile(&#x27;fg\w{3}&#x27;))
&gt;&gt;&gt; print d[0]
&lt;div&gt;fghij&lt;/div&gt;
``:code

#### ``components``
Here&#x27;s an example of listing all elements in an html string:
``
html = TAG(&#x27;&lt;a&gt;xxx&lt;/a&gt;&lt;b&gt;yyy&lt;/b&gt;&#x27;)
for item in html.components: print item
``:code

#### ``parent``
``parent`` returns the parent of the current element.
``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;a&#x27;),DIV(&#x27;b&#x27;))
&gt;&gt;&gt; d = a.element(&#x27;a&#x27;).parent()
&gt;&gt;&gt; d[&#x27;_class&#x27;]=&#x27;abc&#x27;
&gt;&gt;&gt; print a
&lt;div class=&quot;abc&quot;&gt;&lt;span&gt;a&lt;/span&gt;&lt;div&gt;b&lt;/div&gt;&lt;/div&gt;
``:code

#### ``flatten``
</pre></div>
</div>
<hr />

<ul><li><a href="https://github.com/mdipierro/web2py-book/commit/e234f6edf67361b3ba718ea10184ba8e7c2f773d">e234f6e</a><ul><li>Date : 2012-12-20</li><li>lots of improvements</li></ul></li></ul>
<div class="row-fluid" id="com_e234f6edf67361b3ba718ea10184ba8e7c2f773d">
    <div class="span6"><pre style="background-color: #DFF0D8;">Notice that halpers can be repeated using the multiplication operator:

``
&gt;&gt;&gt; print BR()*5
&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;
``:code

##### ``CAT`` (1.98.1 and up)
``CAT``:inxx

This helper concatenates other helpers, same as TAG[&#x27;&#x27;].
``
&gt;&gt;&gt; print CAT(&#x27;Here is a &#x27;, A(&#x27;link&#x27;,_href=URL()), &#x27;, and here is some &#x27;, B(&#x27;bold text&#x27;), &#x27;.&#x27;)
Here is a &lt;a href=&quot;/app/default/index&quot;&gt;link&lt;/a&gt;, and here is some &lt;b&gt;bold text&lt;/b&gt;.
``:code

##### ``CENTER``
``CENTER``:inxx

This helper centers its content.
``
&gt;&gt;&gt; print CENTER(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;),
&gt;&gt;&gt;              _class=&#x27;test&#x27;, _id=0)
&lt;center id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/center&gt;
``:code

##### ``CODE``
``CODE``:inxx

This helper performs syntax highlighting for Python, C, C++, HTML and web2py code, and is preferable to ``PRE`` for code listings. ``CODE`` also has the ability to create links to the web2py API documentation.

Here is an example of highlighting sections of Python code.
``
&gt;&gt;&gt; print CODE(&#x27;print &quot;hello&quot;&#x27;, language=&#x27;python&#x27;).xml()
&lt;table&gt;&lt;tr valign=&quot;top&quot;&gt;&lt;td style=&quot;width:40px; text-align: right;&quot;&gt;&lt;pre style=&quot;
        font-size: 11px;
        font-family: Bitstream Vera Sans Mono,monospace;
The MENU helper takes a list of lists or of tuples of the form of ``response.men
&gt;&gt;&gt; print MENU([[&#x27;One&#x27;, False, &#x27;link1&#x27;], [&#x27;Two&#x27;, False, &#x27;link2&#x27;]])
&lt;ul class=&quot;web2py-menu web2py-menu-vertical&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;link1&quot;&gt;One&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;link2&quot;&gt;Two&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
``:code

------
The third item in each list/tuple can be an HTML helper (which could include nested helpers), and the ``MENU`` helper will simply render that helper rather than creating its own ``&lt;a&gt;`` tag.
------

Each menu item can have a fourth argument that is a nested submenu (and so on recursively):
``
&gt;&gt;&gt; print MENU([[&#x27;One&#x27;, False, &#x27;link1&#x27;, [[&#x27;Two&#x27;, False, &#x27;link2&#x27;]]]])
&lt;ul class=&quot;web2py-menu web2py-menu-vertical&quot;&gt;
  &lt;li class=&quot;web2py-menu-expand&quot;&gt;
     &lt;a href=&quot;link1&quot;&gt;One&lt;/a&gt;
     &lt;ul class=&quot;web2py-menu-vertical&quot;&gt;
        &lt;li&gt;&lt;a href=&quot;link2&quot;&gt;Two&lt;/a&gt;&lt;/li&gt;
     &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;
``:code

A menu item can also have an optional 5th element, which is a boolean. When false, the menu item is ignored by the MENU helper.

The MENU helper takes the following optional arguments:
- ``_class``: defaults to &quot;web2py-menu web2py-menu-vertical&quot; and sets the class of the outer UL elements.
- ``ul_class``: defaults to &quot;web2py-menu-vertical&quot; and sets the class of the inner UL elements.
- ``li_class``: defaults to &quot;web2py-menu-expand&quot; and sets the class of the inner LI elements.
- ``li_first``: allows to add a class to the first list element.
- ``li_last``: allows to add a class to the last list element.

``mobile``:inxx

``MENU`` takes an optional argument ``mobile``. When set to ``True`` instead of building a recursive ``UL`` menu structure it returns a ``SELECT`` dropdown with all the menu options and a ``onchange`` attribute that redirects to the page corresponding to the selected option. This is designed an an alternative menu representation that increases usability on small mobile devices such as phones.

Normally the menu is used in a layout with the following syntax:

``
{{=MENU(response.menu, mobile=request.user_agent().is_mobile)}}
``

In this way a mobile device is automatically detected and the menu is rendered accordingly.

### ``BEAUTIFY``
``BEAUTIFY`` is used to build HTML representations of compound objects, including lists, tuples and dictionaries:
``
{{=BEAUTIFY({&quot;a&quot;: [&quot;hello&quot;, XML(&quot;world&quot;)], &quot;b&quot;: (1, 2)})}}
``:code
``BEAUTIFY`` returns an XML-like object serializable to XML, with a nice looking representation of its constructor argument. In this case, the XML representation of:
``
{&quot;a&quot;: [&quot;hello&quot;, XML(&quot;world&quot;)], &quot;b&quot;: (1, 2)}
``:code

will render as:
``
&lt;table&gt;
&lt;tr&gt;&lt;td&gt;a&lt;/td&gt;&lt;td&gt;:&lt;/td&gt;&lt;td&gt;hello&lt;br /&gt;world&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;b&lt;/td&gt;&lt;td&gt;:&lt;/td&gt;&lt;td&gt;1&lt;br /&gt;2&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;
``:code
A special named argument of the DIV (and derived) helpers is ``find``. It can be
or
``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;abcde&#x27;), DIV(&#x27;fghij&#x27;))
&gt;&gt;&gt; d = a.elements(find=re.compile(&#x27;fg\w{3}&#x27;))
&gt;&gt;&gt; print d[0]
&lt;div&gt;fghij&lt;/div&gt;
``:code

#### ``components`` ``components``:inxx
Here&#x27;s an example of listing all elements in an html string:
``
html = TAG(&#x27;&lt;a&gt;xxx&lt;/a&gt;&lt;b&gt;yyy&lt;/b&gt;&#x27;)
for item in html.components: print item
``:code

``parent``:inxx ``sibling``Linxx

#### ``parent`` and ``siblings``
``parent`` returns the parent of the current element.
``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;a&#x27;),DIV(&#x27;b&#x27;))
&gt;&gt;&gt; s = a.element(&#x27;span&#x27;)
&gt;&gt;&gt; d = s.parent
&gt;&gt;&gt; d[&#x27;_class&#x27;]=&#x27;abc&#x27;
&gt;&gt;&gt; print a
&lt;div class=&quot;abc&quot;&gt;&lt;span&gt;a&lt;/span&gt;&lt;div&gt;b&lt;/div&gt;&lt;/div&gt;
&gt;&gt;&gt; for e in s.siblings(): print e
&lt;div&gt;b&lt;/div&gt;
``:code

#### Replacing elements

Elements that are matched can also be replaced or removed by specifying           
the ``replace`` argument. Notice that a 
list of the original matching elements is still returned as usual. 

``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;x&#x27;), DIV(SPAN(&#x27;y&#x27;))
&gt;&gt;&gt; b = a.elements(&#x27;span&#x27;, replace=P(&#x27;z&#x27;)
&gt;&gt;&gt; print a                                                                       
&lt;div&gt;&lt;p&gt;z&lt;/p&gt;&lt;div&gt;&lt;p&gt;z&lt;/p&gt;&lt;/div&gt;  
``:code

``replace`` can be a callable. In this case it will be passed 
the original element and it is expected to return the replacement element:

``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;x&#x27;), DIV(SPAN(&#x27;y&#x27;))
&gt;&gt;&gt; b = a.elements(&#x27;span&#x27;, replace=lambda t: P(t[0])
&gt;&gt;&gt; print a                                                                       
&lt;div&gt;&lt;p&gt;x&lt;/p&gt;&lt;div&gt;&lt;p&gt;y&lt;/p&gt;&lt;/div&gt;  
``:code
                                                                                      
If ``replace=None``, matching elements will be removed completely.

``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;x&#x27;), DIV(SPAN(&#x27;y&#x27;))
&gt;&gt;&gt; b = a.elements(&#x27;span&#x27;, replace=None)
&gt;&gt;&gt; print a                                                                       
&lt;div&gt;&lt;/div&gt;  
``:code

#### ``flatten`` ``flatten``:inxx
</pre></div>
    <div class="span6"><pre style="background-color: #F2DEDE;">##### ``CAT`` (1.98.1 and up)
``CAT``:inxx

This helper concatenates other helpers, same as TAG[&#x27;&#x27;].
``
&gt;&gt;&gt; print CAT(&#x27;Here is a &#x27;, A(&#x27;link&#x27;,_href=URL()), &#x27;, and here is some &#x27;, B(&#x27;bold text&#x27;), &#x27;.&#x27;)
Here is a &lt;a href=&quot;/app/default/index&quot;&gt;link&lt;/a&gt;, and here is some &lt;b&gt;bold text&lt;/b&gt;.
``:code

##### ``CENTER``
``CENTER``:inxx

This helper centers its content.
``
&gt;&gt;&gt; print CENTER(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;),
&gt;&gt;&gt;              _class=&#x27;test&#x27;, _id=0)
&lt;center id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/center&gt;
``:code

##### ``CODE``
``CODE``:inxx

This helper performs syntax highlighting for Python, C, C++, HTML and web2py code, and is preferable to ``PRE`` for code listings. ``CODE`` also has the ability to create links to the web2py API documentation.

Here is an example of highlighting sections of Python code.
``
&gt;&gt;&gt; print CODE(&#x27;print &quot;hello&quot;&#x27;, language=&#x27;python&#x27;).xml()
&lt;table&gt;&lt;tr valign=&quot;top&quot;&gt;&lt;td style=&quot;width:40px; text-align: right;&quot;&gt;&lt;pre style=&quot;
        font-size: 11px;
        font-family: Bitstream Vera Sans Mono,monospace;
The MENU helper takes a list of lists or of tuples of the form of ``response.men
&gt;&gt;&gt; print MENU([[&#x27;One&#x27;, False, &#x27;link1&#x27;], [&#x27;Two&#x27;, False, &#x27;link2&#x27;]])
&lt;ul class=&quot;web2py-menu web2py-menu-vertical&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;link1&quot;&gt;One&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;link2&quot;&gt;Two&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
``:code

------
The third item in each list/tuple can be an HTML helper (which could include nested helpers), and the ``MENU`` helper will simply render that helper rather than creating its own ``&lt;a&gt;`` tag.
------

Each menu item can have a fourth argument that is a nested submenu (and so on recursively):
``
&gt;&gt;&gt; print MENU([[&#x27;One&#x27;, False, &#x27;link1&#x27;, [[&#x27;Two&#x27;, False, &#x27;link2&#x27;]]]])
&lt;ul class=&quot;web2py-menu web2py-menu-vertical&quot;&gt;
  &lt;li class=&quot;web2py-menu-expand&quot;&gt;
     &lt;a href=&quot;link1&quot;&gt;One&lt;/a&gt;
     &lt;ul class=&quot;web2py-menu-vertical&quot;&gt;
        &lt;li&gt;&lt;a href=&quot;link2&quot;&gt;Two&lt;/a&gt;&lt;/li&gt;
     &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;
``:code

A menu item can also have an optional 5th element, which is a boolean. When false, the menu item is ignored by the MENU helper.

The MENU helper takes the following optional arguments:
- ``_class``: defaults to &quot;web2py-menu web2py-menu-vertical&quot; and sets the class of the outer UL elements.
- ``ul_class``: defaults to &quot;web2py-menu-vertical&quot; and sets the class of the inner UL elements.
- ``li_class``: defaults to &quot;web2py-menu-expand&quot; and sets the class of the inner LI elements.

``mobile``:inxx

``MENU`` takes an optional argument ``mobile``. When set to ``True`` instead of building a recursive ``UL`` menu structure it returns a ``SELECT`` dropdown with all the menu options and a ``onchange`` attribute that redirects to the page corresponding to the selected option. This is designed an an alternative menu representation that increases usability on small mobile devices such as phones.

Normally the menu is used in a layout with the following syntax:

``
{{=MENU(response.menu, mobile=request.user_agent().is_mobile)}}
``

In this way a mobile device is automatically detected and the menu is rendered accordingly.

### ``BEAUTIFY``
``BEAUTIFY`` is used to build HTML representations of compound objects, including lists, tuples and dictionaries:
``
{{=BEAUTIFY({&quot;a&quot;: [&quot;hello&quot;, XML(&quot;world&quot;)], &quot;b&quot;: (1, 2)})}}
``:code
``BEAUTIFY`` returns an XML-like object serializable to XML, with a nice looking representation of its constructor argument. In this case, the XML representation of:
``
{&quot;a&quot;: [&quot;hello&quot;, XML(&quot;world&quot;)], &quot;b&quot;: (1, 2)}
``:code

will render as:
``
&lt;table&gt;
&lt;tr&gt;&lt;td&gt;a&lt;/td&gt;&lt;td&gt;:&lt;/td&gt;&lt;td&gt;hello&lt;br /&gt;world&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;b&lt;/td&gt;&lt;td&gt;:&lt;/td&gt;&lt;td&gt;1&lt;br /&gt;2&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;
``:code
A special named argument of the DIV (and derived) helpers is ``find``. It can be
or
``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;abcde&#x27;), DIV(&#x27;fghij&#x27;))
&gt;&gt;&gt; d = a.elements(find=re.compile(&#x27;fg\w{3}&#x27;))
&gt;&gt;&gt; print d[0]
&lt;div&gt;fghij&lt;/div&gt;
``:code

#### ``components`` ``components``:inxx
Here&#x27;s an example of listing all elements in an html string:
``
html = TAG(&#x27;&lt;a&gt;xxx&lt;/a&gt;&lt;b&gt;yyy&lt;/b&gt;&#x27;)
for item in html.components: print item
``:code

``parent``:inxx ``sibling``Linxx

#### ``parent`` and ``siblings``
``parent`` returns the parent of the current element.
``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;a&#x27;),DIV(&#x27;b&#x27;))
&gt;&gt;&gt; s = a.element(&#x27;span&#x27;)
&gt;&gt;&gt; d = s.parent
&gt;&gt;&gt; d[&#x27;_class&#x27;]=&#x27;abc&#x27;
&gt;&gt;&gt; print a
&lt;div class=&quot;abc&quot;&gt;&lt;span&gt;a&lt;/span&gt;&lt;div&gt;b&lt;/div&gt;&lt;/div&gt;
&gt;&gt;&gt; for e in s.siblings(): print e
&lt;div&gt;b&lt;/div&gt;
``:code

#### ``flatten`` ``flatten``:inxx
</pre></div>
</div>
<hr />

<ul><li><a href="https://github.com/mdipierro/web2py-book/commit/097d699dc16179206ccb7e4aee863d6523cd471c">097d699</a><ul><li>Date : 2012-12-27</li><li>fixed typo, thanks Andrew</li></ul></li></ul>
<div class="row-fluid" id="com_097d699dc16179206ccb7e4aee863d6523cd471c">
    <div class="span6"><pre style="background-color: #DFF0D8;">``parent``:inxx ``sibling``:inxx

#### ``parent`` and ``siblings``
``parent`` returns the parent of the current element.
``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;a&#x27;),DIV(&#x27;b&#x27;))
&gt;&gt;&gt; s = a.element(&#x27;span&#x27;)
&gt;&gt;&gt; d = s.parent
&gt;&gt;&gt; d[&#x27;_class&#x27;]=&#x27;abc&#x27;
&gt;&gt;&gt; print a
&lt;div class=&quot;abc&quot;&gt;&lt;span&gt;a&lt;/span&gt;&lt;div&gt;b&lt;/div&gt;&lt;/div&gt;
&gt;&gt;&gt; for e in s.siblings(): print e
&lt;div&gt;b&lt;/div&gt;
``:code

#### Replacing elements

Elements that are matched can also be replaced or removed by specifying
the ``replace`` argument. Notice that a
list of the original matching elements is still returned as usual.

``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;x&#x27;), DIV(SPAN(&#x27;y&#x27;))
&gt;&gt;&gt; b = a.elements(&#x27;span&#x27;, replace=P(&#x27;z&#x27;)
&gt;&gt;&gt; print a
&lt;div&gt;&lt;p&gt;z&lt;/p&gt;&lt;div&gt;&lt;p&gt;z&lt;/p&gt;&lt;/div&gt;
``:code

``replace`` can be a callable. In this case it will be passed
the original element and it is expected to return the replacement element:

``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;x&#x27;), DIV(SPAN(&#x27;y&#x27;))
&gt;&gt;&gt; b = a.elements(&#x27;span&#x27;, replace=lambda t: P(t[0])
&gt;&gt;&gt; print a
&lt;div&gt;&lt;p&gt;x&lt;/p&gt;&lt;div&gt;&lt;p&gt;y&lt;/p&gt;&lt;/div&gt;
``:code

If ``replace=None``, matching elements will be removed completely.

``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;x&#x27;), DIV(SPAN(&#x27;y&#x27;))
&gt;&gt;&gt; b = a.elements(&#x27;span&#x27;, replace=None)
&gt;&gt;&gt; print a
&lt;div&gt;&lt;/div&gt;
``:code

#### ``flatten`` ``flatten``:inxx

The flatten method recursively serializes the content of the children of a given element into regular text (without tags):
``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;this&#x27;, DIV(&#x27;is&#x27;, B(&#x27;a&#x27;))), SPAN(&#x27;test&#x27;))
&gt;&gt;&gt; print a.flatten()
thisisatest
``:code

Flatten can be passed an optional argument, ``render``, i.e. a function that renders/flattens the content using a different protocol. Here is an example to serialize some tags into Markmin wiki syntax:
``
&gt;&gt;&gt; a = DIV(H1(&#x27;title&#x27;), P(&#x27;example of a &#x27;, A(&#x27;link&#x27;, _href=&#x27;#test&#x27;)))
&gt;&gt;&gt; from gluon.html import markmin_serializer
&gt;&gt;&gt; print a.flatten(render=markmin_serializer)
## titles

example of [[a link #test]]
``:code

At the time of writing we provide ``markmin_serializer`` and ``markdown_serializer``.

#### Parsing

The TAG object is also an XML/HTML parser. It can read text and convert into a tree structure of helpers. This allows manipulation using the API above:
``
&gt;&gt;&gt; html = &#x27;&lt;h1&gt;Title&lt;/h1&gt;&lt;p&gt;this is a &lt;span&gt;test&lt;/span&gt;&lt;/p&gt;&#x27;
&gt;&gt;&gt; parsed_html = TAG(html)
&gt;&gt;&gt; parsed_html.element(&#x27;span&#x27;)[0]=&#x27;TEST&#x27;
response.menu = [(&#x27;Google&#x27;, False, &#x27;http://www.google.com&#x27;,[]),
                 (&#x27;Index&#x27;,  True,  URL(&#x27;index&#x27;), [])]
``:code

``sub-menu``:inxx
The fourth tuple element is an optional sub-menu.

``response.files`` is a list of CSS and JS files that are needed by your page.

We also recommend that you use:

``
{{include &#x27;web2py_ajax.html&#x27;}}
``:code

in the HTML head, since this will include the jQuery libraries and define some backward-compatible JavaScript functions for special effects and Ajax. &quot;web2py_ajax.html&quot; includes the ``response.meta`` tags in the view, jQuery base, the calendar datepicker, and all required CSS and JS ``response.files``.

#### Default page layout

``Twitter Bootstrap``:inxx

The &quot;views/layout.html&quot; that ships with the web2py scaffolding application **welcome** (stripped down of some optional parts) is quite complex but it has the following structure:

``
&lt;!DOCTYPE html&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot; /&gt;
  &lt;title&gt;{{=response.title or request.application}}&lt;/title&gt;
  ...
  &lt;script src=&quot;{{=URL(&#x27;static&#x27;,&#x27;js/modernizr.custom.js&#x27;)}}&quot;&gt;&lt;/script&gt;

  {{
  response.files.append(URL(&#x27;static&#x27;,&#x27;css/web2py.css&#x27;))
  response.files.append(URL(&#x27;static&#x27;,&#x27;css/bootstrap.min.css&#x27;))
  response.files.append(URL(&#x27;static&#x27;,&#x27;css/bootstrap-responsive.min.css&#x27;))
  response.files.append(URL(&#x27;static&#x27;,&#x27;css/web2py_bootstrap.css&#x27;))
  }}

  {{include &#x27;web2py_ajax.html&#x27;}}

  {{
  # using sidebars need to know what sidebar you want to use
  left_sidebar_enabled = globals().get(&#x27;left_sidebar_enabled&#x27;,False)
  right_sidebar_enabled = globals().get(&#x27;right_sidebar_enabled&#x27;,False)
  middle_columns = {0:&#x27;span12&#x27;,1:&#x27;span9&#x27;,2:&#x27;span6&#x27;}[
    (left_sidebar_enabled and 1 or 0)+(right_sidebar_enabled and 1 or 0)]
  }}

  {{block head}}{{end}}
&lt;/head&gt;

&lt;body&gt;
  &lt;!-- Navbar ================================================== --&gt;
  &lt;div class=&quot;navbar navbar-inverse navbar-fixed-top&quot;&gt;
    &lt;div class=&quot;flash&quot;&gt;{{=response.flash or &#x27;&#x27;}}&lt;/div&gt;
    &lt;div class=&quot;navbar-inner&quot;&gt;
      &lt;div class=&quot;container&quot;&gt;
        {{=response.logo or &#x27;&#x27;}}
        &lt;ul id=&quot;navbar&quot; class=&quot;nav pull-right&quot;&gt;
          {{=&#x27;auth&#x27; in globals() and auth.navbar(mode=&quot;dropdown&quot;) or &#x27;&#x27;}}
        &lt;/ul&gt;
        &lt;div class=&quot;nav-collapse&quot;&gt;
          {{if response.menu:}}
          {{=MENU(response.menu)}}
          {{pass}}
        &lt;/div&gt;&lt;!--/.nav-collapse --&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;&lt;!--/top navbar --&gt;

  &lt;div class=&quot;container&quot;&gt;
    &lt;!-- Masthead ================================================== --&gt;
    &lt;header class=&quot;mastheader row&quot; id=&quot;header&quot;&gt;
        &lt;div class=&quot;span12&quot;&gt;
            &lt;div class=&quot;page-header&quot;&gt;
                &lt;h1&gt;
                    {{=response.title or request.application}}
                    &lt;small&gt;{{=response.subtitle or &#x27;&#x27;}}&lt;/small&gt;
                &lt;/h1&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/header&gt;

    &lt;section id=&quot;main&quot; class=&quot;main row&quot;&gt;
        {{if left_sidebar_enabled:}}
        &lt;div class=&quot;span3 left-sidebar&quot;&gt;
            {{block left_sidebar}}
            &lt;h3&gt;Left Sidebar&lt;/h3&gt;
            &lt;p&gt;&lt;/p&gt;
            {{end}}
        &lt;/div&gt;
        {{pass}}

        &lt;div class=&quot;{{=middle_columns}}&quot;&gt;
            {{block center}}
            {{include}}
            {{end}}
        &lt;/div&gt;

        {{if right_sidebar_enabled:}}
        &lt;div class=&quot;span3&quot;&gt;
            {{block right_sidebar}}
            &lt;h3&gt;Right Sidebar&lt;/h3&gt;
            &lt;p&gt;&lt;/p&gt;
            {{end}}
        &lt;/div&gt;
        {{pass}}
    &lt;/section&gt;&lt;!--/main--&gt;

    &lt;!-- Footer ================================================== --&gt;
    &lt;div class=&quot;row&quot;&gt;
        &lt;footer class=&quot;footer span12&quot; id=&quot;footer&quot;&gt;
            &lt;div class=&quot;footer-content&quot;&gt;
                {{block footer}} &lt;!-- this is default footer --&gt;
                ...
                {{end}}
            &lt;/div&gt;
        &lt;/footer&gt;
    &lt;/div&gt;

  &lt;/div&gt; &lt;!-- /container --&gt;

  &lt;!-- The javascript =============================================
       (Placed at the end of the document so the pages load faster) --&gt;
  &lt;script src=&quot;{{=URL(&#x27;static&#x27;,&#x27;js/bootstrap.min.js&#x27;)}}&quot;&gt;&lt;/script&gt;
  &lt;script src=&quot;{{=URL(&#x27;static&#x27;,&#x27;js/web2py_bootstrap.js&#x27;)}}&quot;&gt;&lt;/script&gt;
  {{if response.google_analytics_id:}}
    &lt;script src=&quot;{{=URL(&#x27;static&#x27;,&#x27;js/analytics.js&#x27;)}}&quot;&gt;&lt;/script&gt;
    &lt;script type=&quot;text/javascript&quot;&gt;
    analytics.initialize({
      &#x27;Google Analytics&#x27;:{trackingId:&#x27;{{=response.google_analytics_id}}&#x27;}
    });&lt;/script&gt;
  {{pass}}
&lt;/body&gt;
&lt;/html&gt;
``:code

There are a few features of this default layout that make it very easy to use and customize:

- It is written in HTML5 and uses the &quot;modernizr&quot; ``modernizr``:cite library for backward compatibility. The actual layout include some extra conditional statements required by IE and they are omitted for brevity.
- It displays both ``response.title`` and ``response.subtitle`` which can be set in a model. If they are not set, it adopts the application name as title
- It includes the ``web2py_ajax.html`` file in the header which generated all the link and script import statements.
- It uses a modified version of Twitter Boostrap for flexible layouts which works on mobile devices and re-arranges columns to fit small screens.
- It uses &quot;analytics.js&quot; to connect to Google Analytics.
- The ``{{=auth.navbar(...)}}`` displays a welcome to the current user and links to auth functions like login, logout, register, change password, etc. depending on context. It is a helper factory and its output can be manipulated as any other helper. It is placed in a ``{{try:}}...{{except:pass}}`` in case auth is undefined.
- The ``{{=MENU(response.menu)`` displays the menu structure as ``&lt;ul&gt;...&lt;/ul&gt;``.
- ``{{include}}`` is replaced by the content of the extending view when the page is rendered.
- By default it uses a conditional three column (the left and right sidebars can be turned off by the extending views)
- It uses the following classes: header, main, footer
- It contains the following blocks: statusbar, left_sidebar, center, right_sidebar, footer.

In views can turn on and fill sidebars as follows:

``
{{left_sidebar_enable=True}}
{{extend &#x27;layout.html&#x27;}}

This text goes in center

{{block left_sidebar}}
This text goes in sidebar
It generates the following output:
``:code

You can have many blocks, and if a block is present in the extended view but not in the extending view, the content of the extended view is used. Also, notice that unlike with functions, it is not necessary to define blocks before the ``{{extend ...}}`` -- even if defined after the ``extend``, they can be used to make substitutions anywhere in the extended view.

``super``:inxx

Inside a block, you can use the expression ``{{super}}`` to include the content of the parent. For example, if we replace the above extending view with:

``
{{extend &#x27;layout.html&#x27;}}
Hello World!!!
{{block mysidebar}}
{{super}}
my new sidebar!!!
{{end}}
``:code

we get:

``
&lt;html&gt;
  &lt;body&gt;
    Hello World!!!
    &lt;div class=&quot;sidebar&quot;&gt;
        my default sidebar
        my new sidebar!!!
    &lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;
``:code
</pre></div>
    <div class="span6"><pre style="background-color: #F2DEDE;">``parent``:inxx ``sibling``Linxx

#### ``parent`` and ``siblings``
``parent`` returns the parent of the current element.
``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;a&#x27;),DIV(&#x27;b&#x27;))
&gt;&gt;&gt; s = a.element(&#x27;span&#x27;)
&gt;&gt;&gt; d = s.parent
&gt;&gt;&gt; d[&#x27;_class&#x27;]=&#x27;abc&#x27;
&gt;&gt;&gt; print a
&lt;div class=&quot;abc&quot;&gt;&lt;span&gt;a&lt;/span&gt;&lt;div&gt;b&lt;/div&gt;&lt;/div&gt;
&gt;&gt;&gt; for e in s.siblings(): print e
&lt;div&gt;b&lt;/div&gt;
``:code

#### Replacing elements

Elements that are matched can also be replaced or removed by specifying           
the ``replace`` argument. Notice that a 
list of the original matching elements is still returned as usual. 

``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;x&#x27;), DIV(SPAN(&#x27;y&#x27;))
&gt;&gt;&gt; b = a.elements(&#x27;span&#x27;, replace=P(&#x27;z&#x27;)
&gt;&gt;&gt; print a                                                                       
&lt;div&gt;&lt;p&gt;z&lt;/p&gt;&lt;div&gt;&lt;p&gt;z&lt;/p&gt;&lt;/div&gt;  
``:code

``replace`` can be a callable. In this case it will be passed 
the original element and it is expected to return the replacement element:

``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;x&#x27;), DIV(SPAN(&#x27;y&#x27;))
&gt;&gt;&gt; b = a.elements(&#x27;span&#x27;, replace=lambda t: P(t[0])
&gt;&gt;&gt; print a                                                                       
&lt;div&gt;&lt;p&gt;x&lt;/p&gt;&lt;div&gt;&lt;p&gt;y&lt;/p&gt;&lt;/div&gt;  
``:code
                                                                                      
If ``replace=None``, matching elements will be removed completely.

``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;x&#x27;), DIV(SPAN(&#x27;y&#x27;))
&gt;&gt;&gt; b = a.elements(&#x27;span&#x27;, replace=None)
&gt;&gt;&gt; print a                                                                       
&lt;div&gt;&lt;/div&gt;  
``:code

#### ``flatten`` ``flatten``:inxx

The flatten method recursively serializes the content of the children of a given element into regular text (without tags):
``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;this&#x27;, DIV(&#x27;is&#x27;, B(&#x27;a&#x27;))), SPAN(&#x27;test&#x27;))
&gt;&gt;&gt; print a.flatten()
thisisatest
``:code

Flatten can be passed an optional argument, ``render``, i.e. a function that renders/flattens the content using a different protocol. Here is an example to serialize some tags into Markmin wiki syntax:
``
&gt;&gt;&gt; a = DIV(H1(&#x27;title&#x27;), P(&#x27;example of a &#x27;, A(&#x27;link&#x27;, _href=&#x27;#test&#x27;)))
&gt;&gt;&gt; from gluon.html import markmin_serializer
&gt;&gt;&gt; print a.flatten(render=markmin_serializer)
## titles

example of [[a link #test]]
``:code

At the time of writing we provide ``markmin_serializer`` and ``markdown_serializer``.

#### Parsing

The TAG object is also an XML/HTML parser. It can read text and convert into a tree structure of helpers. This allows manipulation using the API above:
``
&gt;&gt;&gt; html = &#x27;&lt;h1&gt;Title&lt;/h1&gt;&lt;p&gt;this is a &lt;span&gt;test&lt;/span&gt;&lt;/p&gt;&#x27;
&gt;&gt;&gt; parsed_html = TAG(html)
&gt;&gt;&gt; parsed_html.element(&#x27;span&#x27;)[0]=&#x27;TEST&#x27;
response.menu = [(&#x27;Google&#x27;, False, &#x27;http://www.google.com&#x27;,[]),
                 (&#x27;Index&#x27;,  True,  URL(&#x27;index&#x27;), [])]
``:code

``sub-menu``:inxx
The fourth tuple element is an optional sub-menu.

``response.files`` is a list of CSS and JS files that are needed by your page.

We also recommend that you use:

``
{{include &#x27;web2py_ajax.html&#x27;}}
``:code

in the HTML head, since this will include the jQuery libraries and define some backward-compatible JavaScript functions for special effects and Ajax. &quot;web2py_ajax.html&quot; includes the ``response.meta`` tags in the view, jQuery base, the calendar datepicker, and all required CSS and JS ``response.files``.

#### Default page layout

``Twitter Bootstrap``:inxx

The &quot;views/layout.html&quot; that ships with the web2py scaffolding application **welcome** (stripped down of some optional parts) is quite complex but it has the following structure:

``
&lt;!DOCTYPE html&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot; /&gt;
  &lt;title&gt;{{=response.title or request.application}}&lt;/title&gt;
  ...
  &lt;script src=&quot;{{=URL(&#x27;static&#x27;,&#x27;js/modernizr.custom.js&#x27;)}}&quot;&gt;&lt;/script&gt;

  {{  
  response.files.append(URL(&#x27;static&#x27;,&#x27;css/web2py.css&#x27;))
  response.files.append(URL(&#x27;static&#x27;,&#x27;css/bootstrap.min.css&#x27;))
  response.files.append(URL(&#x27;static&#x27;,&#x27;css/bootstrap-responsive.min.css&#x27;))
  response.files.append(URL(&#x27;static&#x27;,&#x27;css/web2py_bootstrap.css&#x27;))
  }}

  {{include &#x27;web2py_ajax.html&#x27;}}

  {{
  # using sidebars need to know what sidebar you want to use
  left_sidebar_enabled = globals().get(&#x27;left_sidebar_enabled&#x27;,False)
  right_sidebar_enabled = globals().get(&#x27;right_sidebar_enabled&#x27;,False)
  middle_columns = {0:&#x27;span12&#x27;,1:&#x27;span9&#x27;,2:&#x27;span6&#x27;}[
    (left_sidebar_enabled and 1 or 0)+(right_sidebar_enabled and 1 or 0)]
  }}

  {{block head}}{{end}}
&lt;/head&gt;

&lt;body&gt;
  &lt;!-- Navbar ================================================== --&gt;
  &lt;div class=&quot;navbar navbar-inverse navbar-fixed-top&quot;&gt;
    &lt;div class=&quot;flash&quot;&gt;{{=response.flash or &#x27;&#x27;}}&lt;/div&gt;
    &lt;div class=&quot;navbar-inner&quot;&gt;
      &lt;div class=&quot;container&quot;&gt;
	{{=response.logo or &#x27;&#x27;}}
        &lt;ul id=&quot;navbar&quot; class=&quot;nav pull-right&quot;&gt;
          {{=&#x27;auth&#x27; in globals() and auth.navbar(mode=&quot;dropdown&quot;) or &#x27;&#x27;}}
        &lt;/ul&gt;
        &lt;div class=&quot;nav-collapse&quot;&gt;
          {{if response.menu:}}
          {{=MENU(response.menu)}}
          {{pass}}
        &lt;/div&gt;&lt;!--/.nav-collapse --&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;&lt;!--/top navbar --&gt;

  &lt;div class=&quot;container&quot;&gt;
    &lt;!-- Masthead ================================================== --&gt;
    &lt;header class=&quot;mastheader row&quot; id=&quot;header&quot;&gt;
        &lt;div class=&quot;span12&quot;&gt;
            &lt;div class=&quot;page-header&quot;&gt;
                &lt;h1&gt;
                    {{=response.title or request.application}}
                    &lt;small&gt;{{=response.subtitle or &#x27;&#x27;}}&lt;/small&gt;
                &lt;/h1&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/header&gt;

    &lt;section id=&quot;main&quot; class=&quot;main row&quot;&gt;
        {{if left_sidebar_enabled:}}
        &lt;div class=&quot;span3 left-sidebar&quot;&gt;
            {{block left_sidebar}}
            &lt;h3&gt;Left Sidebar&lt;/h3&gt;
            &lt;p&gt;&lt;/p&gt;
            {{end}}
        &lt;/div&gt;
        {{pass}}

        &lt;div class=&quot;{{=middle_columns}}&quot;&gt;
            {{block center}}
            {{include}}
            {{end}}
        &lt;/div&gt;

        {{if right_sidebar_enabled:}}
        &lt;div class=&quot;span3&quot;&gt;
            {{block right_sidebar}}
            &lt;h3&gt;Right Sidebar&lt;/h3&gt;
            &lt;p&gt;&lt;/p&gt;
            {{end}}
        &lt;/div&gt;
        {{pass}}
    &lt;/section&gt;&lt;!--/main--&gt;

    &lt;!-- Footer ================================================== --&gt;
    &lt;div class=&quot;row&quot;&gt;
        &lt;footer class=&quot;footer span12&quot; id=&quot;footer&quot;&gt;
            &lt;div class=&quot;footer-content&quot;&gt;
                {{block footer}} &lt;!-- this is default footer --&gt;
		...
                {{end}}
            &lt;/div&gt;
        &lt;/footer&gt;
    &lt;/div&gt;

  &lt;/div&gt; &lt;!-- /container --&gt;

  &lt;!-- The javascript =============================================
       (Placed at the end of the document so the pages load faster) --&gt;
  &lt;script src=&quot;{{=URL(&#x27;static&#x27;,&#x27;js/bootstrap.min.js&#x27;)}}&quot;&gt;&lt;/script&gt;
  &lt;script src=&quot;{{=URL(&#x27;static&#x27;,&#x27;js/web2py_bootstrap.js&#x27;)}}&quot;&gt;&lt;/script&gt;
  {{if response.google_analytics_id:}}
    &lt;script src=&quot;{{=URL(&#x27;static&#x27;,&#x27;js/analytics.js&#x27;)}}&quot;&gt;&lt;/script&gt;
    &lt;script type=&quot;text/javascript&quot;&gt;
    analytics.initialize({
      &#x27;Google Analytics&#x27;:{trackingId:&#x27;{{=response.google_analytics_id}}&#x27;} 
    });&lt;/script&gt;
  {{pass}}
&lt;/body&gt;
&lt;/html&gt;
``:code

There are a few features of this default layout that make it very easy to use and customize:

- It is written in HTML5 and uses the &quot;modernizr&quot; ``modernizr``:cite library for backward compatibility. The actual layout include some extra conditional statements required by IE and they are omitted for brevity.
- It displays both ``response.title`` and ``response.subtitle`` which can be set in a model. If they are not set, it adopts the application name as title
- It includes the ``web2py_ajax.html`` file in the header which generated all the link and script import statements.
- It uses a modified version of Twitter Boostrap for flexible layouts which works on mobile devices and re-arranges columns to fit small screens.
- It uses &quot;analytics.js&quot; to connect to Google Analytics.
- The ``{{=auth.navbar(...)}}`` displays a welcome to the current user and links to auth functions like login, logout, register, change password, etc. depending on context. It is a helper factory and its output can be manipulated as any other helper. It is placed in a ``{{try:}}...{{except:pass}}`` in case auth is undefined.
- The ``{{=MENU(response.menu)`` displays the menu structure as ``&lt;ul&gt;...&lt;/ul&gt;``.
- ``{{include}}`` is replaced by the content of the extending view when the page is rendered.
- By default it uses a conditional three column (the left and right sidebars can be turned off by the extending views)
- It uses the following classes: header, main, footer
- It contains the following blocks: statusbar, left_sidebar, center, right_sidebar, footer.

In views can turn on and fill sidebars as follows:

``
{{left_sidebar_enable=True}}
{{extend &#x27;layout.html&#x27;}}

This text goes in center

{{block left_sidebar}}
This text goes in sidebar
It generates the following output:
``:code

You can have many blocks, and if a block is present in the extended view but not in the extending view, the content of the extended view is used. Also, notice that unlike with functions, it is not necessary to define blocks before the ``{{extend ...}}`` -- even if defined after the ``extend``, they can be used to make substitutions anywhere in the extended view.

``super``:inxx

Inside a block, you can use the expression ``{{super}}`` to include the content of the parent. For example, if we replace the above extending view with:

``
{{extend &#x27;layout.html&#x27;}}
Hello World!!!
{{block mysidebar}}
{{super}}
my new sidebar!!!
{{end}}
``:code

we get:

``
&lt;html&gt;
  &lt;body&gt;
    Hello World!!!
    &lt;div class=&quot;sidebar&quot;&gt;
        my default sidebar
        my new sidebar!!!
    &lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;
``:code

</pre></div>
</div>
<hr />

<ul><li><a href="https://github.com/mdipierro/web2py-book/commit/d70086e374f3d93371823e3a509dd0167961b34c">d70086e</a><ul><li>Date : 2012-10-13</li><li>sessions in red and compress static files</li></ul></li></ul>
<div class="row-fluid" id="com_d70086e374f3d93371823e3a509dd0167961b34c">
    <div class="span6"><pre style="background-color: #DFF0D8;">Notice that the decorator must be imported before using it in a controller.
When the &quot;index&quot; function is called from a regular browser (desktop computer), web2py will render the returned dictionary using the view &quot;[controller]/index.html&quot;. However, when it is called by a mobile device, the dictionary will be rendered by &quot;[controller]/index.mobile.html&quot;. Notice that mobile views have the &quot;mobile.html&quot; extension.
</pre></div>
    <div class="span6"><pre style="background-color: #F2DEDE;">Notice that the decorator must be important once before using it in a controller.
When the &quot;index&quot; function is called from a regular browser (desktop computer), web2py will render the returned dictionary using the view &quot;[controller]/index.html&quot;. However, when it is called by a mobile device, the dictionary will be rendered by &quot;[controller]/index.mobile.html&quot;. Notice that mobile views have the &quot;mobile.html&quot; extension.
</pre></div>
</div>
<hr />

<ul><li><a href="https://github.com/mdipierro/web2py-book/commit/76c0363755694c36971ffc9db176312fe5c14276">76c0363</a><ul><li>Date : 2012-12-22</li><li>more and more additions and corrections</li></ul></li></ul>
<div class="row-fluid" id="com_76c0363755694c36971ffc9db176312fe5c14276">
    <div class="span6"><pre style="background-color: #DFF0D8;">#### Default page layout

``Twitter Bootstrap``:inxx

The &quot;views/layout.html&quot; that ships with the web2py scaffolding application **welcome** (stripped down of some optional parts) is quote complex but is has the following structure:

``
&lt;!DOCTYPE html&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot; /&gt;
  &lt;title&gt;{{=response.title or request.application}}&lt;/title&gt;
  ...
  &lt;script src=&quot;{{=URL(&#x27;static&#x27;,&#x27;js/modernizr.custom.js&#x27;)}}&quot;&gt;&lt;/script&gt;

  {{  
  response.files.append(URL(&#x27;static&#x27;,&#x27;css/web2py.css&#x27;))
  response.files.append(URL(&#x27;static&#x27;,&#x27;css/bootstrap.min.css&#x27;))
  response.files.append(URL(&#x27;static&#x27;,&#x27;css/bootstrap-responsive.min.css&#x27;))
  response.files.append(URL(&#x27;static&#x27;,&#x27;css/web2py_bootstrap.css&#x27;))
  }}

  {{include &#x27;web2py_ajax.html&#x27;}}

  {{
  # using sidebars need to know what sidebar you want to use
  left_sidebar_enabled = globals().get(&#x27;left_sidebar_enabled&#x27;,False)
  right_sidebar_enabled = globals().get(&#x27;right_sidebar_enabled&#x27;,False)
  middle_columns = {0:&#x27;span12&#x27;,1:&#x27;span9&#x27;,2:&#x27;span6&#x27;}[
    (left_sidebar_enabled and 1 or 0)+(right_sidebar_enabled and 1 or 0)]
  }}

  {{block head}}{{end}}
&lt;/head&gt;

&lt;body&gt;
  &lt;!-- Navbar ================================================== --&gt;
  &lt;div class=&quot;navbar navbar-inverse navbar-fixed-top&quot;&gt;
    &lt;div class=&quot;flash&quot;&gt;{{=response.flash or &#x27;&#x27;}}&lt;/div&gt;
    &lt;div class=&quot;navbar-inner&quot;&gt;
      &lt;div class=&quot;container&quot;&gt;
	{{=response.logo or &#x27;&#x27;}}
        &lt;ul id=&quot;navbar&quot; class=&quot;nav pull-right&quot;&gt;
          {{=&#x27;auth&#x27; in globals() and auth.navbar(mode=&quot;dropdown&quot;) or &#x27;&#x27;}}
        &lt;/ul&gt;
        &lt;div class=&quot;nav-collapse&quot;&gt;
          {{if response.menu:}}
          {{=MENU(response.menu)}}
          {{pass}}
        &lt;/div&gt;&lt;!--/.nav-collapse --&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;&lt;!--/top navbar --&gt;

  &lt;div class=&quot;container&quot;&gt;
    &lt;!-- Masthead ================================================== --&gt;
    &lt;header class=&quot;mastheader row&quot; id=&quot;header&quot;&gt;
        &lt;div class=&quot;span12&quot;&gt;
            &lt;div class=&quot;page-header&quot;&gt;
                &lt;h1&gt;
                    {{=response.title or request.application}}
                    &lt;small&gt;{{=response.subtitle or &#x27;&#x27;}}&lt;/small&gt;
                &lt;/h1&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/header&gt;

    &lt;section id=&quot;main&quot; class=&quot;main row&quot;&gt;
        {{if left_sidebar_enabled:}}
        &lt;div class=&quot;span3 left-sidebar&quot;&gt;
            {{block left_sidebar}}
            &lt;h3&gt;Left Sidebar&lt;/h3&gt;
            &lt;p&gt;&lt;/p&gt;
            {{end}}
        &lt;/div&gt;
        {{pass}}

        &lt;div class=&quot;{{=middle_columns}}&quot;&gt;
            {{block center}}
            {{include}}
            {{end}}
        &lt;/div&gt;

        {{if right_sidebar_enabled:}}
        &lt;div class=&quot;span3&quot;&gt;
            {{block right_sidebar}}
            &lt;h3&gt;Right Sidebar&lt;/h3&gt;
            &lt;p&gt;&lt;/p&gt;
            {{end}}
        &lt;/div&gt;
        {{pass}}
    &lt;/section&gt;&lt;!--/main--&gt;

    &lt;!-- Footer ================================================== --&gt;
    &lt;div class=&quot;row&quot;&gt;
        &lt;footer class=&quot;footer span12&quot; id=&quot;footer&quot;&gt;
            &lt;div class=&quot;footer-content&quot;&gt;
                {{block footer}} &lt;!-- this is default footer --&gt;
		...
                {{end}}
            &lt;/div&gt;
        &lt;/footer&gt;
    &lt;/div&gt;

  &lt;/div&gt; &lt;!-- /container --&gt;

  &lt;!-- The javascript =============================================
       (Placed at the end of the document so the pages load faster) --&gt;
  &lt;script src=&quot;{{=URL(&#x27;static&#x27;,&#x27;js/bootstrap.min.js&#x27;)}}&quot;&gt;&lt;/script&gt;
  &lt;script src=&quot;{{=URL(&#x27;static&#x27;,&#x27;js/web2py_bootstrap.js&#x27;)}}&quot;&gt;&lt;/script&gt;
  {{if response.google_analytics_id:}}
    &lt;script src=&quot;{{=URL(&#x27;static&#x27;,&#x27;js/analytics.js&#x27;)}}&quot;&gt;&lt;/script&gt;
    &lt;script type=&quot;text/javascript&quot;&gt;
    analytics.initialize({
      &#x27;Google Analytics&#x27;:{trackingId:&#x27;{{=response.google_analytics_id}}&#x27;} 
    });&lt;/script&gt;
  {{pass}}
&lt;/body&gt;
&lt;/html&gt;
``:code

There are a few features of this default layout that make it very easy to use and customize:

- It is written in HTML5 and uses the &quot;modernizr&quot; ``modernizr``:cite library for backward compatibility. The actual layout include some extra conditional statements required by IE and they are omitted for brevity.
- It displays both ``response.title`` and ``response.subtitle`` which can be set in a model. If they are not set, it adopts the application name as title
- It includes the ``web2py_ajax.html`` file in the header which generated all the link and script import statements.
- It uses a modified version of Twitter Boostrap for flexible layouts which works on mobile devices and re-arranges columns to fit small screens.
- It uses &quot;analytics.js&quot; to connect to Google Analytics.
- The ``{{=auth.navbar(...)}}`` displays a welcome to the current user and links to auth functions like login, logout, register, change password, etc. depending on context. It is a helper factory and its output can be manipulated as any other helper. It is placed in a ``{{try:}}...{{except:pass}}`` in case auth is undefined.
- The ``{{=MENU(response.menu)`` displays the menu structure as ``&lt;ul&gt;...&lt;/ul&gt;``.
- ``{{include}}`` is replaced by the content of the extending view when the page is rendered.
- By default it uses a conditional three column (the left and right sidebars can be turned off by the extending views)
- It uses the following classes: header, main, footer
- It contains the following blocks: statusbar, left_sidebar, center, right_sidebar, footer.

In views can turn on and fill sidebars as follows:

``
{{left_sidebar_enable=True}}
{{extend &#x27;layout.html&#x27;}}

This text goes in center

{{block left_sidebar}}
This text goes in sidebar
{{end}}
``:code

#### Customizing the default layout

``CSS``:inxx

Customizing the default layout without editing is easy because the welcome application is based on Twitter Bootstrap which is well documented and supports themes. In web2py four static files which are relevant to style:

- &quot;css/web2py.css&quot; contains web2py specific styles
- &quot;css/bootstrap.min.css&quot; contains the Twitter Boostrap CSS style ``bootstrap``:cite ``Bootstrap``:inxx
- &quot;css/web2py_bootstrap.css&quot; contains with overrides some Bootstrap styles to conform to web2py needs.
- &quot;js/bootstrap.min.js&quot; which includes the libraries for menu effects, modals, panels.
</pre></div>
    <div class="span6"><pre style="background-color: #F2DEDE;">#### Default page layout
``superfish``:inxx ``ez.css``:inxx

Below is the &quot;views/layout.html&quot; that ships with the web2py scaffolding application **welcome** (stripped down of some optional parts). Any new application will have a similar default layout:

``
&lt;!DOCTYPE html&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot; /&gt;
  &lt;title&gt;{{=response.title or request.application}}&lt;/title&gt;

  &lt;!-- http://dev.w3.org/html5/markup/meta.name.html --&gt;
  &lt;meta name=&quot;application-name&quot; content=&quot;{{=request.application}}&quot; /&gt;

  &lt;script src=&quot;{{=URL(&#x27;static&#x27;,&#x27;js/modernizr.custom.js&#x27;)}}&quot;&gt;&lt;/script&gt;

  &lt;!-- include stylesheets --&gt;
  {{
  response.files.append(URL(&#x27;static&#x27;,&#x27;css/skeleton.css&#x27;))
  response.files.append(URL(&#x27;static&#x27;,&#x27;css/web2py.css&#x27;))
  response.files.append(URL(&#x27;static&#x27;,&#x27;css/superfish.css&#x27;))
  response.files.append(URL(&#x27;static&#x27;,&#x27;js/superfish.js&#x27;))
  }}

  {{include &#x27;web2py_ajax.html&#x27;}}

  &lt;script type=&quot;text/javascript&quot;&gt;
    jQuery(function(){ jQuery(&#x27;ul.sf-menu&#x27;).supersubs({minWidth:12,maxWidth:30,extraWidth:3}).superfish(); });
  &lt;/script&gt;

  {{
  # using sidebars need to know what sidebar you want to use
  left_sidebar_enabled = globals().get(&#x27;left_sidebar_enabled&#x27;,False)
  right_sidebar_enabled = globals().get(&#x27;right_sidebar_enabled&#x27;,False)
  middle_columns = {0:&#x27;sixteen&#x27;,1:&#x27;twelve&#x27;,2:&#x27;eight&#x27;}[
     (left_sidebar_enabled and 1 or 0)+(right_sidebar_enabled and 1 or 0)]
  }}

&lt;/head&gt;
&lt;body&gt;
  &lt;div class=&quot;wrapper&quot;&gt;&lt;!-- for sticky footer --&gt;

    &lt;div class=&quot;topbar&quot;&gt;
      &lt;div class=&quot;container&quot;&gt;
        &lt;div class=&quot;sixteen columns&quot;&gt;
          &lt;div id=&quot;navbar&quot;&gt;
            {{=&#x27;auth&#x27; in globals() and auth.navbar(separators=(&#x27; &#x27;,&#x27; | &#x27;,&#x27;&#x27;))}}
          &lt;/div&gt;
          &lt;div id=&quot;menu&quot;&gt;
            {{=MENU(response.menu,
                    _class=&#x27;mobile-menu&#x27; if is_mobile else &#x27;sf-menu&#x27;,
                    mobile=request.user_agent().is_mobile)}}
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;&lt;!-- topbar --&gt;

    &lt;div class=&quot;flash&quot;&gt;{{=response.flash or &#x27;&#x27;}}&lt;/div&gt;

    &lt;div class=&quot;header&quot;&gt;
      &lt;div class=&quot;container&quot;&gt;
        &lt;div class=&quot;sixteen columns&quot;&gt;
          &lt;h1 class=&quot;remove-bottom&quot; style=&quot;margin-top: .5em;&quot;&gt;
          {{=response.title or request.application}}
          &lt;/h1&gt;
          &lt;h5&gt;{{=response.subtitle or &#x27;&#x27;}}&lt;/h5&gt;
        &lt;/div&gt;

        &lt;div class=&quot;sixteen columns&quot;&gt;
          &lt;div class=&quot;statusbar&quot;&gt;
            {{block statusbar}}
            &lt;span class=&quot;breadcrumbs&quot;&gt;{{=request.function}}&lt;/span&gt;
            {{end}}
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;

    &lt;div class=&quot;main&quot;&gt;
      &lt;div class=&quot;container&quot;&gt;
        {{if left_sidebar_enabled:}}
        &lt;div class=&quot;four columns left-sidebar&quot;&gt;
          {{block left_sidebar}}
          &lt;h3&gt;Left Sidebar&lt;/h3&gt;
          &lt;p&gt;&lt;/p&gt;
          {{end}}
        &lt;/div&gt;
        {{pass}}

        &lt;div class=&quot;{{=middle_columns}} columns center&quot;&gt;
          {{block center}}
          {{include}}
          {{end}}
        &lt;/div&gt;

        {{if right_sidebar_enabled:}}
        &lt;div class=&quot;four columns&quot;&gt;
          {{block right_sidebar}}
          &lt;h3&gt;Right Sidebar&lt;/h3&gt;
          &lt;p&gt;&lt;/p&gt;
          {{end}}
        &lt;/div&gt;
        {{pass}}

      &lt;/div&gt;&lt;!-- container --&gt;
    &lt;/div&gt;&lt;!-- main --&gt;

    &lt;div class=&quot;push&quot;&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;!-- wrapper --&gt;

  &lt;div class=&quot;footer&quot;&gt;
    &lt;div class=&quot;container header&quot;&gt;
      &lt;div class=&quot;sixteen columns&quot;&gt;
        {{block footer}} &lt;!-- this is default footer --&gt;
        &lt;div class=&quot;footer-content&quot; &gt;
          {{=T(&#x27;Copyright&#x27;)}} &amp;#169; 2011
          &lt;div style=&quot;float: right;&quot;&gt;
            &lt;a href=&quot;http://www.web2py.com/&quot;&gt;
            &lt;img style=&quot;padding-bottom: 0;&quot;
                 src=&quot;{{=URL(&#x27;static&#x27;,&#x27;images/poweredby.png&#x27;)}}&quot;/&gt;
            &lt;/a&gt;
          &lt;/div&gt;
        &lt;/div&gt;
        {{end}}
      &lt;/div&gt;
    &lt;/div&gt;&lt;!-- container --&gt;
  &lt;/div&gt;&lt;!-- footer --&gt;

&lt;/body&gt;
&lt;/html&gt;

``:code

There are a few features of this default layout that make it very easy to use and customize:

- It is written in HTML5 and uses the &quot;modernizr&quot; ``modernizr``:cite library for backward compatibility. The actual layout include some extra conditional statements required by IE and they are omitted for brevity.
- It displays both ``response.title`` and ``response.subtitle`` which can be set in a model. If they are not set, it adopts the application name as title
- It includes the ``web2py_ajax.html`` file in the header which generated all the link and script import statements.
- It uses a modified version of &quot;skeleton&quot; ``skeleton``:cite a library for flexible layouts which works on mobile devices and re-arranges columns to fit small screens.
- It uses &quot;superfish.js&quot; ``superfish``:cite for dynamic cascading menus. There is an explicit script to activate the superfish cascading menu and it can be removed if not necessary.
- The ``{{=auth.navbar(...)}}`` displays a welcome to the current user and links to auth functions like login, logout, register, change password, etc. depending on context. It is a helper factory and its output can be manipulated as any other helper. It is placed in a ``{{try:}}...{{except:pass}}`` in case auth is undefined.
- The ``{{=MENU(response.menu)`` displays the menu structure as ``&lt;ul&gt;...&lt;/ul&gt;``.
- ``{{include}}`` is replaced by the content of the extending view when the page is rendered.
- By default it uses a conditional three column (the left and right sidebars can be turned off by the extending views)
- It uses the following classes: header, main, footer
- It contains the following blocks: statusbar, left_sidebar, center, right_sidebar, footer.

Views can turn on and fill sidebars as follows:

``
{{left_sidebar_enable=True}}
{{extend &#x27;layout.html&#x27;}}

This text goes in center

{{block left_sidebar}}
This text goes in sidebar
{{end}}
``:code

#### Customizing the default layout

``CSS``:inxx

Customizing the default layout without editing is very easy because the CSS files are documented:

- &quot;bootstrap.min.css&quot; contains the Twitter Boostrap CSS style ``bootstrap``:cite ``Bootstrap``:inxx
- &quot;web2py.css&quot; contains web2py specific styles
</pre></div>
</div>
<hr />

<ul><li><a href="https://github.com/mdipierro/web2py-book/commit/e9cfe4c59d781f0c6856c48992ec384892311fde">e9cfe4c</a><ul><li>Date : 2012-12-26</li><li>Minor typos</li></ul></li></ul>
<div class="row-fluid" id="com_e9cfe4c59d781f0c6856c48992ec384892311fde">
    <div class="span6"><pre style="background-color: #DFF0D8;">The &quot;views/layout.html&quot; that ships with the web2py scaffolding application **welcome** (stripped down of some optional parts) is quite complex but it has the following structure:
</pre></div>
    <div class="span6"><pre style="background-color: #F2DEDE;">The &quot;views/layout.html&quot; that ships with the web2py scaffolding application **welcome** (stripped down of some optional parts) is quote complex but is has the following structure:
</pre></div>
</div>
<hr />

<ul><li><a href="https://github.com/mdipierro/web2py-book/commit/28816a98948c4a6577f73bdeb2b7424dc55d2582">28816a9</a><ul><li>Date : 2012-12-23</li><li>code building book</li></ul></li></ul>
<div class="row-fluid" id="com_28816a98948c4a6577f73bdeb2b7424dc55d2582">
    <div class="span6"><pre style="background-color: #DFF0D8;">can be used to build complex expressions that can then be serialized to XML``xml-w``:cite ``xml-o``:cite. For example:
``
{{=DIV(B(I(&quot;hello &quot;, &quot;&lt;world&gt;&quot;))), _class=&quot;myclass&quot;)}}
``:code

is rendered:
``
&lt;div class=&quot;myclass&quot;&gt;&lt;b&gt;&lt;i&gt;hello &amp;lt;world&amp;gt;&lt;/i&gt;&lt;/b&gt;&lt;/div&gt;
``:code

Helpers can also be serialized into strings, equivalently, with the ``__str__`` and the ``xml`` methods:

``
&gt;&gt;&gt; print str(DIV(&quot;hello world&quot;))
&lt;div&gt;hello world&lt;/div&gt;
&gt;&gt;&gt; print DIV(&quot;hello world&quot;).xml()
&lt;div&gt;hello world&lt;/div&gt;
``

``Document Object Model (DOM)``:inxx
The helpers mechanism in web2py is more than a system to generate HTML without concatenating strings. It provides a server-side representation of the Document Object Model (DOM).

Components of helpers can be referenced via their position, and helpers act as lists with respect to their components:
``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;a&#x27;, &#x27;b&#x27;), &#x27;c&#x27;)
&gt;&gt;&gt; print a
&lt;div&gt;&lt;span&gt;ab&lt;/span&gt;c&lt;/div&gt;
&gt;&gt;&gt; del a[1]
&gt;&gt;&gt; a.append(B(&#x27;x&#x27;))
&gt;&gt;&gt; a[0][0] = &#x27;y&#x27;
&gt;&gt;&gt; print a
The &quot;enctype&quot; is &quot;multipart/form-data&quot; by default.
The constructor of a ``FORM``, and of ``SQLFORM``, can also take a special argument called ``hidden``. When a dictionary is passed as ``hidden``, its items are translated into &quot;hidden&quot; INPUT fields. For example:
``
&gt;&gt;&gt; print FORM(hidden=dict(a=&#x27;b&#x27;))
&lt;form enctype=&quot;multipart/form-data&quot; action=&quot;&quot; method=&quot;post&quot;&gt;
&lt;input value=&quot;b&quot; type=&quot;hidden&quot; name=&quot;a&quot; /&gt;&lt;/form&gt;
``:code

##### ``H1``, ``H2``, ``H3``, ``H4``, ``H5``, ``H6``
``H1``:inxx

These helpers are for paragraph headings and subheadings:
``
&gt;&gt;&gt; print H1(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;), _class=&#x27;test&#x27;, _id=0)
&lt;h1 id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/h1&gt;
``:code

##### ``HEAD``

For tagging the HEAD of an HTML page.

``HEAD``:inxx
``
&gt;&gt;&gt; print HEAD(TITLE(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;)))
&lt;head&gt;&lt;title&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/title&gt;&lt;/head&gt;
``:code

##### ``HTML``
``HTML``:inxx ``XHTML``:inxx

This helper is a little different. In addition to making the ``&lt;html&gt;`` tags,
it prepends the tag with a doctype string``xhtml-w,xhtml-o,xhtml-school``:cite .
``
&gt;&gt;&gt; print HTML(BODY(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;)))
&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;
                      &quot;http://www.w3.org/TR/html4/loose.dtd&quot;&gt;
&lt;html&gt;&lt;body&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/body&gt;&lt;/html&gt;
``:code
</pre></div>
    <div class="span6"><pre style="background-color: #F2DEDE;">can be used to build complex expressions that can then be serialized to XML``xml:w``:cite ``xml:o``:cite. For example:
``
{{=DIV(B(I(&quot;hello &quot;, &quot;&lt;world&gt;&quot;))), _class=&quot;myclass&quot;)}}
``:code

is rendered:
``
&lt;div class=&quot;myclass&quot;&gt;&lt;b&gt;&lt;i&gt;hello &amp;lt;world&amp;gt;&lt;/i&gt;&lt;/b&gt;&lt;/div&gt;
``:code

Helpers can also be serialized into strings, equivalently, with the ``__str__`` and the ``xml`` methods:

``
&gt;&gt;&gt; print str(DIV(&quot;hello world&quot;))
&lt;div&gt;hello world&lt;/div&gt;
&gt;&gt;&gt; print DIV(&quot;hello world&quot;).xml()
&lt;div&gt;hello world&lt;/div&gt;
``

``Document Object Model (DOM)``:inxx
The helpers mechanism in web2py is more than a system to generate HTML without concatenating strings. It provides a server-side representation of the Document Object Model (DOM).

Components of helpers can be referenced via their position, and helpers act as lists with respect to their components:
``
&gt;&gt;&gt; a = DIV(SPAN(&#x27;a&#x27;, &#x27;b&#x27;), &#x27;c&#x27;)
&gt;&gt;&gt; print a
&lt;div&gt;&lt;span&gt;ab&lt;/span&gt;c&lt;/div&gt;
&gt;&gt;&gt; del a[1]
&gt;&gt;&gt; a.append(B(&#x27;x&#x27;))
&gt;&gt;&gt; a[0][0] = &#x27;y&#x27;
&gt;&gt;&gt; print a
The &quot;enctype&quot; is &quot;multipart/form-data&quot; by default.
The constructor of a ``FORM``, and of ``SQLFORM``, can also take a special argument called ``hidden``. When a dictionary is passed as ``hidden``, its items are translated into &quot;hidden&quot; INPUT fields. For example:
``
&gt;&gt;&gt; print FORM(hidden=dict(a=&#x27;b&#x27;))
&lt;form enctype=&quot;multipart/form-data&quot; action=&quot;&quot; method=&quot;post&quot;&gt;
&lt;input value=&quot;b&quot; type=&quot;hidden&quot; name=&quot;a&quot; /&gt;&lt;/form&gt;
``:code

##### ``H1``, ``H2``, ``H3``, ``H4``, ``H5``, ``H6``
``H1``:inxx

These helpers are for paragraph headings and subheadings:
``
&gt;&gt;&gt; print H1(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;), _class=&#x27;test&#x27;, _id=0)
&lt;h1 id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/h1&gt;
``:code

##### ``HEAD``

For tagging the HEAD of an HTML page.

``HEAD``:inxx
``
&gt;&gt;&gt; print HEAD(TITLE(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;)))
&lt;head&gt;&lt;title&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/title&gt;&lt;/head&gt;
``:code

##### ``HTML``
``HTML``:inxx ``XHTML``:inxx

This helper is a little different. In addition to making the ``&lt;html&gt;`` tags,
it prepends the tag with a doctype string``xhtml:w,xhtml:o,xhtml:school``:cite .
``
&gt;&gt;&gt; print HTML(BODY(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;)))
&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;
                      &quot;http://www.w3.org/TR/html4/loose.dtd&quot;&gt;
&lt;html&gt;&lt;body&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/body&gt;&lt;/html&gt;
``:code
</pre></div>
</div>
<hr />

<ul><li><a href="https://github.com/mdipierro/web2py-book/commit/ac4003f4349f9ee22c67309ceeb48de5539b0308">ac4003f</a><ul><li>Date : 2012-09-01</li><li>added lots of new features to book</li></ul></li></ul>
<div class="row-fluid" id="com_ac4003f4349f9ee22c67309ceeb48de5539b0308">
    <div class="span6"><pre style="background-color: #DFF0D8;">A menu item can also have an optional 5th element, which is a boolean. When false, the menu item is ignored by the MENU helper.

The MENU helper takes the following optional arguments:
- ``_class``: defaults to &quot;web2py-menu web2py-menu-vertical&quot; and sets the class of the outer UL elements.
- ``ul_class``: defaults to &quot;web2py-menu-vertical&quot; and sets the class of the inner UL elements.
- ``li_class``: defaults to &quot;web2py-menu-expand&quot; and sets the class of the inner LI elements.

``mobile``:inxx

``MENU`` takes an optional argument ``mobile``. When set to ``True`` instead of building a recursive ``UL`` menu structure it returns a ``SELECT`` dropdown with all the menu options and a ``onchange`` attribute that redirects to the page corresponding to the selected option. This is designed an an alterantive menu representation that increases usability on small mobile devices such as phones.

Normally the menu is used in a layout with the following syntax:

``
{{=MENU(response.menu, mobile=request.user_agent().is_mobile)}}
``

In this way a mobile device is automatically detected and the menu is rendered accordingly.

### ``BEAUTIFY``
``BEAUTIFY`` is used to build HTML representations of compound objects, including lists, tuples and dictionaries:
``
{{=BEAUTIFY({&quot;a&quot;: [&quot;hello&quot;, XML(&quot;world&quot;)], &quot;b&quot;: (1, 2)})}}
``:code
``BEAUTIFY`` returns an XML-like object serializable to XML, with a nice looking representation of its constructor argument. In this case, the XML representation of:
``
{&quot;a&quot;: [&quot;hello&quot;, XML(&quot;world&quot;)], &quot;b&quot;: (1, 2)}
``:code

will render as:
``
&lt;table&gt;
There are a few features of this default layout that make it very easy to use an
- It displays both ``response.title`` and ``response.subtitle`` which can be set in a model. If they are not set, it adopts the application name as title
- It includes the ``web2py_ajax.html`` file in the header which generated all the link and script import statements.
- It uses a modified version of &quot;skeleton&quot; ``skeleton``:cite a library for flexible layouts which works on mobile devices and re-arranges columns to fit small screened.
- It uses &quot;superfish.js&quot; for dynamic cascading menus. There is an explicit script to activate the superfish cascading menu and it can be removed if not necessary.
- The ``{{=auth.navbar(...)}}`` displays a welcome to the current user and links to auth functions like login, logout, register, change password, etc. depending on context. It is a heler factory and its output can be manipulated as any other helper. It is placed in a ``{{try:}}...{{except:pass}}`` in case auth is undefined.
- The ``{{=MENU(response.menu)`` displays the menu structure as ``&lt;ul&gt;...&lt;/ul&gt;``.
- ``{{include}}`` is replaced by the content of the extending view when the page is rendered.
- By default it uses a conditional three column (the left and right sidebars can be turned off by the extending views)
- It uses the following classes: header, main, footer
- It contains the following blocks: statusbar, left_sidebar, center, right_sidebar, footer.

Views can turn on and fill sidebars as follows:

``
{{left_sidebar_enable=True}}
{{extend &#x27;layout.html&#x27;}}

This text goes in center

{{block left_sidebar}}
This text goes in sidebar
{{end}}
``:code

#### Customizing the default layout

``CSS``:inxx

Customizing the default layout without editing is very easy because the CSS files are documented:

- &quot;bootstrap.min.css&quot; contains the Twitter Boostrap CSS style ``Bootstrap``:inxx
- &quot;web2py.css&quot; contains web2py specific styles

To change colors and background images, 
try append the following code to layout.html header:

``
&lt;style&gt;
body { background: url(&#x27;images/background.png&#x27;) repeat-x #3A3A3A; }
a { color: #349C01; }
.header h1 { color: #349C01; }
.header h2 { color: white; font-style: italic; font-size: 14px;}
.statusbar { background: #333333; border-bottom: 5px #349C01 solid; }
.statusbar a { color: white; }
.footer { border-top: 5px #349C01 solid; }
&lt;/style&gt;
``:code

Of course you can also completely replace the &quot;layout.html&quot; and &quot;web2py.css&quot; files with your own.
</pre></div>
    <div class="span6"><pre style="background-color: #F2DEDE;">The MENU helper takes the following optional arguments:
- ``_class``: defaults to &quot;web2py-menu web2py-menu-vertical&quot; and sets the class of the outer UL elements.
- ``ul_class``: defaults to &quot;web2py-menu-vertical&quot; and sets the class of the inner UL elements.
- ``li_class``: defaults to &quot;web2py-menu-expand&quot; and sets the class of the inner LI elements.

``mobile``:inxx

``MENU`` takes an optional argument ``mobile``. When set to ``True`` instead of building a recursive ``UL`` menu structure it returns a ``SELECT`` dropdown with all the menu options and a ``onchange`` attribute that redirects to the page corresponding to the selected option. This is designed an an alterantive menu representation that increases usability on small mobile devices such as phones.

Normally the menu is used in a layout with the following syntax:

``
{{=MENU(response.menu, mobile=request.user_agent().is_mobile)}}
``

In this way a mobile device is automatically detected and the menu is rendered accordingly.

### ``BEAUTIFY``
``BEAUTIFY`` is used to build HTML representations of compound objects, including lists, tuples and dictionaries:
``
{{=BEAUTIFY({&quot;a&quot;: [&quot;hello&quot;, XML(&quot;world&quot;)], &quot;b&quot;: (1, 2)})}}
``:code
``BEAUTIFY`` returns an XML-like object serializable to XML, with a nice looking representation of its constructor argument. In this case, the XML representation of:
``
{&quot;a&quot;: [&quot;hello&quot;, XML(&quot;world&quot;)], &quot;b&quot;: (1, 2)}
``:code

will render as:
``
&lt;table&gt;
There are a few features of this default layout that make it very easy to use an
- It displays both ``response.title`` and ``response.subtitle`` which can be set in a model. If they are not set, it adopts the application name as title
- It includes the ``web2py_ajax.html`` file in the header which generated all the link and script import statements.
- It uses a modified version of &quot;skeleton&quot; ``skeleton``:cite a library for flexible layouts which works on mobile devices and re-arranges columns to fit small screened.
- It uses &quot;superfish.js&quot; for dynamic cascading menus. There is an explicit script to activate the superfish cascading menu and it can be removed if not necessary.
- The ``{{=auth.navbar(...)}}`` displays a welcome to the current user and links to auth functions like login, logout, register, change password, etc. depending on context. It is a heler factory and its output can be manipulated as any other helper. It is placed in a ``{{try:}}...{{except:pass}}`` in case auth is undefined.
- The ``{{=MENU(response.menu)`` displays the menu structure as ``&lt;ul&gt;...&lt;/ul&gt;``.
- ``{{include}}`` is replaced by the content of the extending view when the page is rendered.
- By default it uses a conditional three column (the left and right sidebars can be turned off by the extending views)
- It uses the following classes: header, main, footer
- It contains the following blocks: statusbar, left_sidebar, center, right_sidebar, footer.

Views can turn on and fill sidebars as follows:

``
{{left_sidebar_enable=True}}
{{extend &#x27;layout.html&#x27;}}

This text goes in center

{{block left_sidebar}}
This text goes in sidebar
{{end}}
``:code

#### Customizing the default layout

``CSS``:inxx

Customizing the default layout without editing is very easy because the CSS files are documented:

- &quot;skeleton.css&quot; contains reset, grid layout and form styles
- &quot;web2py.css&quot; contains web2py specific styles
- &quot;superfish.css&quot; contains menu styles

To change colors and background images, simply append the following code to &quot;web2py.css&quot;:

``
body { background: url(&#x27;images/background.png&#x27;) repeat-x #3A3A3A; }
a { color: #349C01; }
.header h1 { color: #349C01; }
.header h2 { color: white; font-style: italic; font-size: 14px;}
.statusbar { background: #333333; border-bottom: 5px #349C01 solid; }
.statusbar a { color: white; }
.footer { border-top: 5px #349C01 solid; }
``:code

The menu is built in a color-neutral way but you can change that too.

Of course you can also completely replace the &quot;layout.html&quot; and &quot;web2py.css&quot; files with your own.
</pre></div>
</div>
<hr />

<ul><li><a href="https://github.com/mdipierro/web2py-book/commit/9f8f7358720ecddc06a79b90a68cc94ae5b28603">9f8f735</a><ul><li>Date : 2013-02-25</li><li>some edits</li></ul></li></ul>
<div class="row-fluid" id="com_9f8f7358720ecddc06a79b90a68cc94ae5b28603">
    <div class="span6"><pre style="background-color: #DFF0D8;">- It is written in HTML5 and uses the &quot;modernizr&quot; ``modernizr``:cite library for backward compatibility. The actual layout include some extra conditional statements required by IE and they are omitted for brevity.
- It displays both ``response.title`` and ``response.subtitle`` which can be set in a model. If they are not set, it adopts the application name as title
- It includes the ``web2py_ajax.html`` file in the header which generated all the link and script import statements.
- It uses a modified version of Twitter Bootstrap for flexible layouts which works on mobile devices and re-arranges columns to fit small screens.
- It uses &quot;analytics.js&quot; to connect to Google Analytics.
- The ``{{=auth.navbar(...)}}`` displays a welcome to the current user and links to the auth functions like login, logout, register, change password, etc. depending on context. It is a helper factory and its output can be manipulated as any other helper. It is placed in a ``{{try:}}...{{except:pass}}`` in case auth is undefined.
- The ``{{=MENU(response.menu)}}`` displays the menu structure as ``&lt;ul&gt;...&lt;/ul&gt;``.
- ``{{include}}`` is replaced by the content of the extending view when the page is rendered.
- By default it uses a conditional three column (the left and right sidebars can be turned off by the extending views)
- It uses the following classes: header, main, footer
- It contains the following blocks: statusbar, left_sidebar, center, right_sidebar, footer.

In viewsm, you can turn on and customize sidebars as follows:

``
{{left_sidebar_enable=True}}
{{extend &#x27;layout.html&#x27;}}

This text goes in center

{{block left_sidebar}}
This text goes in sidebar
{{end}}
``:code

#### Customizing the default layout

``CSS``:inxx

Customizing the default layout without editing is easy because the welcome application is based on Twitter Bootstrap which is well documented and supports themes. In web2py four static files which are relevant to style:

- &quot;css/web2py.css&quot; contains web2py specific styles
- &quot;css/bootstrap.min.css&quot; contains the Twitter Bootstrap CSS style ``bootstrap``:cite ``Bootstrap``:inxx
- &quot;css/web2py_bootstrap.css&quot; contains with overrides some Bootstrap styles to conform to web2py needs.
- &quot;js/bootstrap.min.js&quot; which includes the libraries for menu effects, modals, panels.

To change colors and background images,
try append the following code to layout.html header:

``
&lt;style&gt;
body { background: url(&#x27;images/background.png&#x27;) repeat-x #3A3A3A; }
a { color: #349C01; }
Consider this &quot;layout.html&quot;:
and this extending view

``
{{def mysidebar():}}
my new sidebar!!!
{{return}}
{{extend &#x27;layout.html&#x27;}}
Hello World!!!
``:code

Notice the function is defined before the ``{{extend...}}`` statement -- this results in the function being created before the &quot;layout.html&quot; code is executed, so the function can be called anywhere within &quot;layout.html&quot;, even before the ``{{include}}``. Also notice the function is included in the extended view without the ``=`` prefix.

The code generates the following output:

``
&lt;html&gt;
  &lt;body&gt;
    Hello World!!!
    &lt;div class=&quot;sidebar&quot;&gt;
        my new sidebar!!!
    &lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;
``:code

Notice that the function is defined in HTML (although it could also contain Python code) so that ``response.write`` is used to write its content (the function does not return the content). This is why the layout calls the view function using ``{{mysidebar()}}`` rather than ``{{=mysidebar()}}``. Functions defined in this way can take arguments.

### Blocks in views
``block``:inxx

The main way to make a view more modular is by using ``{{block...}}s`` and this mechanism is an alternative to the mechanism discussed in the previous section.
</pre></div>
    <div class="span6"><pre style="background-color: #F2DEDE;">- It is written in HTML5 and uses the &quot;modernizr&quot; ``modernizr``:cite library for backward compatibility. The actual layout include some extra conditional statements required by IE and they are omitted for brevity.
- It displays both ``response.title`` and ``response.subtitle`` which can be set in a model. If they are not set, it adopts the application name as title
- It includes the ``web2py_ajax.html`` file in the header which generated all the link and script import statements.
- It uses a modified version of Twitter Bootstrap for flexible layouts which works on mobile devices and re-arranges columns to fit small screens.
- It uses &quot;analytics.js&quot; to connect to Google Analytics.
- The ``{{=auth.navbar(...)}}`` displays a welcome to the current user and links to auth functions like login, logout, register, change password, etc. depending on context. It is a helper factory and its output can be manipulated as any other helper. It is placed in a ``{{try:}}...{{except:pass}}`` in case auth is undefined.
- The ``{{=MENU(response.menu)`` displays the menu structure as ``&lt;ul&gt;...&lt;/ul&gt;``.
- ``{{include}}`` is replaced by the content of the extending view when the page is rendered.
- By default it uses a conditional three column (the left and right sidebars can be turned off by the extending views)
- It uses the following classes: header, main, footer
- It contains the following blocks: statusbar, left_sidebar, center, right_sidebar, footer.

In views can turn on and fill sidebars as follows:

``
{{left_sidebar_enable=True}}
{{extend &#x27;layout.html&#x27;}}

This text goes in center

{{block left_sidebar}}
This text goes in sidebar
{{end}}
``:code

#### Customizing the default layout

``CSS``:inxx

Customizing the default layout without editing is easy because the welcome application is based on Twitter Bootstrap which is well documented and supports themes. In web2py four static files which are relevant to style:

- &quot;css/web2py.css&quot; contains web2py specific styles
- &quot;css/bootstrap.min.css&quot; contains the Twitter Bootstrap CSS style ``bootstrap``:cite ``Bootstrap``:inxx
- &quot;css/web2py_bootstrap.css&quot; contains with overrides some Bootstrap styles to conform to web2py needs.
- &quot;js/bootstrap.min.js&quot; which includes the libraries for menu effects, modals, panels.

To change colors and background images,
try append the following code to layout.html header:

``
&lt;style&gt;
body { background: url(&#x27;images/background.png&#x27;) repeat-x #3A3A3A; }
a { color: #349C01; }
Consider this &quot;layout.html&quot;:
and this extending view

``
{{def mysidebar():}}
my new sidebar!!!
{{return}}
{{extend &#x27;layout.html&#x27;}}
Hello World!!!
``:code

Notice the function is defined before the ``{{extend...}}`` statement -- this results in the function being created before the &quot;layout.html&quot; code is executed, so the function can be called anywhere within &quot;layout.html&quot;, even before the ``{{include}}``. Also notice the function is included in the extended view without the ``=`` prefix.

The code generates the following output:

``
&lt;html&gt;
  &lt;body&gt;
    Hello World!!!
    &lt;div class=&quot;sidebar&quot;&gt;
        my new sidebar!!!
    &lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;
``:code

Notice that the function is defined in HTML (although it could also contain Python code) so that ``response.write`` is used to write its content (the function does not return the content). This is why the layout calls the view function using ``{{mysidebar()}}`` rather than ``{{=mysidebar()}}``. Functions defined in this way can take arguments.

### Blocks in views
``block``:inxx

Another way to make a view more modular is by using ``{{block...}}s`` and this mechanism is an alternative to the mechanism discussed in the previous section.
</pre></div>
</div>
<hr />

<ul><li><a href="https://github.com/mdipierro/web2py-book/commit/31b67861f63a89ddbca5db525b9ea745b956670e">31b6786</a><ul><li>Date : 2012-09-06</li><li>Fix typos</li></ul></li></ul>
<div class="row-fluid" id="com_31b67861f63a89ddbca5db525b9ea745b956670e">
    <div class="span6"><pre style="background-color: #DFF0D8;">The A helper takes a special argument called ``cid``. It works as follows:

``
{{=A(&#x27;linked page&#x27;, _href=&#x27;http://example.com&#x27;, cid=&#x27;myid&#x27;)}}
&lt;div id=&quot;myid&quot;&gt;&lt;/div&gt;
``:code

and a click on the link causes the content to be loaded in the div. This is similar but more powerful than the above syntax since it is designed to refresh page components. We discuss applications of ``cid`` in more detail in Chapter 12, in the context of components.

These ajax features require jQuery and &quot;static/js/web2py_ajax.js&quot;, which are automatically included by placing ``{{include &#x27;web2py_ajax.html&#x27;}}`` in the layout head. &quot;views/web2py_ajax.html&quot; defines some variables based on ``request`` and includes all necessary js and css files.


##### ``B``
``B``:inxx

This helper makes its contents bold.
``
&gt;&gt;&gt; print B(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;i&gt;world&lt;/i&gt;&#x27;), _class=&#x27;test&#x27;, _id=0)
&lt;b id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;i&gt;world&lt;/i&gt;&lt;/b&gt;
``:code

##### ``BODY``
``BODY``:inxx
This helper makes the body of a page.
``
&gt;&gt;&gt; print BODY(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;), _bgcolor=&#x27;red&#x27;)
&lt;body bgcolor=&quot;red&quot;&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/body&gt;
``:code

##### ``BR``
``BR``:inxx
from gluon.contrib.markmin.markmin2html import markmin2html
print markmin2html(m)
from gluon.contrib.markmin.markmin2latex import markmin2latex
print markmin2latex(m)
from gluon.contrib.markmin.markmin2pdf import markmin2pdf
print markmin2pdf(m) # requires pdflatex
``

(the ``MARKMIN`` helper is a shortcut for ``markmin2html``)

Here is a basic syntax primer:

--------------------------------------------------
**SOURCE**                 | **OUTPUT**
``# title``                | **title**
``## section``             | **section**
``### subsection``         | **subsection**
``**bold**``               | **bold**
``&#x27;&#x27;italic&#x27;&#x27;``             | &#x27;&#x27;italic&#x27;&#x27;
``!`!`verbatim`!`!``       | ``verbatim``
``http://google.com``      | http://google.com
``http://...`` | ``&lt;a href=&quot;http://...&quot;&gt;http:...&lt;/a&gt;``
``http://...png`` | ``&lt;img src=&quot;http://...png&quot; /&gt;``
``http://...mp3`` | ``&lt;audio src=&quot;http://...mp3&quot;&gt;&lt;/audio&gt;``
``http://...mp4`` | ``&lt;video src=&quot;http://...mp4&quot;&gt;&lt;/video&gt;``
``qr:http://...`` | ``&lt;a href=&quot;http://...&quot;&gt;&lt;img src=&quot;qr code&quot;/&gt;&lt;/a&gt;``
``embed:http://...`` | ``&lt;iframe src=&quot;http://...&quot;&gt;&lt;/iframe&gt;``
``[[click me #myanchor]]`` | [[click me #myanchor]]
``$````$\int_a^b sin(x)dx$````$``  | $$\int_a^b sin(x)dx$$
---------------------------------------------------

Simply including a link to an image, a videos or an audio files without markup result in the corresponding image, video or audio file being included automatically (for audio and video it uses html &lt;audio&gt; and &lt;video&gt; tags).

Adding a link with the ``qr:`` prefix such as 

``
qr:http://web2py.com
``

results in the corresponding QR code being embedded and linking the said URL.

Adding a link with the ``embed:`` prefix such as

``
embed:http://www.youtube.com/embed/x1w8hKTJ2Co
`` 

results in the page being embedded, in this case a youtube video is embedded.

Images can also be embedded with the following syntax:

``
[[image-description http://.../image.png right 200px]]
``

Unordered lists with:
``
- one
- two
- three
``

Ordered lists with:
``
+ one
+ two
+ three
``

and tables with:
``
----------
The MENU helper takes a list of lists or of tuples of the form of ``response.men
``
&gt;&gt;&gt; print MENU([[&#x27;One&#x27;, False, &#x27;link1&#x27;], [&#x27;Two&#x27;, False, &#x27;link2&#x27;]])
&lt;ul class=&quot;web2py-menu web2py-menu-vertical&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;link1&quot;&gt;One&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;link2&quot;&gt;Two&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
``:code

Each menu item can have a fourth argument that is a nested submenu (and so on recursively):
``
&gt;&gt;&gt; print MENU([[&#x27;One&#x27;, False, &#x27;link1&#x27;, [[&#x27;Two&#x27;, False, &#x27;link2&#x27;]]]])
&lt;ul class=&quot;web2py-menu web2py-menu-vertical&quot;&gt;
  &lt;li class=&quot;web2py-menu-expand&quot;&gt;
     &lt;a href=&quot;link1&quot;&gt;One&lt;/a&gt;
     &lt;ul class=&quot;web2py-menu-vertical&quot;&gt;
        &lt;li&gt;&lt;a href=&quot;link2&quot;&gt;Two&lt;/a&gt;&lt;/li&gt;
     &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;
``:code

A menu item can also have an optional 5th element, which is a boolean. When false, the menu item is ignored by the MENU helper.

The MENU helper takes the following optional arguments:
- ``_class``: defaults to &quot;web2py-menu web2py-menu-vertical&quot; and sets the class of the outer UL elements.
- ``ul_class``: defaults to &quot;web2py-menu-vertical&quot; and sets the class of the inner UL elements.
- ``li_class``: defaults to &quot;web2py-menu-expand&quot; and sets the class of the inner LI elements.

``mobile``:inxx

``MENU`` takes an optional argument ``mobile``. When set to ``True`` instead of building a recursive ``UL`` menu structure it returns a ``SELECT`` dropdown with all the menu options and a ``onchange`` attribute that redirects to the page corresponding to the selected option. This is designed an an alternative menu representation that increases usability on small mobile devices such as phones.

Normally the menu is used in a layout with the following syntax:

``
{{=MENU(response.menu, mobile=request.user_agent().is_mobile)}}
``

In this way a mobile device is automatically detected and the menu is rendered accordingly.

### ``BEAUTIFY``
``BEAUTIFY`` is used to build HTML representations of compound objects, including lists, tuples and dictionaries:
``
{{=BEAUTIFY({&quot;a&quot;: [&quot;hello&quot;, XML(&quot;world&quot;)], &quot;b&quot;: (1, 2)})}}
``:code
``BEAUTIFY`` returns an XML-like object serializable to XML, with a nice looking representation of its constructor argument. In this case, the XML representation of:
``
{&quot;a&quot;: [&quot;hello&quot;, XML(&quot;world&quot;)], &quot;b&quot;: (1, 2)}
``:code

will render as:
``
&lt;table&gt;
&lt;tr&gt;&lt;td&gt;a&lt;/td&gt;&lt;td&gt;:&lt;/td&gt;&lt;td&gt;hello&lt;br /&gt;world&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;b&lt;/td&gt;&lt;td&gt;:&lt;/td&gt;&lt;td&gt;1&lt;br /&gt;2&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;
``:code

### Server-side &#x27;&#x27;DOM&#x27;&#x27; and parsing
``element``:inxx ``elements``:inxx

The extended layout file must contain an ``{{include}}`` directive, something li
&lt;/html&gt;
``:code

When the view is called, the extended (layout) view is loaded, and the calling view replaces the ``{{include}}`` directive inside the layout. Processing continues recursively until all ``extend`` and ``include`` directives have been processed. The resulting template is then translated into Python code. Note, when an application is bytecode compiled, it is this Python code that is compiled, not the original view files themselves. So, the bytecode compiled version of a given view is a single .pyc file that includes the Python code not just for the original view file, but for its entire tree of extended and included views.

-------
``extend``, ``include``, ``block`` and ``super`` are special template directives,
not Python commands.
-------

Any content or code that precedes the ``{{extend ...}}`` directive will be inserted (and therefore executed) before the beginning of the extended view&#x27;s content/code. Although this is not typically used to insert actual HTML content before the extended view&#x27;s content, it can be useful as a means to define variables or functions that you want to make available to the extended view. For example, consider a view &quot;index.html&quot;:
``
{{sidebar_enabled=True}}
{{extend &#x27;layout.html&#x27;}}
&lt;h1&gt;Home Page&lt;/h1&gt;
``:code

and an excerpt from &quot;layout.html&quot;:
``
{{if sidebar_enabled:}}
    &lt;div id=&quot;sidebar&quot;&gt;
        Sidebar Content
    &lt;/div&gt;
{{pass}}
``:code

Because the ``sidebar_enabled`` assignment in &quot;index.html&quot; comes before the ``extend``, that line gets inserted before the beginning of &quot;layout.html&quot;, making ``sidebar_enabled`` available anywhere within the &quot;layout.html&quot; code (a somewhat more sophisticated version of this is used in the **welcome** app).

It is also worth pointing out that the variables returned by the controller function are available not only in the function&#x27;s main view, but in all of its extended and included views as well.

The argument of an ``extend`` or ``include`` (i.e., the extended or included view name) can be a python variable (though not a python expression). However, this imposes a limitation -- views that use variables in ``extend`` or ``include`` statements cannot be bytecode compiled. As noted above, bytecode-compiled views include the entire tree of extended and included views, so the specific extended and included views must be known at compile time, which is not possible if the view names are variables (whose values are not determined until run time). Because bytecode compiling views can provide a significant speed boost, using variables in ``extend`` and ``include`` should generally be avoided if possible.

In some cases, an alternative to using a variable in an ``include`` is simply to place regular ``{{include ...}}`` directives inside an ``if...else`` block.

``
{{if some_condition:}}
{{include &#x27;this_view.html&#x27;}}
{{else:}}
{{include &#x27;that_view.html&#x27;}}
{{pass}}
``:code

The above code does not present any problem for bytecode compilation because no variables are involved. Note, however, that the bytecode compiled view will actually include the Python code for both &quot;this_view.html&quot; and &quot;that_view.html&quot;, though only the code for one of those views will be executed, depending on the value of ``some_condition``.

Keep in mind, this only works for ``include`` -- you cannot place ``{{extend ...}}`` directives inside ``if...else`` blocks.

``response.menu``:inxx ``menu``:inxx ``response.meta``:inxx ``meta``:inxx

Layouts are used to encapsulate page commonality (headers, footers, menus), and though they are not mandatory, they will make your application easier to write and maintain.  In particular, we suggest writing layouts that take advantage of the following variables that can be set in the controller. Using these well known variables will help make your layouts interchangeable:
``
response.title
response.subtitle
response.meta.author
response.meta.keywords
response.meta.description
response.flash
response.menu
response.files
``:code

Except for ``menu`` and ``files``, these are all strings and their meaning should be obvious.
Below is the &quot;views/layout.html&quot; that ships with the web2py scaffolding applicat
  &lt;div class=&quot;footer&quot;&gt;
    &lt;div class=&quot;container header&quot;&gt;
      &lt;div class=&quot;sixteen columns&quot;&gt;
        {{block footer}} &lt;!-- this is default footer --&gt;
        &lt;div class=&quot;footer-content&quot; &gt;
          {{=T(&#x27;Copyright&#x27;)}} &amp;#169; 2011
          &lt;div style=&quot;float: right;&quot;&gt;
            &lt;a href=&quot;http://www.web2py.com/&quot;&gt;
            &lt;img style=&quot;padding-bottom: 0;&quot; 
                 src=&quot;{{=URL(&#x27;static&#x27;,&#x27;images/poweredby.png&#x27;)}}&quot;/&gt;
            &lt;/a&gt;
          &lt;/div&gt;
        &lt;/div&gt;
        {{end}}
      &lt;/div&gt;
    &lt;/div&gt;&lt;!-- container --&gt;
  &lt;/div&gt;&lt;!-- footer --&gt;

&lt;/body&gt;
&lt;/html&gt;

``:code

There are a few features of this default layout that make it very easy to use and customize:

- It is written in HTML5 and uses the &quot;modernizr&quot; ``modernizr``:cite library for backward compatibility. The actual layout include some extra conditional statements required by IE and they are omitted for brevity.
- It displays both ``response.title`` and ``response.subtitle`` which can be set in a model. If they are not set, it adopts the application name as title
- It includes the ``web2py_ajax.html`` file in the header which generated all the link and script import statements.
- It uses a modified version of &quot;skeleton&quot; ``skeleton``:cite a library for flexible layouts which works on mobile devices and re-arranges columns to fit small screened.
- It uses &quot;superfish.js&quot; for dynamic cascading menus. There is an explicit script to activate the superfish cascading menu and it can be removed if not necessary.
- The ``{{=auth.navbar(...)}}`` displays a welcome to the current user and links to auth functions like login, logout, register, change password, etc. depending on context. It is a helper factory and its output can be manipulated as any other helper. It is placed in a ``{{try:}}...{{except:pass}}`` in case auth is undefined.
- The ``{{=MENU(response.menu)`` displays the menu structure as ``&lt;ul&gt;...&lt;/ul&gt;``.
- ``{{include}}`` is replaced by the content of the extending view when the page is rendered.
- By default it uses a conditional three column (the left and right sidebars can be turned off by the extending views)
- It uses the following classes: header, main, footer
- It contains the following blocks: statusbar, left_sidebar, center, right_sidebar, footer.

Views can turn on and fill sidebars as follows:

``
{{left_sidebar_enable=True}}
{{extend &#x27;layout.html&#x27;}}

This text goes in center

{{block left_sidebar}}
This text goes in sidebar
{{end}}
``:code

#### Customizing the default layout

``CSS``:inxx

Customizing the default layout without editing is very easy because the CSS files are documented:

- &quot;bootstrap.min.css&quot; contains the Twitter Boostrap CSS style ``Bootstrap``:inxx
- &quot;web2py.css&quot; contains web2py specific styles

To change colors and background images, 
try append the following code to layout.html header:

``
&lt;style&gt;
body { background: url(&#x27;images/background.png&#x27;) repeat-x #3A3A3A; }
a { color: #349C01; }
.header h1 { color: #349C01; }
.header h2 { color: white; font-style: italic; font-size: 14px;}
.statusbar { background: #333333; border-bottom: 5px #349C01 solid; }
.statusbar a { color: white; }
.footer { border-top: 5px #349C01 solid; }
&lt;/style&gt;
``:code

Of course you can also completely replace the &quot;layout.html&quot; and &quot;web2py.css&quot; files with your own.

#### Mobile development

The default layout.html is designed to be friendly to mobile devices but that is not enough. One may need to use different views when a page is visited by a mobile device.
</pre></div>
    <div class="span6"><pre style="background-color: #F2DEDE;">Tha A helper takes a special argument called ``cid``. It works as follows:

``
{{=A(&#x27;linked page&#x27;, _href=&#x27;http://example.com&#x27;, cid=&#x27;myid&#x27;)}}
&lt;div id=&quot;myid&quot;&gt;&lt;/div&gt;
``:code

and a click on the link causes the content to be loaded in the div. This is similar but more powerful than the above syntax since it is designed to refresh page components. We discuss applications of ``cid`` in more detail in Chapter 12, in the context of components.

These ajax features require jQuery and &quot;static/js/web2py_ajax.js&quot;, which are automatically included by placing ``{{include &#x27;web2py_ajax.html&#x27;}}`` in the layout head. &quot;views/web2py_ajax.html&quot; defines some variables based on ``request`` and includes all necessary js and css files.


##### ``B``
``B``:inxx

This helper makes its contents bold.
``
&gt;&gt;&gt; print B(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;i&gt;world&lt;/i&gt;&#x27;), _class=&#x27;test&#x27;, _id=0)
&lt;b id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;i&gt;world&lt;/i&gt;&lt;/b&gt;
``:code

##### ``BODY``
``BODY``:inxx
This helper makes the body of a page.
``
&gt;&gt;&gt; print BODY(&#x27;&lt;hello&gt;&#x27;, XML(&#x27;&lt;b&gt;world&lt;/b&gt;&#x27;), _bgcolor=&#x27;red&#x27;)
&lt;body bgcolor=&quot;red&quot;&gt;&amp;lt;hello&amp;gt;&lt;b&gt;world&lt;/b&gt;&lt;/body&gt;
``:code

##### ``BR``
``BR``:inxx
from gluon.contrib.markmin.markmin2html import markmin2html
print markmin2html(m)
from gluon.contrib.markmin.markmin2latex import markmin2latex
print markmin2latex(m)
from gluon.contrib.markmin.markmin2pdf import markmin2pdf
print markmin2pdf(m) # requires pdflatex
``

(the ``MARKMIN`` helper is a shortcut for ``markmin2html``)

Here is a basic syntax primer:

--------------------------------------------------
**SOURCE**                 | **OUTPUT**
``# title``                | **title**
``## section``             | **section**
``### subsection``         | **subsection**
``**bold**``               | **bold**
``&#x27;&#x27;italic&#x27;&#x27;``             | &#x27;&#x27;italic&#x27;&#x27;
``!`!`verbatim`!`!``       | ``verbatim``
``http://google.com``      | http://google.com
``http://...`` | ``&lt;a href=&quot;http://...&quot;&gt;http:...&lt;/a&gt;``
``http://...png`` | ``&lt;img src=&quot;http://...png&quot; /&gt;``
``http://...mp3`` | ``&lt;audio src=&quot;http://...mp3&quot;&gt;&lt;/audio&gt;``
``http://...mp4`` | ``&lt;video src=&quot;http://...mp4&quot;&gt;&lt;/video&gt;``
``qr:http://...`` | ``&lt;a href=&quot;http://...&quot;&gt;&lt;img src=&quot;qr code&quot;/&gt;&lt;/a&gt;``
``embed:http://...`` | ``&lt;iframe src=&quot;http://...&quot;&gt;&lt;/iframe&gt;``
``[[click me #myanchor]]`` | [[click me #myanchor]]
``$````$\int_a^b sin(x)dx$````$``  | $$\int_a^b sin(x)dx$$
---------------------------------------------------

Simply including a link to an image, a videos or an audio files without markup result in the corresponding image, video or audio file beling included automatically (for audio and video it uses html &lt;audio&gt; and &lt;video&gt; tags).

Adding a link with the ``qr:`` prefix such as 

``
qr:http://web2py.com
``

results in the corresponding QR code being embedded and linking the said URL.

Adding a link tith the ``embed:`` prefix such as

``
embed:http://www.youtube.com/embed/x1w8hKTJ2Co
`` 

results in the page being embedded, in this case a youtube video is embedded.

Images can also be embedded with the following syntax:

``
[[image-description http://.../image.png right 200px]]
``

Unordered lists with:
``
- one
- two
- three
``

Ordered lists with:
``
+ one
+ two
+ three
``

and tables with:
``
----------
The MENU helper takes a list of lists or of tuples of the form of ``response.men
``
&gt;&gt;&gt; print MENU([[&#x27;One&#x27;, False, &#x27;link1&#x27;], [&#x27;Two&#x27;, False, &#x27;link2&#x27;]])
&lt;ul class=&quot;web2py-menu web2py-menu-vertical&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;link1&quot;&gt;One&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;link2&quot;&gt;Two&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
``:code

Each menu item can have a fourth argument that is a nested submenu (and so on recursively):
``
&gt;&gt;&gt; print MENU([[&#x27;One&#x27;, False, &#x27;link1&#x27;, [[&#x27;Two&#x27;, False, &#x27;link2&#x27;]]]])
&lt;ul class=&quot;web2py-menu web2py-menu-vertical&quot;&gt;
  &lt;li class=&quot;web2py-menu-expand&quot;&gt;
     &lt;a href=&quot;link1&quot;&gt;One&lt;/a&gt;
     &lt;ul class=&quot;web2py-menu-vertical&quot;&gt;
        &lt;li&gt;&lt;a href=&quot;link2&quot;&gt;Two&lt;/a&gt;&lt;/li&gt;
     &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;
``:code

A menu item can also have an optional 5th element, which is a boolean. When false, the menu item is ignored by the MENU helper.

The MENU helper takes the following optional arguments:
- ``_class``: defaults to &quot;web2py-menu web2py-menu-vertical&quot; and sets the class of the outer UL elements.
- ``ul_class``: defaults to &quot;web2py-menu-vertical&quot; and sets the class of the inner UL elements.
- ``li_class``: defaults to &quot;web2py-menu-expand&quot; and sets the class of the inner LI elements.

``mobile``:inxx

``MENU`` takes an optional argument ``mobile``. When set to ``True`` instead of building a recursive ``UL`` menu structure it returns a ``SELECT`` dropdown with all the menu options and a ``onchange`` attribute that redirects to the page corresponding to the selected option. This is designed an an alterantive menu representation that increases usability on small mobile devices such as phones.

Normally the menu is used in a layout with the following syntax:

``
{{=MENU(response.menu, mobile=request.user_agent().is_mobile)}}
``

In this way a mobile device is automatically detected and the menu is rendered accordingly.

### ``BEAUTIFY``
``BEAUTIFY`` is used to build HTML representations of compound objects, including lists, tuples and dictionaries:
``
{{=BEAUTIFY({&quot;a&quot;: [&quot;hello&quot;, XML(&quot;world&quot;)], &quot;b&quot;: (1, 2)})}}
``:code
``BEAUTIFY`` returns an XML-like object serializable to XML, with a nice looking representation of its constructor argument. In this case, the XML representation of:
``
{&quot;a&quot;: [&quot;hello&quot;, XML(&quot;world&quot;)], &quot;b&quot;: (1, 2)}
``:code

will render as:
``
&lt;table&gt;
&lt;tr&gt;&lt;td&gt;a&lt;/td&gt;&lt;td&gt;:&lt;/td&gt;&lt;td&gt;hello&lt;br /&gt;world&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;b&lt;/td&gt;&lt;td&gt;:&lt;/td&gt;&lt;td&gt;1&lt;br /&gt;2&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;
``:code

### Server-side &#x27;&#x27;DOM&#x27;&#x27; and parsing
``element``:inxx ``elements``:inxx

The extended layout file must contain an ``{{include}}`` directive, something li
&lt;/html&gt;
``:code

When the view is called, the extended (layout) view is loaded, and the calling view replaces the ``{{include}}`` directive inside the layout. Processing continues recursively until all ``extend`` and ``include`` directives have been processed. The resulting template is then translated into Python code. Note, when an application is bytecode compiled, it is this Python code that is compiled, not the original view files themselves. So, the bytecode compiled version of a given view is a single .pyc file that includes the Python code not just for the original view file, but for its entire tree of extended and included views.

-------
``extend``, ``include``, ``block`` and ``super`` are special template directives,
not Python commands.
-------

Any content or code that precedes the ``{{extend ...}}`` directive will be inserted (and therefore executed) before the beginning of the extended view&#x27;s content/code. Although this is not typically used to insert actual HTML content before the extended view&#x27;s content, it can be useful as a means to define variables or functions that you want to make available to the extended view. For example, consider a view &quot;index.html&quot;:
``
{{sidebar_enabled=True}}
{{extend &#x27;layout.html&#x27;}}
&lt;h1&gt;Home Page&lt;/h1&gt;
``:code

and an excerpt from &quot;layout.html&quot;:
``
{{if sidebar_enabled:}}
    &lt;div id=&quot;sidebar&quot;&gt;
        Sidebar Content
    &lt;/div&gt;
{{pass}}
``:code

Because the ``sidebar_enabled`` assignment in &quot;index.html&quot; comes before the ``extend``, that line gets inserted before the beginning of &quot;layout.html&quot;, making ``sidebar_enabled`` available anywhere within the &quot;layout.html&quot; code (a somewhat more sophisticated version of this is used in the **welcome** app).

It is also worth pointing out that the variables returned by the controller function are available not only in the function&#x27;s main view, but in all of its extended and included views as well.

The argument of an ``extend`` or ``include`` (i.e., the extended or included view name) can be a python variable (though not a python expression). However, this imposes a limitation -- views that use variables in ``extend`` or ``include`` statements cannot be bytecode compiled. As noted above, bytecode compiled views include the entire tree of extended and included views, so the specific extended and included views must be known at compile time, which is not possible if the view names are variables (whose values are not determined until run time). Because bytecode compiling views can provide a significant speed boost, using variables in ``extend`` and ``include`` should generally be avoided if possible.

In some cases, an alternative to using a variable in an ``include`` is simply to place regular ``{{include ...}}`` directives inside an ``if...else`` block.

``
{{if some_condition:}}
{{include &#x27;this_view.html&#x27;}}
{{else:}}
{{include &#x27;that_view.html&#x27;}}
{{pass}}
``:code

The above code does not present any problem for bytecode compilation because no variables are involved. Note, however, that the bytecode compiled view will actually include the Python code for both &quot;this_view.html&quot; and &quot;that_view.html&quot;, though only the code for one of those views will be executed, depending on the value of ``some_condition``.

Keep in mind, this only works for ``include`` -- you cannot place ``{{extend ...}}`` directives inside ``if...else`` blocks.

``response.menu``:inxx ``menu``:inxx ``response.meta``:inxx ``meta``:inxx

Layouts are used to encapsulate page commonality (headers, footers, menus), and though they are not mandatory, they will make your application easier to write and maintain.  In particular, we suggest writing layouts that take advantage of the following variables that can be set in the controller. Using these well known variables will help make your layouts interchangeable:
``
response.title
response.subtitle
response.meta.author
response.meta.keywords
response.meta.description
response.flash
response.menu
response.files
``:code

Except for ``menu`` and ``files``, these are all strings and their meaning should be obvious.
Below is the &quot;views/layout.html&quot; that ships with the web2py scaffolding applicat
  &lt;div class=&quot;footer&quot;&gt;
    &lt;div class=&quot;container header&quot;&gt;
      &lt;div class=&quot;sixteen columns&quot;&gt;
        {{block footer}} &lt;!-- this is default footer --&gt;
        &lt;div class=&quot;footer-content&quot; &gt;
          {{=T(&#x27;Copyright&#x27;)}} &amp;#169; 2011
          &lt;div style=&quot;float: right;&quot;&gt;
            &lt;a href=&quot;http://www.web2py.com/&quot;&gt;
            &lt;img style=&quot;padding-bottom: 0;&quot; 
                 src=&quot;{{=URL(&#x27;static&#x27;,&#x27;images/poweredby.png&#x27;)}}&quot;/&gt;
            &lt;/a&gt;
          &lt;/div&gt;
        &lt;/div&gt;
        {{end}}
      &lt;/div&gt;
    &lt;/div&gt;&lt;!-- container --&gt;
  &lt;/div&gt;&lt;!-- footer --&gt;

&lt;/body&gt;
&lt;/html&gt;

``:code

There are a few features of this default layout that make it very easy to use and customize:

- It is written in HTML5 and uses the &quot;modernizr&quot; ``modernizr``:cite library for backward compatibility. The actual layout include some extra conditional statements required by IE and they are omitted for brevity.
- It displays both ``response.title`` and ``response.subtitle`` which can be set in a model. If they are not set, it adopts the application name as title
- It includes the ``web2py_ajax.html`` file in the header which generated all the link and script import statements.
- It uses a modified version of &quot;skeleton&quot; ``skeleton``:cite a library for flexible layouts which works on mobile devices and re-arranges columns to fit small screened.
- It uses &quot;superfish.js&quot; for dynamic cascading menus. There is an explicit script to activate the superfish cascading menu and it can be removed if not necessary.
- The ``{{=auth.navbar(...)}}`` displays a welcome to the current user and links to auth functions like login, logout, register, change password, etc. depending on context. It is a heler factory and its output can be manipulated as any other helper. It is placed in a ``{{try:}}...{{except:pass}}`` in case auth is undefined.
- The ``{{=MENU(response.menu)`` displays the menu structure as ``&lt;ul&gt;...&lt;/ul&gt;``.
- ``{{include}}`` is replaced by the content of the extending view when the page is rendered.
- By default it uses a conditional three column (the left and right sidebars can be turned off by the extending views)
- It uses the following classes: header, main, footer
- It contains the following blocks: statusbar, left_sidebar, center, right_sidebar, footer.

Views can turn on and fill sidebars as follows:

``
{{left_sidebar_enable=True}}
{{extend &#x27;layout.html&#x27;}}

This text goes in center

{{block left_sidebar}}
This text goes in sidebar
{{end}}
``:code

#### Customizing the default layout

``CSS``:inxx

Customizing the default layout without editing is very easy because the CSS files are documented:

- &quot;bootstrap.min.css&quot; contains the Twitter Boostrap CSS style ``Bootstrap``:inxx
- &quot;web2py.css&quot; contains web2py specific styles

To change colors and background images, 
try append the following code to layout.html header:

``
&lt;style&gt;
body { background: url(&#x27;images/background.png&#x27;) repeat-x #3A3A3A; }
a { color: #349C01; }
.header h1 { color: #349C01; }
.header h2 { color: white; font-style: italic; font-size: 14px;}
.statusbar { background: #333333; border-bottom: 5px #349C01 solid; }
.statusbar a { color: white; }
.footer { border-top: 5px #349C01 solid; }
&lt;/style&gt;
``:code

Of course you can also completely replace the &quot;layout.html&quot; and &quot;web2py.css&quot; files with your own.

#### Mobile development

The default layout.html is designed to be friendly to mobile devices but that is not enought. One may need to use different views when a page is visited by a mobile device.
</pre></div>
</div>
<hr />


        
      </div>

      <div id="push"></div>
    </div>

    <div id="footer">
      <div class="container-fluid">
          <div class="copyright pull-left">Copyright &#169; 2013</div>
          <div id="poweredBy" class="pull-right">
              Powered by
              <a href="http://www.web2py.com/">web2py</a>
          </div>
      </div>
    </div>
<script src="static/js/bootstrap.min.js"></script>
<script src="static/js/web2py_bootstrap.js"></script>
</body>
</html>
